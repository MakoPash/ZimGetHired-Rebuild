<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AfroPol Nexus ‚Äî Your Gateway to Poland's Top Universities</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root {
  --red: #E8000D;
  --blue: #0038A8;
  --blue-light: #1a4fd8;
  --dark: #0A0A1A;
  --white: #FFFFFF;
  --off-white: #FAFAFA;
  --bg-section: #F5F7FF;
  --card-bg: #FFFFFF;
  --card-border: #E8ECF4;
  --card-shadow: 0 2px 16px rgba(0,56,168,0.08);
  --card-shadow-hover: 0 8px 32px rgba(0,56,168,0.16);
  --text-primary: #0A0A1A;
  --text-muted: #6B7280;
  --text-light: #9CA3AF;
  --green-match: #059669;
  --yellow-match: #D97706;
  --red-match: #DC2626;
  --success: #10B981;
  --border-radius: 12px;
  --border-radius-lg: 20px;
  --transition: all 0.25s ease;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{font-family:'DM Sans',sans-serif;color:var(--text-primary);background:#fff;overflow-x:hidden;font-size:16px;line-height:1.65;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
h1,h2,h3,h4,h5{font-family:'Syne',sans-serif;letter-spacing:-0.01em}
a{text-decoration:none;color:inherit}
button{cursor:pointer;font-family:'DM Sans',sans-serif}
input,textarea,select{font-family:'DM Sans',sans-serif}
img{max-width:100%}
.container{max-width:1200px;margin:0 auto;padding:0 24px}
.page{display:none}
.page.active{display:block}

/* Buttons ‚Äî Premium */
.btn-primary{background:linear-gradient(135deg,#E8000D 0%,#c8000b 100%);color:#fff;border:none;padding:15px 34px;border-radius:10px;font-weight:700;font-size:15.5px;letter-spacing:0.01em;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);display:inline-flex;align-items:center;gap:8px;position:relative;overflow:hidden}
.btn-primary::after{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,255,255,0.12) 0%,transparent 60%);pointer-events:none}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(232,0,13,0.35)}
.btn-secondary{background:transparent;color:var(--blue);border:2px solid var(--blue);padding:13px 30px;border-radius:10px;font-weight:700;font-size:15.5px;letter-spacing:0.01em;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);display:inline-flex;align-items:center;gap:8px;position:relative;overflow:hidden}
.btn-secondary::after{content:'';position:absolute;inset:0;background:var(--blue);transform:scaleX(0);transform-origin:left;transition:transform 0.3s ease;z-index:0}
.btn-secondary span,.btn-secondary i{position:relative;z-index:1}
.btn-secondary:hover::after{transform:scaleX(1)}
.btn-secondary:hover{color:#fff;border-color:var(--blue)}
.btn-ghost-red{background:transparent;color:var(--red);border:2px solid var(--red);padding:10px 24px;border-radius:10px;font-weight:700;font-size:14.5px;transition:all 0.3s ease}
.btn-ghost-red:hover{background:var(--red);color:#fff;box-shadow:0 4px 16px rgba(232,0,13,0.25)}
.btn-sm{padding:8px 18px;font-size:13.5px;border-radius:8px}
.btn-wa{background:linear-gradient(135deg,#25D366,#1ebe5d);color:#fff;border:none;padding:12px 24px;border-radius:10px;font-weight:700;font-size:14.5px;transition:all 0.3s ease;display:inline-flex;align-items:center;gap:8px;box-shadow:0 4px 16px rgba(37,211,102,0.2)}
.btn-wa:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(37,211,102,0.35)}

/* Navbar */
#navbar{position:fixed;top:0;left:0;right:0;z-index:1000;background:#fff;border-bottom:1px solid var(--card-border);transition:box-shadow 0.3s ease;height:72px}
#navbar.scrolled{box-shadow:0 2px 20px rgba(0,56,168,0.1)}
.nav-inner{display:flex;align-items:center;justify-content:space-between;height:72px}
.nav-logo{display:flex;flex-direction:column;gap:1px}
.nav-logo-name{font-family:'Syne',sans-serif;font-size:21px;font-weight:800;line-height:1;letter-spacing:-0.02em}
.nav-logo-name .afro{color:var(--blue)}
.nav-logo-name .pol{color:var(--red)}
.nav-logo-name .nex{color:var(--dark)}
.nav-logo-tagline{font-size:10.5px;color:var(--text-muted);font-weight:500;letter-spacing:0.01em}
.nav-links{display:flex;align-items:center;gap:32px;list-style:none}
.nav-links a{font-size:14.5px;font-weight:500;color:#374151;transition:color 0.2s;letter-spacing:0.005em}
.nav-links a:hover{color:var(--blue)}
.nav-actions{display:flex;align-items:center;gap:16px}
.nav-signin{font-size:14px;font-weight:600;color:var(--blue);cursor:pointer}
.hamburger{display:none;flex-direction:column;gap:5px;background:none;border:none;padding:4px;cursor:pointer}
.hamburger span{width:24px;height:2px;background:var(--dark);border-radius:2px;transition:var(--transition)}

/* Mobile nav */
#mobile-menu{display:none;position:fixed;top:72px;left:0;right:0;bottom:0;background:#fff;z-index:999;padding:24px;flex-direction:column;gap:8px}
#mobile-menu.open{display:flex}
#mobile-menu a,#mobile-menu button{padding:14px 16px;font-size:16px;font-weight:600;color:var(--dark);border-radius:8px;border:none;background:none;text-align:left;transition:background 0.2s}
#mobile-menu a:hover{background:var(--bg-section)}

/* Cards */
.card{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius);box-shadow:var(--card-shadow);transition:var(--transition)}
.card:hover{transform:translateY(-4px);box-shadow:var(--card-shadow-hover)}
.card-featured{border-left:4px solid var(--red)}

/* Badges */
.badge{display:inline-flex;align-items:center;gap:4px;padding:4px 10px;border-radius:20px;font-size:12px;font-weight:600}
.badge-blue{background:#EEF2FF;color:var(--blue)}
.badge-red{background:#FEE2E2;color:var(--red)}
.badge-green{background:#D1FAE5;color:var(--green-match)}
.badge-yellow{background:#FEF3C7;color:var(--yellow-match)}
.badge-grey{background:#F3F4F6;color:#6B7280}
.badge-private{background:#EEF2FF;color:var(--blue)}
.badge-public{background:#D1FAE5;color:var(--green-match)}
.match-high{background:#D1FAE5;color:#059669;padding:5px 12px;border-radius:20px;font-size:13px;font-weight:700}
.match-mid{background:#FEF3C7;color:#D97706;padding:5px 12px;border-radius:20px;font-size:13px;font-weight:700}
.match-low{background:#FEE2E2;color:#DC2626;padding:5px 12px;border-radius:20px;font-size:13px;font-weight:700}

/* Animations */
.fade-in{opacity:0;transform:translateY(20px);transition:opacity 0.5s ease,transform 0.5s ease}
.fade-in.visible{opacity:1;transform:translateY(0)}
@keyframes pulse-wa{0%,100%{box-shadow:0 0 0 0 rgba(37,211,102,0.4)}70%{box-shadow:0 0 0 12px rgba(37,211,102,0)}}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
@keyframes countUp{from{opacity:0}to{opacity:1}}
@keyframes slideDown{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse-ring{0%{transform:scale(1)}50%{transform:scale(1.08)}100%{transform:scale(1)}}
.spinner{width:40px;height:40px;border:3px solid #E8ECF4;border-top-color:var(--blue);border-radius:50%;animation:spin 0.8s linear infinite}
.page-transition{animation:fadeIn 0.35s ease forwards}

/* Main layout offset for navbar */
#page-home,#page-search,#page-login,#page-register,#page-profile,#page-dashboard,#page-book-call,#page-admin{padding-top:72px}

/* ===================== HERO ===================== */
.hero{background:#fff;padding:72px 0 60px;position:relative;overflow:hidden;min-height:calc(100vh - 72px);display:flex;align-items:center}
.hero-bg-orb1{position:absolute;top:-100px;right:-80px;width:600px;height:600px;background:radial-gradient(circle,rgba(0,56,168,0.07) 0%,transparent 70%);border-radius:50%;pointer-events:none;animation:floatOrb 8s ease-in-out infinite}
.hero-bg-orb2{position:absolute;bottom:-100px;left:-80px;width:400px;height:400px;background:radial-gradient(circle,rgba(232,0,13,0.06) 0%,transparent 70%);border-radius:50%;pointer-events:none;animation:floatOrb 10s ease-in-out infinite reverse}
.hero-bg-grid{position:absolute;inset:0;background-image:linear-gradient(rgba(0,56,168,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(0,56,168,0.03) 1px,transparent 1px);background-size:60px 60px;pointer-events:none}
.hero-inner{display:grid;grid-template-columns:55% 45%;gap:56px;align-items:center;position:relative;z-index:1;width:100%}
.hero-eyebrow{display:inline-flex;align-items:center;gap:8px;background:#EEF2FF;border:1px solid #C7D2FE;border-radius:24px;padding:7px 18px;font-size:13px;font-weight:600;color:var(--blue);margin-bottom:28px;animation:fadeSlideUp 0.6s ease forwards;letter-spacing:0.01em}
.hero h1{font-family:'Syne',sans-serif;font-size:52px;font-weight:800;line-height:1.1;color:var(--dark);margin-bottom:22px;animation:fadeSlideUp 0.7s 0.1s ease both;letter-spacing:-0.025em}
.hero h1 .red{color:var(--red)}
.hero h1 .blue{color:var(--blue)}
.hero p{font-size:17px;line-height:1.78;color:#4B5563;margin-bottom:36px;max-width:480px;animation:fadeSlideUp 0.7s 0.2s ease both;font-weight:400}
.hero-ctas{display:flex;gap:14px;flex-wrap:wrap;margin-bottom:36px;animation:fadeSlideUp 0.7s 0.3s ease both}
.hero-trust{display:flex;flex-wrap:wrap;gap:8px;animation:fadeSlideUp 0.7s 0.4s ease both}
.trust-item{display:inline-flex;align-items:center;gap:7px;font-size:13px;color:#4B5563;font-weight:500;padding:6px 14px;background:var(--bg-section);border:1px solid var(--card-border);border-radius:20px;letter-spacing:0.005em}
.trust-item svg{width:16px;height:16px;flex-shrink:0}
.hero-visual{display:flex;justify-content:center;align-items:center;animation:fadeSlideUp 0.8s 0.2s ease both}
.hero-illustration{width:100%;max-width:440px;position:relative}
.hero-card-stack{position:relative;height:400px}
.hero-card-main{position:absolute;top:32px;left:16px;right:16px;background:#fff;border-radius:20px;padding:24px;box-shadow:0 24px 64px rgba(0,56,168,0.14);border:1px solid var(--card-border)}
.hero-card-bg{position:absolute;top:16px;left:32px;right:0;height:220px;background:linear-gradient(135deg,var(--blue),var(--red));border-radius:20px;opacity:0.07}
.hero-uni-item{display:flex;align-items:center;gap:12px;padding:10px 0;border-bottom:1px solid #F3F4F6}
.hero-uni-item:last-child{border-bottom:none}
.hero-uni-dot{width:10px;height:10px;border-radius:50%}
.hero-floating-badge{position:absolute;background:#fff;border-radius:12px;padding:10px 16px;box-shadow:0 8px 32px rgba(0,0,0,0.12);font-family:'Syne',sans-serif;font-size:13px;font-weight:700;display:flex;align-items:center;gap:8px;white-space:nowrap}
.hero-float-1{top:0;right:-10px;animation:floatBadge 4s ease-in-out infinite}
.hero-float-2{bottom:20px;left:-10px;animation:floatBadge 5s 1s ease-in-out infinite}

/* Hero Quick Search */
.hero-search{background:#fff;border:1.5px solid var(--card-border);border-radius:16px;padding:20px 24px;box-shadow:0 8px 32px rgba(0,56,168,0.1);margin-bottom:36px;animation:fadeSlideUp 0.7s 0.35s ease both}
.hero-search-label{font-size:12px;font-weight:700;color:var(--blue);letter-spacing:0.06em;text-transform:uppercase;margin-bottom:12px;display:flex;align-items:center;gap:6px}
.hero-search-row{display:flex;gap:0;border:1.5px solid var(--card-border);border-radius:10px;overflow:hidden;background:#fff;transition:border-color 0.2s,box-shadow 0.2s}
.hero-search-row:focus-within{border-color:var(--blue);box-shadow:0 0 0 4px rgba(0,56,168,0.08)}
.hero-search-select{flex:1;padding:12px 14px;border:none;font-size:14px;font-family:'DM Sans',sans-serif;font-weight:500;background:transparent;outline:none;color:var(--text-primary);cursor:pointer;min-width:0}
.hero-search-divider{width:1px;background:var(--card-border);margin:8px 0;flex-shrink:0}
.hero-search-input{flex:2;padding:12px 14px;border:none;font-size:14px;font-family:'DM Sans',sans-serif;background:transparent;outline:none;min-width:0}
.hero-search-btn{background:var(--red);color:#fff;border:none;padding:0 20px;font-family:'DM Sans',sans-serif;font-weight:700;font-size:14px;cursor:pointer;transition:background 0.2s;flex-shrink:0;display:flex;align-items:center;gap:8px}
.hero-search-btn:hover{background:#c8000b}
.hero-search-tags{display:flex;flex-wrap:wrap;gap:6px;margin-top:12px}
.hero-search-tag{font-size:12px;color:var(--text-muted);background:var(--bg-section);border:1px solid var(--card-border);border-radius:20px;padding:3px 10px;cursor:pointer;transition:var(--transition);font-weight:500}
.hero-search-tag:hover{border-color:var(--blue);color:var(--blue);background:#EEF2FF}

/* Typing animation */
.typed-word{display:inline-block;color:var(--red)}
.cursor-blink{display:inline-block;width:3px;height:0.9em;background:var(--red);margin-left:2px;vertical-align:text-bottom;animation:blink 0.8s step-start infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}

/* Animations */
@keyframes fadeSlideUp{from{opacity:0;transform:translateY(24px)}to{opacity:1;transform:translateY(0)}}
@keyframes floatOrb{0%,100%{transform:translate(0,0)}50%{transform:translate(-20px,20px)}}
@keyframes floatBadge{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}

/* Steps - premium SVG icons */
.steps-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:20px;position:relative}
.steps-grid::before{content:'';position:absolute;top:32px;left:10%;right:10%;height:2px;background:linear-gradient(90deg,var(--red),var(--blue));opacity:0.1;z-index:0}
.step-card{text-align:center;padding:28px 16px;background:#fff;border-radius:16px;border:1px solid var(--card-border);position:relative;z-index:1;transition:all 0.3s ease}
.step-card:hover{transform:translateY(-6px);box-shadow:var(--card-shadow-hover);border-color:rgba(0,56,168,0.2)}
.step-num{width:60px;height:60px;border-radius:50%;border:2.5px solid var(--red);background:linear-gradient(135deg,#FFF0F0,#fff);display:flex;align-items:center;justify-content:center;margin:0 auto 16px;font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:var(--red);position:relative;z-index:1}
.step-icon-wrap{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;margin:0 auto 12px}
.step-title{font-family:'Syne',sans-serif;font-size:15px;font-weight:700;margin-bottom:8px;color:var(--dark);letter-spacing:-0.01em}
.step-desc{font-size:13.5px;color:#4B5563;line-height:1.65;font-weight:400}
.steps-note{background:#EEF2FF;border:1px solid #C7D2FE;border-radius:14px;padding:20px 24px;margin-top:32px;font-size:13.5px;color:var(--blue);line-height:1.7;display:flex;gap:12px;align-items:flex-start}

/* Why Poland - premium SVG */
.why-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
.why-card{background:#fff;border:1px solid var(--card-border);border-radius:16px;padding:28px;box-shadow:var(--card-shadow);transition:all 0.3s ease;cursor:default}
.why-card:hover{transform:translateY(-5px);box-shadow:var(--card-shadow-hover);border-color:rgba(0,56,168,0.15)}
.why-icon-wrap{width:52px;height:52px;border-radius:14px;display:flex;align-items:center;justify-content:center;margin-bottom:18px}
.why-title{font-family:'Syne',sans-serif;font-size:17px;font-weight:700;margin-bottom:10px;color:var(--dark);letter-spacing:-0.01em}
.why-desc{font-size:15px;color:#4B5563;line-height:1.7;font-weight:400}

/* Video testimonial cards */
.testimonials-section{padding:80px 0;background:var(--bg-section)}
.testimonials-top-row{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:20px}
.testimonials-video-row{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:20px}
.testimonial-card{background:#fff;border:1px solid var(--card-border);border-radius:16px;padding:28px;box-shadow:var(--card-shadow);transition:all 0.3s ease}
.testimonial-card:hover{transform:translateY(-4px);box-shadow:var(--card-shadow-hover)}
.testimonial-stars{display:flex;gap:3px;margin-bottom:16px}
.testimonial-stars span{font-size:15px;color:#F59E0B}
.testimonial-quote{font-size:15px;line-height:1.78;color:#374151;margin-bottom:20px;font-style:italic;position:relative;font-weight:400}
.testimonial-quote::before{content:'"';font-family:'Syne',sans-serif;font-size:64px;line-height:0.8;color:var(--red);opacity:0.1;position:absolute;top:-4px;left:-8px;font-style:normal}
.testimonial-author{display:flex;align-items:center;gap:12px}
.testimonial-avatar{width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,var(--blue),var(--red));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:14px;font-family:'Syne',sans-serif;flex-shrink:0}
.testimonial-name{font-family:'Syne',sans-serif;font-size:14.5px;font-weight:700;letter-spacing:-0.01em}
.testimonial-country{font-size:12.5px;color:#6B7280;margin-top:3px}
.video-testimonial-card{background:#fff;border:1px solid var(--card-border);border-radius:16px;overflow:hidden;box-shadow:var(--card-shadow);transition:all 0.3s ease}
.video-testimonial-card:hover{transform:translateY(-4px);box-shadow:var(--card-shadow-hover)}
.video-wrapper{position:relative;padding-bottom:56.25%;height:0;overflow:hidden;background:#0A0A1A}
.video-wrapper iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:none}
.video-card-body{padding:18px 20px}
.video-card-student{display:flex;align-items:center;gap:10px;margin-bottom:8px}
.video-card-avatar{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,var(--blue),var(--red));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:12px;font-family:'Syne',sans-serif;flex-shrink:0}
.video-card-name{font-family:'Syne',sans-serif;font-size:14px;font-weight:700;letter-spacing:-0.01em}
.video-card-tag{font-size:12px;color:#6B7280;margin-top:2px;font-weight:400}
.video-card-desc{font-size:13.5px;color:#4B5563;line-height:1.65;font-weight:400}
.live-badge{display:inline-flex;align-items:center;gap:4px;background:#FEE2E2;color:var(--red);border-radius:20px;padding:3px 10px;font-size:11px;font-weight:700;letter-spacing:0.02em}
.live-dot{width:7px;height:7px;border-radius:50%;background:var(--red);animation:pulse-dot 1.2s ease infinite}
@keyframes pulse-dot{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.5;transform:scale(0.8)}}

/* Stats bar */
.stats-bar{background:var(--bg-section);border-top:1px solid var(--card-border);border-bottom:1px solid var(--card-border);padding:32px 0}
.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;text-align:center}
.stat-item .stat-num{font-family:'Syne',sans-serif;font-size:38px;font-weight:800;color:var(--red);line-height:1;letter-spacing:-0.03em}
.stat-item .stat-label{font-size:14px;color:#4B5563;font-weight:500;margin-top:6px;letter-spacing:0.005em}

/* How It Works */
.section{padding:80px 0}
.section-alt{background:var(--bg-section)}
.section-header{text-align:center;margin-bottom:56px}
.section-header h2{font-family:'Syne',sans-serif;font-size:40px;font-weight:700;color:var(--dark);margin-bottom:14px;letter-spacing:-0.02em;line-height:1.15}
.section-header p{font-size:16.5px;color:#4B5563;max-width:520px;margin:0 auto;line-height:1.7;font-weight:400}
.steps-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:24px;position:relative}
.steps-grid::before{content:'';position:absolute;top:28px;left:10%;right:10%;height:2px;background:linear-gradient(90deg,var(--red),var(--blue));opacity:0.15;z-index:0}
.step-card{text-align:center;padding:24px 16px;background:#fff;border-radius:var(--border-radius);border:1px solid var(--card-border);position:relative;z-index:1}
.step-num{width:56px;height:56px;border-radius:50%;border:3px solid var(--red);background:#fff;display:flex;align-items:center;justify-content:center;margin:0 auto 16px;font-family:'Syne',sans-serif;font-size:20px;font-weight:800;color:var(--red)}
.step-icon{font-size:22px;margin-bottom:8px}
.step-title{font-family:'Syne',sans-serif;font-size:14px;font-weight:700;margin-bottom:8px}
.step-desc{font-size:13px;color:var(--text-muted);line-height:1.5}
.steps-note{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius);padding:20px 24px;margin-top:32px;font-size:14px;color:var(--text-muted);line-height:1.6;border-left:4px solid var(--blue)}

/* Why Poland */
.why-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:24px}
.why-card{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius);padding:28px;box-shadow:var(--card-shadow);transition:var(--transition)}
.why-card:hover{transform:translateY(-4px);box-shadow:var(--card-shadow-hover)}
.why-icon{font-size:36px;margin-bottom:16px}
.why-title{font-family:'Syne',sans-serif;font-size:17px;font-weight:700;margin-bottom:8px}
.why-desc{font-size:14px;color:var(--text-muted);line-height:1.6}

/* Universities preview */
.uni-preview-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:20px}
.uni-card{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius);padding:24px;box-shadow:var(--card-shadow);transition:var(--transition);cursor:pointer}
.uni-card:hover{transform:translateY(-4px);box-shadow:var(--card-shadow-hover)}
.uni-card-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}
.uni-initial{width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,var(--blue),var(--red));display:flex;align-items:center;justify-content:center;color:#fff;font-family:'Syne',sans-serif;font-weight:800;font-size:16px}
.uni-card-name{font-family:'Syne',sans-serif;font-size:15px;font-weight:700;margin-bottom:6px;line-height:1.3}
.uni-card-city{font-size:12px;color:var(--text-muted)}
.uni-card-footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px;padding-top:12px;border-top:1px solid #F3F4F6}
.uni-programs-count{font-size:12px;color:var(--text-muted)}
.view-all-link{text-align:center;margin-top:32px}
.view-all-link a{font-size:14px;font-weight:700;color:var(--blue);text-decoration:underline}

/* Testimonials */
.testimonials-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:24px}
.testimonial-card{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius);padding:28px;box-shadow:var(--card-shadow)}
.testimonial-stars{color:#F59E0B;font-size:14px;margin-bottom:16px}
.testimonial-quote{font-size:15px;line-height:1.7;color:#374151;margin-bottom:20px;font-style:italic}
.testimonial-author{display:flex;align-items:center;gap:12px}
.testimonial-avatar{width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,var(--blue),var(--red));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:15px;font-family:'Syne',sans-serif}
.testimonial-name{font-family:'Syne',sans-serif;font-size:14px;font-weight:700}
.testimonial-country{font-size:12px;color:var(--text-muted)}

/* CTA Banner */
.cta-banner{background:var(--red);padding:72px 0;text-align:center}
.cta-banner h2{font-family:'Syne',sans-serif;font-size:42px;font-weight:800;color:#fff;margin-bottom:14px;letter-spacing:-0.025em}
.cta-banner p{font-size:17px;color:rgba(255,255,255,0.88);margin-bottom:32px;line-height:1.65}
.cta-banner-btns{display:flex;gap:16px;justify-content:center;flex-wrap:wrap}
.btn-white{background:#fff;color:var(--red);border:none;padding:14px 32px;border-radius:8px;font-weight:700;font-size:15px;transition:var(--transition);display:inline-flex;align-items:center;gap:8px}
.btn-white:hover{background:#f8f8f8;transform:translateY(-1px)}
.btn-white-outline{background:transparent;color:#fff;border:2px solid #fff;padding:12px 30px;border-radius:8px;font-weight:700;font-size:15px;transition:var(--transition);display:inline-flex;align-items:center;gap:8px}
.btn-white-outline:hover{background:#fff;color:var(--red)}
.cta-banner .partnership{margin-top:24px;font-size:13px;color:rgba(255,255,255,0.7)}

/* Footer */
footer{background:#fff;border-top:1px solid var(--card-border);padding:56px 0 0}
.footer-grid{display:grid;grid-template-columns:1.5fr 1fr 1fr;gap:48px;margin-bottom:40px}
.footer-logo-name{font-family:'Syne',sans-serif;font-size:22px;font-weight:800;margin-bottom:4px}
.footer-tagline{font-size:13px;color:var(--text-muted);margin-bottom:16px}
.footer-wa-btns{display:flex;flex-direction:column;gap:8px;margin-top:16px}
.footer-links h4{font-family:'Syne',sans-serif;font-size:14px;font-weight:700;margin-bottom:16px;color:var(--dark)}
.footer-links ul{list-style:none;display:flex;flex-direction:column;gap:10px}
.footer-links a{font-size:14px;color:var(--text-muted);transition:color 0.2s}
.footer-links a:hover{color:var(--blue)}
.footer-bottom{background:var(--bg-section);padding:16px 0;border-top:1px solid var(--card-border)}
.footer-bottom-inner{display:flex;justify-content:space-between;align-items:center;font-size:12px;color:var(--text-muted)}
.footer-admin-link{color:var(--text-muted);cursor:pointer;font-size:12px}
.footer-admin-link:hover{color:var(--blue)}

/* Partnership badge */
.partnership-badge{display:inline-flex;align-items:center;gap:8px;background:#fff;border:1px solid var(--card-border);border-radius:20px;padding:6px 14px;font-size:12px;font-weight:600;color:var(--text-muted);box-shadow:var(--card-shadow)}
.partnership-badge .logo-img{height:20px;width:auto;object-fit:contain}

/* ===================== SEARCH PAGE ===================== */
.search-header{background:#fff;padding:56px 0 40px;border-bottom:1px solid var(--card-border)}
.search-header h1{font-family:'Syne',sans-serif;font-size:42px;font-weight:800;margin-bottom:8px}
.search-header p{font-size:15px;color:var(--text-muted)}
.search-form-card{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius-lg);box-shadow:var(--card-shadow);padding:40px;margin:40px 0}
.search-step-label{font-family:'Syne',sans-serif;font-size:13px;font-weight:700;color:var(--blue);letter-spacing:0.05em;text-transform:uppercase;margin-bottom:12px}
.field-chips{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:8px}
.field-chip{padding:8px 16px;border-radius:20px;border:1.5px solid var(--card-border);background:#fff;font-size:13px;font-weight:600;cursor:pointer;transition:var(--transition);color:var(--text-primary)}
.field-chip:hover{border-color:var(--blue);color:var(--blue)}
.field-chip.selected{background:var(--red);border-color:var(--red);color:#fff}
.level-pills{display:flex;flex-wrap:wrap;gap:8px}
.level-pill{padding:8px 20px;border-radius:20px;border:1.5px solid var(--card-border);background:#fff;font-size:13px;font-weight:600;cursor:pointer;transition:var(--transition);color:var(--text-primary)}
.level-pill:hover{border-color:var(--blue);color:var(--blue)}
.level-pill.selected{background:var(--blue);border-color:var(--blue);color:#fff}
.city-pills{display:flex;flex-wrap:wrap;gap:8px}
.city-pill{padding:8px 20px;border-radius:20px;border:1.5px solid var(--card-border);background:#fff;font-size:13px;font-weight:600;cursor:pointer;transition:var(--transition)}
.city-pill:hover{border-color:var(--blue);color:var(--blue)}
.city-pill.selected{background:var(--blue);border-color:var(--blue);color:#fff}
.search-textarea{width:100%;padding:14px;border:1.5px solid var(--card-border);border-radius:8px;font-size:14px;resize:vertical;min-height:80px;transition:border-color 0.2s;line-height:1.5}
.search-textarea:focus{outline:none;border-color:var(--blue)}
.search-step{margin-bottom:28px}
#search-results{padding:40px 0}
.results-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
.results-count{font-family:'Syne',sans-serif;font-size:18px;font-weight:700}
.sort-select{padding:8px 16px;border:1.5px solid var(--card-border);border-radius:8px;font-size:14px;font-family:'DM Sans',sans-serif;cursor:pointer}
.results-grid{display:flex;flex-direction:column;gap:16px}
.result-card{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius);padding:24px;box-shadow:var(--card-shadow);transition:var(--transition)}
.result-card:hover{box-shadow:var(--card-shadow-hover)}
.result-card.high-match{border-left:4px solid var(--red)}
.result-card-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}
.result-uni{font-family:'Syne',sans-serif;font-size:13px;font-weight:700;color:var(--blue);letter-spacing:0.01em}
.result-program{font-family:'Syne',sans-serif;font-size:20px;font-weight:700;margin-bottom:12px;line-height:1.25;letter-spacing:-0.02em;color:var(--dark)}
.result-badges{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:16px}
.result-footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
.result-tuition{font-family:'Syne',sans-serif;font-size:20px;font-weight:800;color:var(--red)}
.result-actions{display:flex;gap:8px}
.result-details{display:none;margin-top:20px;padding-top:20px;border-top:1px solid #F3F4F6;animation:fadeIn 0.3s ease}
.result-details.open{display:block}
.result-details-desc{font-size:14px;color:#374151;line-height:1.6;margin-bottom:16px}
.result-highlights{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:16px}
.result-highlight{background:var(--bg-section);border:1px solid var(--card-border);border-radius:20px;padding:4px 12px;font-size:12px;font-weight:600;color:var(--text-muted)}
.details-actions{display:flex;gap:12px;flex-wrap:wrap}
.empty-state{text-align:center;padding:80px 0;color:var(--text-muted)}
.empty-state i{font-size:48px;margin-bottom:16px;opacity:0.3}
.search-loading{display:none;text-align:center;padding:60px 0}
.compare-checkbox-wrap{display:flex;align-items:center;gap:6px;font-size:13px;font-weight:500;color:var(--text-muted)}
.compare-checkbox-wrap input{width:16px;height:16px;accent-color:var(--blue);cursor:pointer}

/* Compare bar */
#compare-bar{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);background:var(--dark);color:#fff;border-radius:12px;padding:14px 24px;display:flex;align-items:center;gap:16px;font-size:14px;font-weight:600;box-shadow:0 8px 32px rgba(0,0,0,0.2);z-index:900;display:none}
#compare-bar.show{display:flex}
.compare-bar-label{color:rgba(255,255,255,0.7)}
.btn-compare-view{background:var(--red);color:#fff;border:none;padding:8px 20px;border-radius:6px;font-weight:700;font-size:13px;cursor:pointer}

/* Compare modal */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:2000;display:none;align-items:center;justify-content:center;padding:20px}
.modal-overlay.open{display:flex}
.modal-box{background:#fff;border-radius:var(--border-radius-lg);width:100%;max-width:900px;max-height:90vh;overflow-y:auto;padding:32px}
.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
.modal-header h3{font-family:'Syne',sans-serif;font-size:22px;font-weight:700}
.modal-close{background:none;border:none;font-size:24px;cursor:pointer;color:var(--text-muted);padding:4px}
.compare-table{width:100%;border-collapse:collapse;font-size:14px}
.compare-table th{background:var(--bg-section);padding:12px 16px;text-align:left;font-family:'Syne',sans-serif;font-size:13px;font-weight:700;border-bottom:1px solid var(--card-border)}
.compare-table td{padding:12px 16px;border-bottom:1px solid #F3F4F6;vertical-align:top}
.compare-table tr:last-child td{border-bottom:none}

/* ===================== LOGIN / REGISTER ===================== */
.auth-page{min-height:calc(100vh - 72px);display:flex;align-items:center;justify-content:center;padding:40px 24px;background:var(--bg-section)}
.auth-card{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius-lg);padding:48px;width:100%;max-width:460px;box-shadow:var(--card-shadow)}
.auth-logo{text-align:center;margin-bottom:32px}
.auth-logo-name{font-family:'Syne',sans-serif;font-size:28px;font-weight:800;letter-spacing:-0.02em}
.auth-card h2{font-family:'Syne',sans-serif;font-size:26px;font-weight:700;margin-bottom:8px;letter-spacing:-0.02em}
.auth-subtitle{font-size:15px;color:#4B5563;margin-bottom:32px;line-height:1.6}
.form-group{margin-bottom:20px}
.form-label{font-size:14px;font-weight:600;color:#1F2937;margin-bottom:7px;display:block;letter-spacing:0.005em}
.form-input{width:100%;padding:12px 15px;border:1.5px solid var(--card-border);border-radius:8px;font-size:15px;transition:border-color 0.2s;background:#fff;color:var(--text-primary);line-height:1.5}
.form-input:focus{outline:none;border-color:var(--blue)}
.form-select{width:100%;padding:12px 15px;border:1.5px solid var(--card-border);border-radius:8px;font-size:15px;background:#fff;cursor:pointer;color:var(--text-primary)}
.form-select:focus{outline:none;border-color:var(--blue)}
.auth-divider{display:flex;align-items:center;gap:12px;margin:24px 0;color:var(--text-muted);font-size:13px}
.auth-divider::before,.auth-divider::after{content:'';flex:1;height:1px;background:var(--card-border)}
.auth-link{color:var(--blue);font-weight:600;cursor:pointer;font-size:14px}
.auth-small{font-size:12px;color:var(--text-muted);text-align:center;margin-top:20px}

/* Multi-step progress */
.step-progress{display:flex;gap:0;margin-bottom:32px}
.step-progress-item{flex:1;height:4px;background:#E8ECF4;border-radius:2px;margin-right:4px;transition:background 0.3s}
.step-progress-item.active{background:var(--red)}
.step-progress-item.done{background:var(--blue)}
.step-indicator{font-size:12px;font-weight:600;color:var(--text-muted);margin-bottom:8px;text-align:center}
.register-step{display:none}
.register-step.active{display:block}

/* ===================== PROFILE PAGE ===================== */
.profile-header{background:#fff;border-bottom:1px solid var(--card-border);padding:32px 0}
.profile-header-inner{display:flex;align-items:center;gap:24px}
.profile-avatar-large{width:72px;height:72px;border-radius:50%;background:linear-gradient(135deg,var(--blue),var(--red));display:flex;align-items:center;justify-content:center;color:#fff;font-family:'Syne',sans-serif;font-size:24px;font-weight:800;flex-shrink:0}
.profile-completion-bar{flex:1;max-width:400px}
.completion-label{font-size:13px;font-weight:600;margin-bottom:6px;display:flex;justify-content:space-between}
.completion-track{height:8px;background:#E8ECF4;border-radius:4px;overflow:hidden}
.completion-fill{height:100%;background:linear-gradient(90deg,var(--red),var(--blue));border-radius:4px;transition:width 0.5s ease}

/* Tabs */
.tabs{display:flex;gap:0;border-bottom:2px solid var(--card-border);margin-bottom:32px}
.tab-btn{padding:14px 24px;font-family:'DM Sans',sans-serif;font-size:14px;font-weight:600;color:var(--text-muted);background:none;border:none;border-bottom:2px solid transparent;margin-bottom:-2px;cursor:pointer;transition:var(--transition)}
.tab-btn:hover{color:var(--blue)}
.tab-btn.active{color:var(--blue);border-bottom-color:var(--blue)}
.tab-pane{display:none}
.tab-pane.active{display:block;animation:fadeIn 0.25s ease}
.profile-section{padding:40px 0}
.profile-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.subjects-table{width:100%;margin-top:12px}
.subjects-table th{text-align:left;font-size:12px;font-weight:600;color:var(--text-muted);padding:8px;background:var(--bg-section)}
.subjects-table td{padding:8px}
.subjects-table input{width:100%;padding:6px 10px;border:1px solid var(--card-border);border-radius:6px;font-size:13px}
.save-sticky{position:sticky;bottom:0;background:#fff;border-top:1px solid var(--card-border);padding:16px 0;z-index:100;text-align:center}

/* Doc slots */
.doc-slot{display:flex;align-items:center;justify-content:space-between;padding:16px;border:1.5px dashed var(--card-border);border-radius:8px;margin-bottom:12px;transition:border-color 0.2s}
.doc-slot.uploaded{border-color:var(--success);background:#F0FDF4;border-style:solid}
.doc-slot-name{font-size:14px;font-weight:600}
.doc-slot-status{font-size:12px;color:var(--text-muted)}
.doc-slot-status.ok{color:var(--success);font-weight:600}

/* ===================== DASHBOARD PAGE ===================== */
.dashboard-header{background:#fff;border-bottom:1px solid var(--card-border);padding:32px 0}
.stage-badge{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;border-radius:20px;font-size:12px;font-weight:700}
.shortlist-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
.shortlist-card{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius);padding:20px;position:relative;box-shadow:var(--card-shadow)}
.shortlist-remove{position:absolute;top:12px;right:12px;background:none;border:none;color:var(--text-muted);font-size:18px;cursor:pointer}

/* Application tracker */
.app-stages{display:flex;gap:0;margin:24px 0 40px;overflow-x:auto;padding-bottom:8px}
.app-stage{flex:1;min-width:80px;text-align:center;position:relative}
.app-stage::after{content:'';position:absolute;top:20px;left:50%;right:-50%;height:2px;background:#E8ECF4;z-index:0}
.app-stage:last-child::after{display:none}
.app-stage-circle{width:40px;height:40px;border-radius:50%;border:2px solid #E8ECF4;background:#fff;display:flex;align-items:center;justify-content:center;margin:0 auto 8px;font-size:14px;position:relative;z-index:1;transition:var(--transition)}
.app-stage.completed .app-stage-circle{background:var(--red);border-color:var(--red);color:#fff}
.app-stage.current .app-stage-circle{border-color:var(--blue);animation:pulse-ring 1.5s ease infinite}
.app-stage-label{font-size:10px;font-weight:600;color:var(--text-muted);line-height:1.3}

/* Visa guide */
.visa-steps{display:flex;flex-direction:column;gap:16px;margin:24px 0}
.visa-step{display:flex;gap:16px;align-items:flex-start}
.visa-step-num{width:36px;height:36px;border-radius:50%;background:var(--blue);color:#fff;display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-weight:700;font-size:15px;flex-shrink:0}
.visa-step-content h4{font-family:'Syne',sans-serif;font-size:14px;font-weight:700;margin-bottom:4px}
.visa-step-content p{font-size:13px;color:var(--text-muted);line-height:1.5}

/* Doc status badges */
.doc-status-pending{background:#FEF3C7;color:#D97706}
.doc-status-submitted{background:#EEF2FF;color:var(--blue)}
.doc-status-approved{background:#D1FAE5;color:var(--green-match)}
.doc-status-action{background:#FEE2E2;color:var(--red)}

/* ===================== BOOK A CALL PAGE ===================== */
.book-header{padding:56px 0 32px;background:#fff;border-bottom:1px solid var(--card-border)}
.book-grid{display:grid;grid-template-columns:1fr 1fr;gap:64px;padding:56px 0}
.expect-card{background:var(--bg-section);border:1px solid var(--card-border);border-radius:var(--border-radius);padding:24px;margin-bottom:12px;display:flex;gap:14px}
.expect-icon{font-size:20px;flex-shrink:0}
.note-box{background:#EEF2FF;border:1px solid #C7D2FE;border-radius:8px;padding:16px;font-size:13px;color:var(--blue);line-height:1.6;margin-top:16px}
.book-form-card{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius-lg);padding:36px;box-shadow:var(--card-shadow)}
.thank-you-state{display:none;text-align:center;padding:40px 0}
.thank-you-state.show{display:block;animation:fadeIn 0.4s ease}

/* ===================== ADMIN PANEL ===================== */
.admin-login{min-height:calc(100vh - 72px);display:flex;align-items:center;justify-content:center;background:var(--bg-section)}
.admin-dashboard{display:none}
.admin-header{background:var(--dark);color:#fff;padding:24px 0;margin-bottom:0}
.admin-header-inner{display:flex;justify-content:space-between;align-items:center}
.admin-title{font-family:'Syne',sans-serif;font-size:22px;font-weight:700}
.admin-logout{background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.2);padding:8px 18px;border-radius:6px;font-size:13px;font-weight:600;cursor:pointer}
.admin-tabs{background:#fff;border-bottom:2px solid var(--card-border);padding:0 24px}
.admin-tab-btn{padding:16px 24px;font-size:14px;font-weight:600;color:var(--text-muted);background:none;border:none;border-bottom:3px solid transparent;margin-bottom:-2px;cursor:pointer;transition:var(--transition)}
.admin-tab-btn.active{color:var(--blue);border-bottom-color:var(--blue)}
.admin-content{padding:32px;background:var(--off-white);min-height:calc(100vh - 200px)}
.pipeline-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:32px}
.pipeline-card{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius);padding:20px;box-shadow:var(--card-shadow)}
.pipeline-num{font-family:'Syne',sans-serif;font-size:36px;font-weight:800;color:var(--red)}
.pipeline-stage{font-size:13px;font-weight:600;color:var(--text-muted)}
.pipeline-dot{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:6px}
.students-filters{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:20px}
.filter-input{padding:8px 14px;border:1.5px solid var(--card-border);border-radius:8px;font-size:13px;font-family:'DM Sans',sans-serif}
.students-table{width:100%;border-collapse:collapse;background:#fff;border-radius:var(--border-radius);overflow:hidden;box-shadow:var(--card-shadow)}
.students-table th{background:var(--bg-section);padding:12px 16px;text-align:left;font-size:12px;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.04em}
.students-table td{padding:12px 16px;font-size:13px;border-bottom:1px solid #F3F4F6;vertical-align:middle}
.students-table tr:hover td{background:#FAFBFF;cursor:pointer}
.action-btn{background:none;border:1px solid var(--card-border);border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;transition:var(--transition)}
.action-btn:hover{background:var(--bg-section)}
.admin-modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:3000;display:none;align-items:center;justify-content:center;padding:20px}
.admin-modal-overlay.open{display:flex}
.admin-modal{background:#fff;border-radius:var(--border-radius-lg);width:100%;max-width:640px;max-height:90vh;overflow-y:auto;padding:36px}
.notes-item{background:var(--bg-section);border-radius:8px;padding:12px;margin-bottom:8px;font-size:13px}
.notes-timestamp{font-size:11px;color:var(--text-muted);margin-bottom:4px}
.uni-admin-row{background:#fff;border:1px solid var(--card-border);border-radius:var(--border-radius);margin-bottom:12px;overflow:hidden}
.uni-admin-header{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;cursor:pointer;transition:background 0.2s}
.uni-admin-header:hover{background:var(--bg-section)}
.uni-admin-programs{display:none;border-top:1px solid var(--card-border);padding:16px 20px}
.uni-admin-programs.open{display:block}
.uni-admin-prog{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #F3F4F6;font-size:13px}
.uni-admin-prog:last-child{border-bottom:none}

/* ===================== WHATSAPP FLOAT ===================== */
#wa-float{position:fixed;bottom:24px;right:24px;z-index:800}
.wa-btn{width:56px;height:56px;border-radius:50%;background:#25D366;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#fff;font-size:24px;box-shadow:0 4px 16px rgba(37,211,102,0.4);animation:pulse-wa 2s ease infinite;transition:var(--transition)}
.wa-btn:hover{transform:scale(1.08)}
.wa-popup{position:absolute;bottom:68px;right:0;background:#fff;border:1px solid var(--card-border);border-radius:12px;padding:12px;min-width:260px;box-shadow:0 8px 32px rgba(0,0,0,0.15);display:none;animation:slideDown 0.2s ease}
.wa-popup.open{display:block}
.wa-popup-title{font-size:12px;font-weight:700;color:var(--text-muted);padding:0 8px 8px;border-bottom:1px solid #F3F4F6;margin-bottom:8px}
.wa-option{display:flex;align-items:center;gap:10px;padding:10px 8px;border-radius:8px;cursor:pointer;transition:background 0.2s;text-decoration:none;color:var(--text-primary)}
.wa-option:hover{background:var(--bg-section)}
.wa-option-icon{width:36px;height:36px;border-radius:50%;background:#25D366;display:flex;align-items:center;justify-content:center;color:#fff;font-size:16px;flex-shrink:0}
.wa-option-text{font-size:13px;font-weight:600}
.wa-option-num{font-size:11px;color:var(--text-muted)}

/* ===================== TOASTS ===================== */
#toast-container{position:fixed;bottom:90px;right:24px;z-index:9000;display:flex;flex-direction:column;gap:8px}
.toast{background:var(--dark);color:#fff;padding:12px 20px;border-radius:8px;font-size:14px;font-weight:500;box-shadow:0 4px 16px rgba(0,0,0,0.2);animation:fadeIn 0.3s ease;max-width:280px}
.toast.success{border-left:3px solid var(--success)}
.toast.info{border-left:3px solid var(--blue)}

/* Pagination */
.pagination{display:flex;gap:8px;justify-content:center;margin-top:24px}
.page-btn{padding:8px 14px;border:1px solid var(--card-border);border-radius:6px;background:#fff;font-size:13px;cursor:pointer;transition:var(--transition)}
.page-btn.active{background:var(--blue);color:#fff;border-color:var(--blue)}
.page-btn:hover:not(.active){background:var(--bg-section)}

/* Misc utilities */
.text-red{color:var(--red)}
.text-blue{color:var(--blue)}
.text-muted{color:var(--text-muted)}
.font-syne{font-family:'Syne',sans-serif}
.fw-700{font-weight:700}
.fw-800{font-weight:800}
.mt-4{margin-top:4px}
.mt-8{margin-top:8px}
.mt-12{margin-top:12px}
.mt-16{margin-top:16px}
.mt-24{margin-top:24px}
.mt-32{margin-top:32px}
.mb-4{margin-bottom:4px}
.mb-8{margin-bottom:8px}
.mb-12{margin-bottom:12px}
.mb-16{margin-bottom:16px}
.mb-24{margin-bottom:24px}
.mb-32{margin-bottom:32px}
.flex{display:flex}
.flex-center{display:flex;align-items:center}
.flex-between{display:flex;justify-content:space-between;align-items:center}
.gap-8{gap:8px}
.gap-12{gap:12px}
.gap-16{gap:16px}
.w-full{width:100%}
.text-center{text-align:center}

/* Responsive */
@media(max-width:1024px){
  .hero-inner{grid-template-columns:1fr}
  .hero-visual{display:none}
  .hero h1{font-size:48px}
  .steps-grid{grid-template-columns:repeat(3,1fr)}
  .uni-preview-grid{grid-template-columns:repeat(2,1fr)}
  .footer-grid{grid-template-columns:1fr 1fr}
  .testimonials-top-row{grid-template-columns:1fr 1fr}
  .testimonials-video-row{grid-template-columns:1fr 1fr}
}
@media(max-width:768px){
  .nav-links{display:none}
  .nav-actions .btn-primary{display:none}
  .hamburger{display:flex}
  .hero h1{font-size:36px}
  .hero-inner{grid-template-columns:1fr}
  .hero-visual{display:none}
  .hero{min-height:auto;padding:56px 0 48px}
  .hero-search-row{flex-wrap:wrap}
  .hero-search-select{flex:100%;border-right:none;border-bottom:1px solid var(--card-border)}
  .hero-search-btn{flex:100%;padding:12px;justify-content:center}
  .hero-search-divider{display:none}
  .section-header h2{font-size:30px}
  .stats-grid{grid-template-columns:repeat(2,1fr)}
  .steps-grid{grid-template-columns:1fr 1fr}
  .why-grid{grid-template-columns:1fr}
  .testimonials-top-row{grid-template-columns:1fr}
  .testimonials-video-row{grid-template-columns:1fr}
  .footer-grid{grid-template-columns:1fr}
  .book-grid{grid-template-columns:1fr;gap:32px}
  .profile-grid{grid-template-columns:1fr}
  .shortlist-grid{grid-template-columns:1fr}
  .pipeline-grid{grid-template-columns:repeat(2,1fr)}
  .cta-banner h2{font-size:28px}
  .auth-card{padding:32px 24px}
  .search-form-card{padding:24px}
  .students-table{font-size:12px}
  .students-table th,.students-table td{padding:8px 10px}
  .admin-content{padding:16px}
}
@media(max-width:480px){
  .hero h1{font-size:30px}
  .steps-grid{grid-template-columns:1fr}
  .uni-preview-grid{grid-template-columns:1fr}
  .pipeline-grid{grid-template-columns:1fr}
}
</style>
</head>
<body>

<!-- =================== NAVBAR =================== -->
<nav id="navbar">
  <div class="container">
    <div class="nav-inner">
      <div class="nav-logo" onclick="navigate('#home')" style="cursor:pointer">
        <div class="nav-logo-name"><span class="afro">Afro</span><span class="pol">Pol</span> <span class="nex">Nexus</span></div>
        <div class="nav-logo-tagline">In Partnership with The Varsity Plug</div>
      </div>
      <ul class="nav-links">
        <li><a href="#home" onclick="navigate('#home')">Home</a></li>
        <li><a href="#search" onclick="navigate('#search')">Find Programs</a></li>
        <li><a href="#home" onclick="navigate('#home');setTimeout(()=>document.getElementById('how-it-works')?.scrollIntoView({behavior:'smooth'}),100)">How It Works</a></li>
        <li><a href="#book-call" onclick="navigate('#book-call')">Book a Call</a></li>
      </ul>
      <div class="nav-actions">
        <span class="nav-signin" onclick="navigate('#login')" id="nav-signin-btn">Sign In</span>
        <button class="btn-primary btn-sm" onclick="navigate('#search')">Get Started ‚Üí</button>
        <button class="hamburger" id="hamburger-btn" onclick="toggleMobileMenu()">
          <span></span><span></span><span></span>
        </button>
      </div>
    </div>
  </div>
</nav>

<!-- Mobile Menu -->
<div id="mobile-menu">
  <a onclick="navigate('#home');closeMobileMenu()">üè† Home</a>
  <a onclick="navigate('#search');closeMobileMenu()">üîç Find Programs</a>
  <a onclick="navigate('#book-call');closeMobileMenu()">üìû Book a Call</a>
  <a onclick="navigate('#login');closeMobileMenu()" id="mobile-signin">Sign In</a>
  <button class="btn-primary mt-16" onclick="navigate('#search');closeMobileMenu()" style="width:100%;justify-content:center">Get Started ‚Üí</button>
</div>

<!-- =================== PAGE: HOME =================== -->
<div id="page-home" class="page">

  <!-- HERO -->
  <section class="hero">
    <div class="hero-bg-grid"></div>
    <div class="hero-bg-orb1"></div>
    <div class="hero-bg-orb2"></div>
    <div class="container" style="width:100%">
      <div class="hero-inner">
        <div class="hero-content">
          <div class="hero-eyebrow">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
            In Partnership with The Varsity Plug
          </div>
          <h1>Africa's Pathway<br>to <span class="typed-word" id="typed-word">Poland</span><span class="cursor-blink"></span>'s<br><span class="red">Top Universities</span></h1>
          <p>We connect ambitious African students with EU-accredited degree programs in Poland. English-taught. Affordable. Fully supported from search to visa.</p>

          <!-- Quick AI Match Search -->
          <div class="hero-search">
            <div class="hero-search-label">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
              Quick Program Match ‚Äî Find Your University
            </div>
            <div class="hero-search-row">
              <select class="hero-search-select" id="hero-field-select">
                <option value="">Field of Study</option>
                <option>Business</option><option>Management</option>
                <option>Finance & Accounting</option><option>IT/Computer Science</option>
                <option>Law</option><option>International Relations</option>
                <option>Psychology</option><option>Medicine & Health</option>
                <option>Architecture</option><option>Media & Journalism</option>
                <option>Agriculture & Life Sciences</option><option>Tourism & Hospitality</option>
              </select>
              <div class="hero-search-divider"></div>
              <select class="hero-search-select" id="hero-level-select">
                <option value="">Study Level</option>
                <option value="bachelor">Bachelor's</option>
                <option value="master">Master's</option>
                <option value="mba">MBA</option>
                <option value="long-cycle">Medicine / Long-cycle</option>
              </select>
              <div class="hero-search-divider"></div>
              <select class="hero-search-select" id="hero-city-select">
                <option value="">Any City</option>
                <option value="Warsaw">Warsaw</option>
                <option value="Krak√≥w">Krak√≥w</option>
                <option value="Rzesz√≥w">Rzesz√≥w</option>
              </select>
              <button class="hero-search-btn" onclick="heroQuickSearch()">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
                Find Match
              </button>
            </div>
            <div class="hero-search-tags">
              <span style="font-size:11px;color:var(--text-muted);font-weight:600;margin-right:4px">Popular:</span>
              <span class="hero-search-tag" onclick="quickTag('Business')">Business</span>
              <span class="hero-search-tag" onclick="quickTag('IT/Computer Science')">Computer Science</span>
              <span class="hero-search-tag" onclick="quickTag('Law')">Law</span>
              <span class="hero-search-tag" onclick="quickTag('Psychology')">Psychology</span>
              <span class="hero-search-tag" onclick="quickTag('Medicine & Health')">Medicine</span>
            </div>
          </div>

          <div class="hero-ctas">
            <button class="btn-primary" onclick="navigate('#search')">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
              <span>Browse All Programs</span>
            </button>
            <button class="btn-secondary" onclick="navigate('#book-call')">
              <span>Book Free Consultation</span>
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </button>
          </div>
          <div class="hero-trust">
            <span class="trust-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="#0038A8" stroke-width="2.5" stroke-linecap="round"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg>
              23 Partner Universities
            </span>
            <span class="trust-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="2.5" stroke-linecap="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
              EU-Accredited
            </span>
            <span class="trust-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="#E8000D" stroke-width="2.5" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
              Oct 2025 Intake Open
            </span>
            <span class="trust-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="#D97706" stroke-width="2.5" stroke-linecap="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
              20+ African Countries
            </span>
          </div>
        </div>
        <div class="hero-visual">
          <div class="hero-illustration">
            <div class="hero-card-stack">
              <div class="hero-card-bg"></div>
              <div class="hero-floating-badge hero-float-1">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="2.5"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                <span style="color:var(--dark)">Acceptance Letter ‚Äî 4 weeks</span>
              </div>
              <div class="hero-card-main">
                <div style="font-family:'Syne',sans-serif;font-size:12px;font-weight:700;color:var(--text-muted);margin-bottom:16px;letter-spacing:0.04em;text-transform:uppercase">Top Matched Programs</div>
                <div class="hero-uni-item">
                  <div class="hero-uni-dot" style="background:var(--red)"></div>
                  <div style="flex:1">
                    <div style="font-family:'Syne',sans-serif;font-size:13px;font-weight:700">VIZJA ‚Äî Management</div>
                    <div style="font-size:11px;color:var(--text-muted)">Warsaw ¬∑ Bachelor's ¬∑ ‚Ç¨3,800/sem</div>
                  </div>
                  <span class="match-high" style="font-size:11px;padding:3px 8px">98%</span>
                </div>
                <div class="hero-uni-item">
                  <div class="hero-uni-dot" style="background:var(--blue)"></div>
                  <div style="flex:1">
                    <div style="font-family:'Syne',sans-serif;font-size:13px;font-weight:700">Lazarski ‚Äî Law (LLB)</div>
                    <div style="font-size:11px;color:var(--text-muted)">Warsaw ¬∑ Bachelor's ¬∑ ‚Ç¨3,000/yr</div>
                  </div>
                  <span class="match-high" style="font-size:11px;padding:3px 8px">94%</span>
                </div>
                <div class="hero-uni-item">
                  <div class="hero-uni-dot" style="background:#059669"></div>
                  <div style="flex:1">
                    <div style="font-family:'Syne',sans-serif;font-size:13px;font-weight:700">WSB Merito ‚Äî Finance</div>
                    <div style="font-size:11px;color:var(--text-muted)">Warsaw ¬∑ Bachelor's ¬∑ ‚Ç¨1,250/yr</div>
                  </div>
                  <span class="match-mid" style="font-size:11px;padding:3px 8px">88%</span>
                </div>
                <div class="hero-uni-item">
                  <div class="hero-uni-dot" style="background:#7C3AED"></div>
                  <div style="flex:1">
                    <div style="font-family:'Syne',sans-serif;font-size:13px;font-weight:700">Jagiellonian ‚Äî Psychology</div>
                    <div style="font-size:11px;color:var(--text-muted)">Krak√≥w ¬∑ Bachelor's ¬∑ ‚Ç¨3,000/yr</div>
                  </div>
                  <span class="match-mid" style="font-size:11px;padding:3px 8px">85%</span>
                </div>
              </div>
              <div class="hero-floating-badge hero-float-2" style="bottom:8px;left:-8px">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--blue)" stroke-width="2.5"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg>
                <span style="color:var(--dark)">100+ English Programs</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- STATS BAR -->
  <div class="stats-bar">
    <div class="container">
      <div class="stats-grid">
        <div class="stat-item fade-in">
          <div class="stat-num" id="stat-unis">23</div>
          <div class="stat-label">Partner Universities</div>
        </div>
        <div class="stat-item fade-in">
          <div class="stat-num" id="stat-programs">150+</div>
          <div class="stat-label">Degree Programs</div>
        </div>
        <div class="stat-item fade-in">
          <div class="stat-num">EU</div>
          <div class="stat-label">Accredited Degrees</div>
        </div>
        <div class="stat-item fade-in">
          <div class="stat-num">20+</div>
          <div class="stat-label">African Countries Served</div>
        </div>
      </div>
    </div>
  </div>

  <!-- HOW IT WORKS -->
  <section class="section" id="how-it-works">
    <div class="container">
      <div class="section-header fade-in">
        <h2>Your Journey, Step by Step</h2>
        <p>From your first search to landing in Poland ‚Äî we guide you every step of the way.</p>
      </div>
      <div class="steps-grid">
        <div class="step-card fade-in">
          <div class="step-num">1</div>
          <div class="step-icon-wrap" style="background:#EEF2FF">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#0038A8" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
          </div>
          <div class="step-title">Search Programs</div>
          <div class="step-desc">Browse 150+ programs across 23 partner universities and get an instant AI match score.</div>
        </div>
        <div class="step-card fade-in">
          <div class="step-num">2</div>
          <div class="step-icon-wrap" style="background:#F0FDF4">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="2" stroke-linecap="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
          </div>
          <div class="step-title">Create Your Profile</div>
          <div class="step-desc">Share your qualifications and goals for smarter, personalised program matches.</div>
        </div>
        <div class="step-card fade-in">
          <div class="step-num">3</div>
          <div class="step-icon-wrap" style="background:#FFF7ED">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#D97706" stroke-width="2" stroke-linecap="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.68 12 19.79 19.79 0 0 1 1.61 3.18 2 2 0 0 1 3.6 1h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L7.91 8.78a16 16 0 0 0 5.48 5.48l.95-.95a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 21 15.6a2 2 0 0 1-.08.32z"/></svg>
          </div>
          <div class="step-title">Book a Free Call</div>
          <div class="step-desc">Speak with an expert consultant. Parents are welcome on the call ‚Äî the more the merrier.</div>
        </div>
        <div class="step-card fade-in">
          <div class="step-num">4</div>
          <div class="step-icon-wrap" style="background:#FEF2F2">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#E8000D" stroke-width="2" stroke-linecap="round"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
          </div>
          <div class="step-title">Deposit & We Apply</div>
          <div class="step-desc">A deposit starts the process. We handle your full application on your behalf.</div>
        </div>
        <div class="step-card fade-in">
          <div class="step-num">5</div>
          <div class="step-icon-wrap" style="background:#EEF2FF">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#0038A8" stroke-width="2" stroke-linecap="round"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg>
          </div>
          <div class="step-title">Arrive in Poland</div>
          <div class="step-desc">We guide you through visa, tuition, and your arrival at your Polish university.</div>
        </div>
      </div>
      <div class="steps-note mt-24 fade-in">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" style="flex-shrink:0;margin-top:2px"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
        <span>After your consultation, we guide you on which programs to apply for. A deposit is required to begin the application. After acceptance, the first year's tuition is paid ‚Äî then your visa application starts. South African students attend the Polish embassy in Pretoria or Cape Town.</span>
      </div>
    </div>
  </section>

  <!-- WHY POLAND -->
  <section class="section section-alt">
    <div class="container">
      <div class="section-header fade-in">
        <h2>Why Study in Poland?</h2>
        <p>World-class education at a fraction of the cost. Here's why thousands of African students choose Poland.</p>
      </div>
      <div class="why-grid">
        <div class="why-card fade-in">
          <div class="why-icon-wrap" style="background:#EEF2FF">
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#0038A8" stroke-width="2" stroke-linecap="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
          </div>
          <div class="why-title">EU-Recognised Degrees</div>
          <div class="why-desc">Your degree is valid across Europe and beyond. Polish universities are fully accredited in the EU and recognised internationally.</div>
        </div>
        <div class="why-card fade-in">
          <div class="why-icon-wrap" style="background:#F0FDF4">
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="2" stroke-linecap="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
          </div>
          <div class="why-title">Affordable Tuition</div>
          <div class="why-desc">From ‚Ç¨1,250/year ‚Äî a fraction of UK or US fees. World-class European education without lifelong debt.</div>
        </div>
        <div class="why-card fade-in">
          <div class="why-icon-wrap" style="background:#FFFBEB">
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#D97706" stroke-width="2" stroke-linecap="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
          </div>
          <div class="why-title">English Programs</div>
          <div class="why-desc">150+ fully English-taught degree programs ‚Äî no Polish language required to start your studies.</div>
        </div>
        <div class="why-card fade-in">
          <div class="why-icon-wrap" style="background:#FFF1F2">
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#E8000D" stroke-width="2" stroke-linecap="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
          </div>
          <div class="why-title">Vibrant Student Cities</div>
          <div class="why-desc">Warsaw, Krak√≥w, Rzesz√≥w ‚Äî safe, modern cities with rich culture, low living costs and strong student communities.</div>
        </div>
        <div class="why-card fade-in">
          <div class="why-icon-wrap" style="background:#EEF2FF">
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#0038A8" stroke-width="2" stroke-linecap="round"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>
          </div>
          <div class="why-title">Career Opportunities</div>
          <div class="why-desc">Europe's fastest-growing economy, strong job market, and EU work rights after graduation across 27 countries.</div>
        </div>
        <div class="why-card fade-in">
          <div class="why-icon-wrap" style="background:#F0FDF4">
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="2" stroke-linecap="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
          </div>
          <div class="why-title">Achievable Visa Pathway</div>
          <div class="why-desc">Clear, supported pathway for South African students. Polish embassies in Pretoria and Cape Town. We guide every step.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- UNIVERSITIES PREVIEW -->
  <section class="section">
    <div class="container">
      <div class="section-header fade-in">
        <h2>Our Partner Universities</h2>
        <p>23 partner universities across Poland, handpicked for African students. English-taught. EU-accredited. Fully supported.</p>
      </div>
      <div class="uni-preview-grid" id="uni-preview-grid"></div>
      <div class="view-all-link mt-32 fade-in">
        <a onclick="navigate('#search')">View All Universities & Programs ‚Üí</a>
      </div>
    </div>
  </section>

  <!-- TESTIMONIALS -->
  <section class="testimonials-section">
    <div class="container">
      <div class="section-header fade-in" style="margin-bottom:48px">
        <h2>Real Students. Real Journeys.</h2>
        <p>African students who made it to Poland ‚Äî in their own words and on their own screens.</p>
      </div>

      <!-- Written testimonials row -->
      <div class="testimonials-top-row">
        <div class="testimonial-card fade-in">
          <div class="testimonial-stars"><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span></div>
          <div class="testimonial-quote">"I never believed studying in Europe was achievable for me. AfroPol Nexus and The Varsity Plug changed everything. I'm now completing my Management degree in Warsaw."</div>
          <div class="testimonial-author">
            <div class="testimonial-avatar">RM</div>
            <div>
              <div class="testimonial-name">Rumbidzai Mundeta</div>
              <div class="testimonial-country">Zimbabwe ‚Äî Warsaw, Poland üáµüá±</div>
            </div>
          </div>
        </div>
        <div class="testimonial-card fade-in">
          <div class="testimonial-stars"><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span></div>
          <div class="testimonial-quote">"The consultation was incredible ‚Äî they knew exactly which program matched my background. I had my acceptance letter within 5 weeks. Now I'm studying Law in Warsaw."</div>
          <div class="testimonial-author">
            <div class="testimonial-avatar">TM</div>
            <div>
              <div class="testimonial-name">Tatenda Moyo</div>
              <div class="testimonial-country">Zimbabwe ‚Äî Warsaw, Poland üáµüá±</div>
            </div>
          </div>
        </div>
        <div class="testimonial-card fade-in">
          <div class="testimonial-stars"><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span></div>
          <div class="testimonial-quote">"From search to visa ‚Äî everything was handled. The team is always reachable on WhatsApp. Living my dream in Krak√≥w. Highly recommend to every student in Africa."</div>
          <div class="testimonial-author">
            <div class="testimonial-avatar">CN</div>
            <div>
              <div class="testimonial-name">Chiedza Nhamo</div>
              <div class="testimonial-country">Zimbabwe ‚Äî Krak√≥w, Poland üáµüá±</div>
            </div>
          </div>
        </div>
      </div>

      <!-- More testimonials -->
      <div class="testimonials-top-row" style="margin-bottom:32px">
        <div class="testimonial-card fade-in">
          <div class="testimonial-stars"><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span></div>
          <div class="testimonial-quote">"I applied for Computer Science at VIZJA and was accepted in under a month. The support from The Varsity Plug team was beyond anything I expected. Poland is amazing."</div>
          <div class="testimonial-author">
            <div class="testimonial-avatar">FM</div>
            <div>
              <div class="testimonial-name">Farai Mutasa</div>
              <div class="testimonial-country">Zimbabwe ‚Äî Warsaw, Poland üáµüá±</div>
            </div>
          </div>
        </div>
        <div class="testimonial-card fade-in">
          <div class="testimonial-stars"><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span></div>
          <div class="testimonial-quote">"I was sceptical at first but the team walked me through every single step ‚Äî even called me personally before my visa appointment. Now I'm here and loving it."</div>
          <div class="testimonial-author">
            <div class="testimonial-avatar">BZ</div>
            <div>
              <div class="testimonial-name">Blessing Zimba</div>
              <div class="testimonial-country">Zimbabwe ‚Äî Warsaw, Poland üáµüá±</div>
            </div>
          </div>
        </div>
        <div class="testimonial-card fade-in">
          <div class="testimonial-stars"><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span></div>
          <div class="testimonial-quote">"My parents joined the consultation call and by the end, even they were excited. The process was clear, professional, and totally worth it. Studying Finance at Lazarski."</div>
          <div class="testimonial-author">
            <div class="testimonial-avatar">NK</div>
            <div>
              <div class="testimonial-name">Nyasha Khumalo</div>
              <div class="testimonial-country">Zimbabwe ‚Äî Warsaw, Poland üáµüá±</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Video testimonials row -->
      <div style="margin-bottom:16px">
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:24px">
          <h3 style="font-family:'Syne',sans-serif;font-size:22px;font-weight:700">Student Life in Poland ‚Äî Watch Their Stories</h3>
          <span class="live-badge"><span class="live-dot"></span>Real Videos</span>
        </div>
      </div>
      <div class="testimonials-video-row">

        <!-- Facebook video -->
        <div class="video-testimonial-card fade-in">
          <div class="video-wrapper">
            <iframe src="https://www.facebook.com/plugins/video.php?href=https%3A%2F%2Fwww.facebook.com%2Fwatch%2F%3Fv%3DFqi9qSiz8V&width=500&show_text=false&height=280" width="500" height="280" scrolling="no" frameborder="0" allowfullscreen allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share" allowFullScreen></iframe>
          </div>
          <div class="video-card-body">
            <div class="video-card-student">
              <div class="video-card-avatar">RM</div>
              <div>
                <div class="video-card-name">Rumbidzai Mundeta</div>
                <div class="video-card-tag">Zimbabwe ¬∑ Student in Warsaw</div>
              </div>
            </div>
            <div class="video-card-desc">Watch Rumbidzai share her experience coming to Poland and how the process worked for her as an African student.</div>
          </div>
        </div>

        <!-- YouTube - Life in Poland Q&A -->
        <div class="video-testimonial-card fade-in">
          <div class="video-wrapper">
            <iframe src="https://www.youtube.com/embed/UxsQgsUwsEQ?si=s6JVmAikTnBHjXmy" title="Life in Poland Q&A ‚Äî Nandipha Dube" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
          </div>
          <div class="video-card-body">
            <div class="video-card-student">
              <div class="video-card-avatar">ND</div>
              <div>
                <div class="video-card-name">Nandipha Dube</div>
                <div class="video-card-tag">South Africa ¬∑ International Student in Poland</div>
              </div>
            </div>
            <div class="video-card-desc">Life in Poland Q&A ‚Äî Nandipha answers your most asked questions about studying and living in Poland as an African student.</div>
          </div>
        </div>

        <!-- YouTube - Productive Days -->
        <div class="video-testimonial-card fade-in">
          <div class="video-wrapper">
            <iframe src="https://www.youtube.com/embed/E-tmez-DYRE?si=unh74_BdI03nQbQq" title="Productive Day as an International Student in Poland" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
          </div>
          <div class="video-card-body">
            <div class="video-card-student">
              <div class="video-card-avatar">ND</div>
              <div>
                <div class="video-card-name">Nandipha Dube</div>
                <div class="video-card-tag">South Africa ¬∑ Daily Life Vlog</div>
              </div>
            </div>
            <div class="video-card-desc">A productive day in the life of an international student in Poland ‚Äî from lectures to city life and what campus really feels like.</div>
          </div>
        </div>

      </div>

      <div style="text-align:center;margin-top:8px">
        <button class="btn-primary" onclick="navigate('#book-call')">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.68 12 19.79 19.79 0 0 1 1.61 3.18 2 2 0 0 1 3.6 1h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L7.91 8.78a16 16 0 0 0 5.48 5.48l.95-.95a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 21 15.6a2 2 0 0 1-.08.32z"/></svg>
          <span>Start Your Journey ‚Äî Book a Free Call</span>
        </button>
      </div>
    </div>
  </section>

  <!-- CTA BANNER -->
  <section class="cta-banner">
    <div class="container">
      <h2 class="fade-in">Ready to Start Your Journey?</h2>
      <p class="fade-in">Join hundreds of African students building their European future. Your place at a Polish university is waiting.</p>
      <div class="cta-banner-btns fade-in">
        <button class="btn-white" onclick="navigate('#search')">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
          Find My Program
        </button>
        <button class="btn-white-outline" onclick="navigate('#book-call')">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.68 12"/><path d="M1.61 3.18A2 2 0 0 1 3.6 1h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L7.91 8.78a16 16 0 0 0 5.48 5.48"/></svg>
          Book a Free Call
        </button>
      </div>
      <div class="partnership">In Partnership with The Varsity Plug</div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="container">
      <div class="footer-grid">
        <div>
          <div class="footer-logo-name"><span style="color:var(--blue)">Afro</span><span style="color:var(--red)">Pol</span> Nexus</div>
          <div style="font-size:12px;color:var(--text-muted);margin-bottom:4px">In Partnership with The Varsity Plug</div>
          <div class="footer-tagline">Your Gateway to Poland's Top Universities. Africa's #1 Poland university recruitment platform.</div>
          <div class="footer-wa-btns">
            <a href="https://wa.me/48579108304" target="_blank" class="btn-wa btn-sm"><i class="fab fa-whatsapp"></i> Consultant 1: +48 579 108 304</a>
            <a href="https://wa.me/48729285041" target="_blank" class="btn-wa btn-sm"><i class="fab fa-whatsapp"></i> Consultant 2: +48 729 285 041</a>
          </div>
        </div>
        <div class="footer-links">
          <h4>Quick Links</h4>
          <ul>
            <li><a onclick="navigate('#home')">Home</a></li>
            <li><a onclick="navigate('#search')">Find Programs</a></li>
            <li><a onclick="navigate('#book-call')">Book a Call</a></li>
            <li><a onclick="navigate('#login')">Sign In</a></li>
            <li><a onclick="navigate('#register')">Create Account</a></li>
          </ul>
        </div>
        <div class="footer-links">
          <h4>Contact Us</h4>
          <ul>
            <li><span style="font-size:13px;color:var(--text-muted)">üì± +48 579 108 304</span></li>
            <li><span style="font-size:13px;color:var(--text-muted)">üì± +48 729 285 041</span></li>
            <li><span style="font-size:13px;color:var(--text-muted)">üìß <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="264f484049664740544956494a0b48435e53550845494b">[email&#160;protected]</a></span></li>
            <li><span style="font-size:13px;color:var(--text-muted)">üáµüá± Warsaw, Poland</span></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <div class="container">
        <div class="footer-bottom-inner">
          <span>¬© 2025 AfroPol Nexus ‚Äî In Partnership with The Varsity Plug. Africa's #1 Poland University Recruitment Platform.</span>
          <span class="footer-admin-link" onclick="navigate('#admin')">Admin</span>
        </div>
      </div>
    </div>
  </footer>
</div>

<!-- =================== PAGE: SEARCH =================== -->
<div id="page-search" class="page">
  <div class="search-header">
    <div class="container">
      <h1>Find Your <span style="color:var(--red)">Perfect Program</span></h1>
      <p>Tell us what you're looking for and we'll match you with the best programs from our 8 partner universities.</p>
    </div>
  </div>
  <div class="container">
    <div class="search-form-card">
      <div class="search-step">
        <div class="search-step-label">Step 1 ‚Äî What do you want to study?</div>
        <div class="field-chips" id="field-chips"></div>
      </div>
      <div class="search-step">
        <div class="search-step-label">Step 2 ‚Äî Study level</div>
        <div class="level-pills" id="level-pills">
          <div class="level-pill selected" data-val="any">Any Level</div>
          <div class="level-pill" data-val="bachelor">Bachelor's</div>
          <div class="level-pill" data-val="master">Master's</div>
          <div class="level-pill" data-val="mba">MBA</div>
          <div class="level-pill" data-val="long-cycle">Long-cycle</div>
        </div>
      </div>
      <div class="search-step">
        <div class="search-step-label">Step 3 ‚Äî Preferred city</div>
        <div class="city-pills" id="city-pills">
          <div class="city-pill selected" data-val="all">All Poland</div>
          <div class="city-pill" data-val="Warsaw">Warsaw</div>
          <div class="city-pill" data-val="Krak√≥w">Krak√≥w</div>
          <div class="city-pill" data-val="Rzesz√≥w">Rzesz√≥w</div>
        </div>
      </div>
      <div class="search-step">
        <div class="search-step-label">Step 4 ‚Äî Tell us more (optional)</div>
        <textarea class="search-textarea" id="search-freetext" placeholder="E.g. I'm interested in business and technology, I have a matric certificate, I prefer English-taught programs..."></textarea>
      </div>
      <button class="btn-primary" style="width:100%;justify-content:center;font-size:16px;padding:16px" onclick="runSearch()">Find My Match ‚Üí</button>
    </div>

    <div id="search-loading" class="search-loading">
      <div class="spinner" style="margin:0 auto 16px"></div>
      <div style="color:var(--text-muted);font-size:14px">Matching you with the best programs...</div>
    </div>

    <div id="search-results" style="display:none">
      <div class="results-header">
        <div class="results-count" id="results-count">Found 0 programs</div>
        <select class="sort-select" id="sort-select" onchange="sortResults()">
          <option value="match">Best Match</option>
          <option value="tuition-low">Tuition: Low to High</option>
          <option value="alpha">Alphabetical</option>
        </select>
      </div>
      <div class="results-grid" id="results-grid"></div>
      <div id="no-results" class="empty-state" style="display:none">
        <i class="fas fa-search"></i>
        <h3 style="font-family:'Syne',sans-serif;margin-bottom:8px">No programs found</h3>
        <p>Try selecting different fields or broadening your search criteria.</p>
        <button class="btn-primary mt-24" onclick="clearSearch()">Clear & Try Again</button>
      </div>
    </div>
  </div>

  <!-- Compare Bar -->
  <div id="compare-bar">
    <span class="compare-bar-label">Comparing</span>
    <strong id="compare-count">0 programs</strong>
    <button class="btn-compare-view" onclick="openCompareModal()">View Comparison</button>
    <button onclick="clearCompare()" style="background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.2);padding:6px 12px;border-radius:6px;font-size:12px;cursor:pointer">Clear</button>
  </div>
</div>

<!-- Compare Modal -->
<div class="modal-overlay" id="compare-modal">
  <div class="modal-box">
    <div class="modal-header">
      <h3>Program Comparison</h3>
      <button class="modal-close" onclick="closeCompareModal()">√ó</button>
    </div>
    <div id="compare-table-container"></div>
    <div style="margin-top:24px;text-align:center">
      <button class="btn-primary" onclick="navigate('#book-call');closeCompareModal()">Book a Consultation ‚Üí</button>
    </div>
  </div>
</div>

<!-- =================== PAGE: LOGIN =================== -->
<div id="page-login" class="page">
  <div class="auth-page">
    <div class="auth-card">
      <div class="auth-logo">
        <div class="auth-logo-name"><span style="color:var(--blue)">Afro</span><span style="color:var(--red)">Pol</span> Nexus</div>
        <div style="font-size:12px;color:var(--text-muted)">In Partnership with The Varsity Plug</div>
      </div>
      <h2>Welcome Back</h2>
      <div class="auth-subtitle">Sign in to access your profile and shortlist.</div>
      <div class="form-group">
        <label class="form-label">Email Address</label>
        <input class="form-input" type="email" id="login-email" placeholder="you@example.com">
      </div>
      <div class="form-group">
        <label class="form-label">Password</label>
        <input class="form-input" type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
      </div>
      <div style="text-align:right;margin-bottom:20px">
        <span class="auth-link" onclick="alert('Please contact us on WhatsApp to reset your password.')">Forgot password?</span>
      </div>
      <button class="btn-primary w-full" style="justify-content:center" onclick="doLogin()">Sign In ‚Üí</button>
      <div id="login-error" style="color:var(--red);font-size:13px;margin-top:12px;text-align:center;display:none">Invalid email or password.</div>
      <div class="auth-divider">New student?</div>
      <button class="btn-secondary w-full" style="justify-content:center" onclick="navigate('#register')">Create Free Account ‚Üí</button>
      <div class="auth-small mt-16">In Partnership with The Varsity Plug</div>
    </div>
  </div>
</div>

<!-- =================== PAGE: REGISTER =================== -->
<div id="page-register" class="page">
  <div class="auth-page" style="align-items:flex-start;padding-top:40px">
    <div class="auth-card" style="max-width:520px">
      <div class="auth-logo">
        <div class="auth-logo-name"><span style="color:var(--blue)">Afro</span><span style="color:var(--red)">Pol</span> Nexus</div>
      </div>
      <h2>Create Your Account</h2>
      <div class="auth-subtitle">Start your journey to Poland today. Free, takes 2 minutes.</div>
      
      <div class="step-indicator" id="reg-step-indicator">Step 1 of 3 ‚Äî Personal Information</div>
      <div class="step-progress">
        <div class="step-progress-item active" id="rsp1"></div>
        <div class="step-progress-item" id="rsp2"></div>
        <div class="step-progress-item" id="rsp3"></div>
      </div>

      <!-- Step 1 -->
      <div class="register-step active" id="reg-step-1">
        <div class="profile-grid">
          <div class="form-group">
            <label class="form-label">Full Name *</label>
            <input class="form-input" type="text" id="reg-name" placeholder="Your full name">
          </div>
          <div class="form-group">
            <label class="form-label">Email Address *</label>
            <input class="form-input" type="email" id="reg-email" placeholder="you@example.com">
          </div>
        </div>
        <div class="profile-grid">
          <div class="form-group">
            <label class="form-label">Password *</label>
            <input class="form-input" type="password" id="reg-password" placeholder="Min. 6 characters">
          </div>
          <div class="form-group">
            <label class="form-label">Confirm Password *</label>
            <input class="form-input" type="password" id="reg-password2" placeholder="Repeat password">
          </div>
        </div>
        <div class="profile-grid">
          <div class="form-group">
            <label class="form-label">Nationality *</label>
            <input class="form-input" type="text" id="reg-nationality" placeholder="e.g. South African">
          </div>
          <div class="form-group">
            <label class="form-label">Country of Residence *</label>
            <input class="form-input" type="text" id="reg-country" placeholder="e.g. South Africa">
          </div>
        </div>
        <div id="reg-error-1" style="color:var(--red);font-size:13px;margin-bottom:12px;display:none"></div>
        <button class="btn-primary w-full" style="justify-content:center" onclick="regNextStep(1)">Continue ‚Üí</button>
      </div>

      <!-- Step 2 -->
      <div class="register-step" id="reg-step-2">
        <div class="profile-grid">
          <div class="form-group">
            <label class="form-label">Phone Number *</label>
            <input class="form-input" type="tel" id="reg-phone" placeholder="+27 ...">
          </div>
          <div class="form-group">
            <label class="form-label">WhatsApp Number *</label>
            <input class="form-input" type="tel" id="reg-whatsapp" placeholder="+27 ...">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Date of Birth</label>
          <input class="form-input" type="date" id="reg-dob">
        </div>
        <div id="reg-error-2" style="color:var(--red);font-size:13px;margin-bottom:12px;display:none"></div>
        <div style="display:flex;gap:12px">
          <button class="btn-secondary" style="flex:1;justify-content:center" onclick="regPrevStep(2)">‚Üê Back</button>
          <button class="btn-primary" style="flex:2;justify-content:center" onclick="regNextStep(2)">Continue ‚Üí</button>
        </div>
      </div>

      <!-- Step 3 -->
      <div class="register-step" id="reg-step-3">
        <div class="form-group">
          <label class="form-label">Fields of Interest (select all that apply)</label>
          <div class="field-chips" id="reg-field-chips" style="margin-top:8px"></div>
        </div>
        <div class="form-group">
          <label class="form-label">Study Level</label>
          <select class="form-select" id="reg-level">
            <option value="">Select level...</option>
            <option value="bachelor">Bachelor's (1st Cycle)</option>
            <option value="master">Master's (2nd Cycle)</option>
            <option value="mba">MBA</option>
            <option value="long-cycle">Long-Cycle (Medicine/Vet)</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">How did you hear about us?</label>
          <select class="form-select" id="reg-source">
            <option value="">Select...</option>
            <option>WhatsApp</option>
            <option>Instagram</option>
            <option>Facebook</option>
            <option>TikTok</option>
            <option>Friend/Family</option>
            <option>Google</option>
            <option>Other</option>
          </select>
        </div>
        <div id="reg-error-3" style="color:var(--red);font-size:13px;margin-bottom:12px;display:none"></div>
        <div style="display:flex;gap:12px">
          <button class="btn-secondary" style="flex:1;justify-content:center" onclick="regPrevStep(3)">‚Üê Back</button>
          <button class="btn-primary" style="flex:2;justify-content:center" onclick="doRegister()">Create Account ‚Üí</button>
        </div>
      </div>
      <div class="auth-small mt-16">Already have an account? <span class="auth-link" onclick="navigate('#login')">Sign In</span></div>
    </div>
  </div>
</div>

<!-- =================== PAGE: PROFILE =================== -->
<div id="page-profile" class="page">
  <div class="profile-header">
    <div class="container">
      <div class="profile-header-inner">
        <div class="profile-avatar-large" id="profile-avatar-lg">??</div>
        <div>
          <div style="font-family:'Syne',sans-serif;font-size:22px;font-weight:700" id="profile-display-name">My Profile</div>
          <div style="font-size:13px;color:var(--text-muted);margin-bottom:12px">Complete your profile for better program matches</div>
          <div class="profile-completion-bar">
            <div class="completion-label">
              <span>Profile Completion</span>
              <span id="completion-pct-label">0%</span>
            </div>
            <div class="completion-track">
              <div class="completion-fill" id="completion-fill" style="width:0%"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="container profile-section">
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('profile','personal')">Personal Details</button>
      <button class="tab-btn" onclick="switchTab('profile','education')">Education</button>
      <button class="tab-btn" onclick="switchTab('profile','language')">Language & Skills</button>
      <button class="tab-btn" onclick="switchTab('profile','documents')">Documents</button>
      <button class="tab-btn" onclick="switchTab('profile','preferences')">Study Preferences</button>
    </div>

    <!-- Tab: Personal -->
    <div class="tab-pane active" id="profile-tab-personal">
      <div class="profile-grid">
        <div class="form-group"><label class="form-label">Full Name</label><input class="form-input" id="p-name" placeholder="Full name"></div>
        <div class="form-group"><label class="form-label">Date of Birth</label><input class="form-input" type="date" id="p-dob"></div>
        <div class="form-group"><label class="form-label">Nationality</label><input class="form-input" id="p-nationality" placeholder="e.g. South African"></div>
        <div class="form-group"><label class="form-label">Country of Residence</label><input class="form-input" id="p-country" placeholder="e.g. South Africa"></div>
        <div class="form-group"><label class="form-label">Phone Number</label><input class="form-input" id="p-phone" placeholder="+27..."></div>
        <div class="form-group"><label class="form-label">WhatsApp Number</label><input class="form-input" id="p-whatsapp" placeholder="+27..."></div>
      </div>
    </div>

    <!-- Tab: Education -->
    <div class="tab-pane" id="profile-tab-education">
      <div class="profile-grid">
        <div class="form-group"><label class="form-label">School / Institution Name</label><input class="form-input" id="p-school" placeholder="Name of school"></div>
        <div class="form-group"><label class="form-label">Country Where Studied</label><input class="form-input" id="p-school-country" placeholder="e.g. South Africa"></div>
        <div class="form-group"><label class="form-label">Year Started</label><input class="form-input" type="number" id="p-year-from" placeholder="e.g. 2020"></div>
        <div class="form-group"><label class="form-label">Year Ended</label><input class="form-input" type="number" id="p-year-to" placeholder="e.g. 2024"></div>
        <div class="form-group"><label class="form-label">Qualification Type</label>
          <select class="form-select" id="p-qualification">
            <option value="">Select...</option>
            <option>Matric / NSC</option>
            <option>A-Levels</option>
            <option>International Baccalaureate</option>
            <option>Bachelor's Degree</option>
            <option>Other</option>
          </select>
        </div>
        <div class="form-group"><label class="form-label">Overall Average / %</label><input class="form-input" id="p-average" placeholder="e.g. 72%"></div>
      </div>
      <div class="form-group mt-16">
        <label class="form-label">Subjects & Grades</label>
        <table class="subjects-table">
          <thead><tr><th>Subject</th><th>Grade / Mark</th></tr></thead>
          <tbody id="subjects-tbody">
            <tr><td><input class="form-input" placeholder="Subject name" style="font-size:13px;padding:6px 10px"></td><td><input class="form-input" placeholder="Grade" style="font-size:13px;padding:6px 10px"></td></tr>
            <tr><td><input class="form-input" placeholder="Subject name" style="font-size:13px;padding:6px 10px"></td><td><input class="form-input" placeholder="Grade" style="font-size:13px;padding:6px 10px"></td></tr>
            <tr><td><input class="form-input" placeholder="Subject name" style="font-size:13px;padding:6px 10px"></td><td><input class="form-input" placeholder="Grade" style="font-size:13px;padding:6px 10px"></td></tr>
          </tbody>
        </table>
        <button class="btn-ghost-red btn-sm mt-8" onclick="addSubjectRow()">+ Add Subject</button>
      </div>
    </div>

    <!-- Tab: Language -->
    <div class="tab-pane" id="profile-tab-language">
      <div class="form-group">
        <label class="form-label">English Proficiency</label>
        <select class="form-select" id="p-english" onchange="toggleEnglishFields()">
          <option value="">Select...</option>
          <option value="native">Native English Speaker</option>
          <option value="ielts">IELTS</option>
          <option value="toefl">TOEFL</option>
          <option value="certificate">School Certificate</option>
        </select>
      </div>
      <div id="english-score-field" style="display:none">
        <div class="form-group"><label class="form-label" id="english-score-label">Score</label><input class="form-input" id="p-english-score" placeholder="e.g. 6.5"></div>
      </div>
      <div class="form-group">
        <label class="form-label">Other Languages (optional)</label>
        <input class="form-input" id="p-other-langs" placeholder="e.g. French (intermediate), Zulu (native)">
      </div>
    </div>

    <!-- Tab: Documents -->
    <div class="tab-pane" id="profile-tab-documents">
      <div style="background:#EEF2FF;border:1px solid #C7D2FE;border-radius:8px;padding:14px 16px;font-size:13px;color:var(--blue);margin-bottom:24px">
        üìã Documents you upload will be shared with your assigned consultant and the university during your application.
      </div>
      <div id="profile-doc-slots"></div>
    </div>

    <!-- Tab: Preferences -->
    <div class="tab-pane" id="profile-tab-preferences">
      <div class="form-group">
        <label class="form-label">Fields of Interest</label>
        <div class="field-chips" id="pref-field-chips" style="margin-top:8px"></div>
      </div>
      <div class="profile-grid">
        <div class="form-group">
          <label class="form-label">Preferred Study Level</label>
          <select class="form-select" id="p-pref-level">
            <option value="">Select...</option>
            <option>Bachelor's</option><option>Master's</option><option>MBA</option><option>Long-cycle</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Budget Range</label>
          <select class="form-select" id="p-budget">
            <option value="">Select...</option>
            <option>&lt; ‚Ç¨2,000/yr</option>
            <option>‚Ç¨2,000‚Äì‚Ç¨4,000/yr</option>
            <option>&gt; ‚Ç¨4,000/yr</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Preferred City</label>
          <select class="form-select" id="p-pref-city">
            <option value="">Any city</option>
            <option>Warsaw</option><option>Krak√≥w</option><option>Rzesz√≥w</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Target Start Date</label>
          <select class="form-select" id="p-start-date">
            <option value="">Select...</option>
            <option>Oct 2025</option><option>Feb 2026</option><option>Oct 2026</option><option>Flexible</option>
          </select>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Personal Statement / Notes</label>
        <textarea class="search-textarea" id="p-statement" placeholder="Tell us about yourself, your goals, and what you're looking for..." style="min-height:120px"></textarea>
      </div>
    </div>
  </div>
  <div class="save-sticky">
    <div class="container">
      <button class="btn-primary" style="padding:14px 48px" onclick="saveProfile()">üíæ Save Profile</button>
    </div>
  </div>
</div>

<!-- =================== PAGE: DASHBOARD =================== -->
<div id="page-dashboard" class="page">
  <div class="dashboard-header">
    <div class="container">
      <div class="flex-between">
        <div>
          <div style="font-family:'Syne',sans-serif;font-size:26px;font-weight:700" id="dash-welcome">Welcome back!</div>
          <div style="font-size:14px;color:var(--text-muted);margin-top:4px" id="dash-subtitle">Here's your application overview.</div>
        </div>
        <div style="display:flex;align-items:center;gap:12px">
          <span class="stage-badge badge-yellow" id="dash-stage-badge">üü° New Lead</span>
          <button class="btn-ghost-red btn-sm" onclick="navigate('#profile')">Edit Profile</button>
        </div>
      </div>
    </div>
  </div>
  <div class="container" style="padding-top:32px">
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('dash','shortlist')">üìå My Shortlist</button>
      <button class="tab-btn" onclick="switchTab('dash','application')">üìã My Application</button>
      <button class="tab-btn" onclick="switchTab('dash','visa')">üõÇ Visa Guide</button>
      <button class="tab-btn" onclick="switchTab('dash','contact')">üí¨ Contact Consultant</button>
    </div>

    <!-- Shortlist Tab -->
    <div class="tab-pane active" id="dash-tab-shortlist">
      <div id="shortlist-grid-container"></div>
    </div>

    <!-- Application Tab -->
    <div class="tab-pane" id="dash-tab-application">
      <h3 style="font-family:'Syne',sans-serif;font-size:18px;font-weight:700;margin-bottom:8px">Application Progress</h3>
      <div class="app-stages" id="app-stages-track"></div>
      
      <h4 style="font-family:'Syne',sans-serif;font-size:15px;font-weight:700;margin-bottom:12px">Consultant Notes</h4>
      <div id="dash-consultant-notes" style="background:var(--bg-section);border-radius:8px;padding:16px;font-size:13px;color:var(--text-muted);min-height:60px">
        No notes from your consultant yet. Check back after your consultation call.
      </div>

      <h4 style="font-family:'Syne',sans-serif;font-size:15px;font-weight:700;margin:24px 0 12px">University Application Documents</h4>
      <div id="app-doc-slots"></div>
      
      <h4 style="font-family:'Syne',sans-serif;font-size:15px;font-weight:700;margin:24px 0 12px">Visa Documents</h4>
      <div id="visa-doc-slots"></div>
    </div>

    <!-- Visa Guide Tab -->
    <div class="tab-pane" id="dash-tab-visa">
      <h3 style="font-family:'Syne',sans-serif;font-size:22px;font-weight:700;margin-bottom:8px">Polish Student Visa for South Africans</h3>
      <p style="font-size:14px;color:var(--text-muted);margin-bottom:24px">A step-by-step guide to obtaining your Polish student visa.</p>
      <div class="visa-steps">
        <div class="visa-step"><div class="visa-step-num">1</div><div class="visa-step-content"><h4>Receive Official Acceptance Letter</h4><p>Get your official acceptance letter from the Polish university through AfroPol Nexus.</p></div></div>
        <div class="visa-step"><div class="visa-step-num">2</div><div class="visa-step-content"><h4>Pay First Year Tuition</h4><p>Pay your first year's tuition fee ‚Äî this is required before starting the visa application process.</p></div></div>
        <div class="visa-step"><div class="visa-step-num">3</div><div class="visa-step-content"><h4>Document Authentication (NAWA Apostille)</h4><p>Get your South African documents authenticated with an apostille stamp via NAWA for use in Poland.</p></div></div>
        <div class="visa-step"><div class="visa-step-num">4</div><div class="visa-step-content"><h4>Book Embassy Appointment</h4><p>Book your appointment at the Polish Embassy in Pretoria or Cape Town, South Africa.</p></div></div>
        <div class="visa-step"><div class="visa-step-num">5</div><div class="visa-step-content"><h4>Submit Visa Application</h4><p>Submit your complete application with all required documents at the embassy appointment.</p></div></div>
        <div class="visa-step"><div class="visa-step-num">6</div><div class="visa-step-content"><h4>Receive Visa ‚Äî Travel to Poland! üéâ</h4><p>Collect your visa, book your flights, and begin your European adventure!</p></div></div>
      </div>
      <div style="background:var(--bg-section);border:1px solid var(--card-border);border-radius:var(--border-radius);padding:20px;margin-top:24px">
        <h4 style="font-family:'Syne',sans-serif;font-size:15px;font-weight:700;margin-bottom:12px">Visa Document Checklist</h4>
        <ul style="list-style:none;display:flex;flex-direction:column;gap:8px;font-size:13px">
          <li>‚úÖ Valid passport (min. 6 months validity)</li>
          <li>‚úÖ Official acceptance letter from university</li>
          <li>‚úÖ Proof of tuition payment for first year</li>
          <li>‚úÖ Bank statement (proof of funds)</li>
          <li>‚úÖ Certified and apostilled school transcripts</li>
          <li>‚úÖ Visa application form (filled)</li>
          <li>‚úÖ Biometric photos (35x45mm)</li>
          <li>‚úÖ Travel insurance (min. ‚Ç¨30,000 coverage)</li>
          <li>‚úÖ Proof of accommodation in Poland</li>
        </ul>
      </div>
      <a href="https://www.gov.pl/web/foreign-affairs" target="_blank" class="btn-secondary mt-16" style="display:inline-flex">View Polish Embassy Website ‚Üí</a>
      <div style="margin-top:24px">
        <a href="https://wa.me/48579108304" target="_blank" class="btn-wa">üí¨ Have questions about your visa? Chat with us ‚Üí</a>
      </div>
    </div>

    <!-- Contact Tab -->
    <div class="tab-pane" id="dash-tab-contact">
      <h3 style="font-family:'Syne',sans-serif;font-size:22px;font-weight:700;margin-bottom:8px">Contact Your Consultant</h3>
      <p style="font-size:14px;color:var(--text-muted);margin-bottom:32px">Your consultant will reach out within 48 hours of your profile being complete.</p>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;max-width:600px">
        <a href="https://wa.me/48579108304" target="_blank" class="btn-wa" style="justify-content:center;padding:16px"><i class="fab fa-whatsapp"></i> Consultant 1<br><small>+48 579 108 304</small></a>
        <a href="https://wa.me/48729285041" target="_blank" class="btn-wa" style="justify-content:center;padding:16px"><i class="fab fa-whatsapp"></i> Consultant 2<br><small>+48 729 285 041</small></a>
      </div>
      <div style="margin-top:24px">
        <a href="/cdn-cgi/l/email-protection#abc2c5cdc4ebcacdd9c4dbc4c786c5ced3ded885c8c4c6" class="btn-secondary" style="display:inline-flex"><i class="fas fa-envelope"></i>&nbsp; <span class="__cf_email__" data-cfemail="e0898e868fa08186928f908f8ccd8e85989593ce838f8d">[email&#160;protected]</span></a>
      </div>
    </div>
  </div>
</div>

<!-- =================== PAGE: BOOK A CALL =================== -->
<div id="page-book-call" class="page">
  <div class="book-header">
    <div class="container">
      <div class="flex-center gap-16" style="margin-bottom:8px">
        <div class="partnership-badge">ü§ù In Partnership with The Varsity Plug</div>
      </div>
      <h1 style="font-family:'Syne',sans-serif;font-size:40px;font-weight:800;margin-top:12px">Book Your Free Consultation Call</h1>
      <p style="font-size:15px;color:var(--text-muted);margin-top:8px">Our expert consultants are here to guide you. Bring your parents ‚Äî the more the merrier! üë®‚Äçüë©‚Äçüëß</p>
    </div>
  </div>
  <div class="container">
    <div class="book-grid">
      <div>
        <h3 style="font-family:'Syne',sans-serif;font-size:20px;font-weight:700;margin-bottom:20px">What to Expect on the Call</h3>
        <div class="expect-card"><div class="expect-icon">üëÅÔ∏è</div><div><strong style="font-size:14px">We review your profile</strong><p style="font-size:13px;color:var(--text-muted);margin-top:4px">We look at your qualifications and academic background together.</p></div></div>
        <div class="expect-card"><div class="expect-icon">üéØ</div><div><strong style="font-size:14px">We recommend best-fit programs</strong><p style="font-size:13px;color:var(--text-muted);margin-top:4px">Personalised program recommendations based on your profile and goals.</p></div></div>
        <div class="expect-card"><div class="expect-icon">üìã</div><div><strong style="font-size:14px">We explain the full process</strong><p style="font-size:13px;color:var(--text-muted);margin-top:4px">Application timeline, document requirements, and next steps fully explained.</p></div></div>
        <div class="expect-card"><div class="expect-icon">üí¨</div><div><strong style="font-size:14px">We answer all your questions</strong><p style="font-size:13px;color:var(--text-muted);margin-top:4px">Parents' questions welcome too! No question is too big or too small.</p></div></div>
        <div class="expect-card"><div class="expect-icon">üí≥</div><div><strong style="font-size:14px">We discuss the deposit</strong><p style="font-size:13px;color:var(--text-muted);margin-top:4px">After the call, a deposit begins the application process.</p></div></div>
        <div class="note-box">
          üí° After your call, a deposit is required to begin your application. This will be discussed on the call. After your acceptance letter, the first year's tuition is paid, then your visa application begins.
        </div>
        <div style="margin-top:24px">
          <a href="https://wa.me/48579108304" target="_blank" class="btn-wa" style="display:flex;margin-bottom:8px"><i class="fab fa-whatsapp"></i> WhatsApp Consultant 1: +48 579 108 304</a>
          <a href="https://wa.me/48729285041" target="_blank" class="btn-wa" style="display:flex"><i class="fab fa-whatsapp"></i> WhatsApp Consultant 2: +48 729 285 041</a>
        </div>
      </div>
      <div>
        <div class="book-form-card">
          <div id="book-form-container">
            <h3 style="font-family:'Syne',sans-serif;font-size:20px;font-weight:700;margin-bottom:24px">Book Your Call</h3>
            <div class="form-group"><label class="form-label">Full Name *</label><input class="form-input" id="book-name" placeholder="Your full name"></div>
            <div class="form-group"><label class="form-label">Email Address *</label><input class="form-input" type="email" id="book-email" placeholder="you@example.com"></div>
            <div class="form-group"><label class="form-label">WhatsApp Number * <small style="font-weight:400;color:var(--text-muted)">(We'll confirm via WhatsApp)</small></label><input class="form-input" type="tel" id="book-whatsapp" placeholder="+27..."></div>
            <div class="form-group"><label class="form-label">Preferred Date *</label><input class="form-input" type="date" id="book-date"></div>
            <div class="form-group">
              <label class="form-label">Preferred Time *</label>
              <select class="form-select" id="book-time">
                <option value="">Select time slot...</option>
                <option value="morning">Morning ‚Äî 8:00‚Äì12:00 SA Time</option>
                <option value="afternoon">Afternoon ‚Äî 12:00‚Äì17:00 SA Time</option>
                <option value="evening">Evening ‚Äî 17:00‚Äì20:00 SA Time</option>
              </select>
            </div>
            <div class="form-group"><label class="form-label">Programs you're interested in</label><textarea class="search-textarea" id="book-programs" placeholder="e.g. Computer Science at VIZJA, Psychology at Lazarski..."></textarea></div>
            <div class="form-group"><label class="form-label">Any questions for the consultant?</label><textarea class="search-textarea" id="book-questions" placeholder="Ask anything..."></textarea></div>
            <div id="book-error" style="color:var(--red);font-size:13px;margin-bottom:12px;display:none"></div>
            <button class="btn-primary w-full" style="justify-content:center;font-size:16px;padding:16px" onclick="submitBooking()">Book My Call ‚Üí</button>
          </div>
          <div class="thank-you-state" id="book-thankyou">
            <div style="font-size:56px;margin-bottom:16px">üéâ</div>
            <h3 style="font-family:'Syne',sans-serif;font-size:24px;font-weight:700;margin-bottom:12px">Thank You!</h3>
            <p style="font-size:15px;color:var(--text-muted);line-height:1.7">We'll confirm your consultation slot via WhatsApp within 24 hours. Make sure to complete your profile beforehand for a better session!</p>
            <button class="btn-primary mt-24" onclick="navigate('#profile')">Complete My Profile ‚Üí</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- =================== PAGE: ADMIN =================== -->
<div id="page-admin" class="page">
  <div id="admin-login-section">
    <div class="admin-login">
      <div class="auth-card">
        <div class="auth-logo">
          <div class="auth-logo-name"><span style="color:var(--blue)">Afro</span><span style="color:var(--red)">Pol</span> Nexus</div>
          <div style="font-size:12px;color:var(--text-muted)">Admin Panel</div>
        </div>
        <h2>Admin Login</h2>
        <div class="auth-subtitle">Restricted access ‚Äî authorised personnel only.</div>
        <div class="form-group"><label class="form-label">Username</label><input class="form-input" id="admin-username" placeholder="admin" value="admin"></div>
        <div class="form-group"><label class="form-label">Password</label><input class="form-input" type="password" id="admin-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value="afropol2024"></div>
        <div id="admin-login-error" style="color:var(--red);font-size:13px;margin-bottom:12px;display:none">Invalid credentials.</div>
        <button class="btn-primary w-full" style="justify-content:center" onclick="doAdminLogin()">Login to Dashboard</button>
        <div class="auth-small mt-16">In Partnership with The Varsity Plug</div>
      </div>
    </div>
  </div>

  <div id="admin-dashboard-section" class="admin-dashboard">
    <div class="admin-header">
      <div class="container">
        <div class="admin-header-inner">
          <div>
            <div class="admin-title">üéì AfroPol Nexus ‚Äî Admin Panel</div>
            <div style="font-size:12px;color:rgba(255,255,255,0.6);margin-top:2px">In Partnership with The Varsity Plug</div>
          </div>
          <button class="admin-logout" onclick="adminLogout()">Logout</button>
        </div>
      </div>
    </div>
    <div class="admin-tabs">
      <button class="admin-tab-btn active" onclick="switchAdminTab('pipeline')">üìä Pipeline Overview</button>
      <button class="admin-tab-btn" onclick="switchAdminTab('students')">üë• All Students</button>
      <button class="admin-tab-btn" onclick="switchAdminTab('universities')">üéì Universities & Courses</button>
    </div>
    <div class="admin-content">
      <!-- Pipeline -->
      <div id="admin-tab-pipeline">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:24px">
          <div>
            <h2 style="font-family:'Syne',sans-serif;font-size:24px;font-weight:700">Pipeline Overview</h2>
            <div style="font-size:14px;color:var(--text-muted)" id="admin-total-count">Total students: 0</div>
          </div>
          <button class="btn-primary btn-sm" onclick="exportStudents()">Export CSV</button>
        </div>
        <div class="pipeline-grid" id="pipeline-grid"></div>
      </div>

      <!-- Students -->
      <div id="admin-tab-students" style="display:none">
        <h2 style="font-family:'Syne',sans-serif;font-size:24px;font-weight:700;margin-bottom:20px">All Students</h2>
        <div class="students-filters">
          <select class="filter-input" id="filter-stage" onchange="filterStudents()">
            <option value="">All Stages</option>
            <option>New Lead</option><option>Profile Ready</option><option>Call Booked</option>
            <option>Deposit Paid</option><option>Applied</option><option>Accepted</option>
            <option>Awaiting Tuition</option><option>Visa Stage</option><option>Completed</option>
          </select>
          <input class="filter-input" id="filter-name" placeholder="Search name / email..." oninput="filterStudents()">
          <input class="filter-input" id="filter-nationality" placeholder="Nationality..." oninput="filterStudents()">
        </div>
        <div style="overflow-x:auto">
          <table class="students-table">
            <thead>
              <tr>
                <th>Name</th><th>Email</th><th>WhatsApp</th><th>Nationality</th>
                <th>Profile %</th><th>Stage</th><th>Last Activity</th><th>Actions</th>
              </tr>
            </thead>
            <tbody id="students-tbody"></tbody>
          </table>
        </div>
        <div class="pagination" id="students-pagination"></div>
      </div>

      <!-- Universities -->
      <div id="admin-tab-universities" style="display:none">
        <h2 style="font-family:'Syne',sans-serif;font-size:24px;font-weight:700;margin-bottom:8px">Universities & Courses</h2>
        <div style="display:flex;gap:12px;margin-bottom:24px;flex-wrap:wrap">
          <select class="filter-input" id="uni-filter-city" onchange="filterUniAdmin()">
            <option value="">All Cities</option>
            <option>Warsaw</option><option>Krak√≥w</option><option>Rzesz√≥w</option>
          </select>
          <select class="filter-input" id="uni-filter-type" onchange="filterUniAdmin()">
            <option value="">All Types</option>
            <option>Private</option><option>Public</option>
          </select>
        </div>
        <div id="admin-uni-list"></div>
      </div>
    </div>
  </div>

  <!-- Student Detail Modal -->
  <div class="admin-modal-overlay" id="student-detail-modal">
    <div class="admin-modal">
      <div class="flex-between mb-24">
        <h3 style="font-family:'Syne',sans-serif;font-size:20px;font-weight:700">Student Details</h3>
        <button onclick="closeStudentModal()" style="background:none;border:none;font-size:24px;cursor:pointer;color:var(--text-muted)">√ó</button>
      </div>
      <div id="student-detail-content"></div>
    </div>
  </div>
</div>

<!-- =================== WHATSAPP FLOATING BUTTON =================== -->
<div id="wa-float">
  <button class="wa-btn" onclick="toggleWaPopup()" title="Chat on WhatsApp">
    <i class="fab fa-whatsapp"></i>
  </button>
  <div class="wa-popup" id="wa-popup">
    <div class="wa-popup-title">Chat with a Consultant</div>
    <a href="https://wa.me/48579108304" target="_blank" class="wa-option">
      <div class="wa-option-icon"><i class="fab fa-whatsapp"></i></div>
      <div><div class="wa-option-text">Consultant 1</div><div class="wa-option-num">+48 579 108 304</div></div>
    </a>
    <a href="https://wa.me/48729285041" target="_blank" class="wa-option">
      <div class="wa-option-icon"><i class="fab fa-whatsapp"></i></div>
      <div><div class="wa-option-text">Consultant 2</div><div class="wa-option-num">+48 729 285 041</div></div>
    </a>
  </div>
</div>

<!-- Toast Container -->
<div id="toast-container"></div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
// ===================== DATA =====================
const UNIVERSITIES = [
  {id:"vizja",name:"VIZJA University",shortName:"VIZJA",city:"Warsaw",type:"Private",website:"https://vizja.pl/en/",description:"Warsaw's most popular private university, ranked #1 for international student diversity. Modern Vizja Park campus in Warsaw's vibrant Wola district. Home to students from 130+ countries.",highlights:["130+ nationalities","Modern campus","Top-ranked private"],programs:[
    {name:"Psychology",level:"bachelor",fields:["Psychology"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Clinical Psychology",level:"master",fields:["Psychology"],language:"English",duration:"2 years",tuition:"‚Ç¨3,900/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Management",level:"bachelor",fields:["Business","Management"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Finance & Accounting",level:"bachelor",fields:["Finance & Accounting","Business"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"FinTech",level:"bachelor",fields:["Finance & Accounting","IT/Computer Science"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Computer Science / Informatics",level:"bachelor",fields:["IT/Computer Science"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Cybersecurity",level:"bachelor",fields:["IT/Computer Science"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"International Relations",level:"bachelor",fields:["International Relations"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Criminology & Forensic Science",level:"bachelor",fields:["Law"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Architecture",level:"bachelor",fields:["Architecture"],language:"Polish/English",duration:"3.5 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Fashion Design & Sustainable Fashion Management",level:"bachelor",fields:["Fashion Design","Business"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Social Media & Digital Marketing",level:"bachelor",fields:["Business","Media & Journalism"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Economics",level:"bachelor",fields:["Business","Finance & Accounting"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Logistics",level:"bachelor",fields:["Business"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"Cognitive Science & Artificial Intelligence",level:"bachelor",fields:["IT/Computer Science","Psychology"],language:"English",duration:"3 years",tuition:"‚Ç¨3,800/sem",startDate:"October",link:"https://vizja.pl/en/"},
    {name:"MBA",level:"mba",fields:["Business","Management"],language:"English",duration:"2 years",tuition:"‚Ç¨4,500/sem",startDate:"October",link:"https://vizja.pl/en/"}
  ]},
  {id:"vistula",name:"Vistula University",shortName:"Vistula",city:"Warsaw",type:"Private",website:"https://vistula.edu.pl/en",description:"One of Poland's oldest private universities (est. 1992), ranked 4th best private university in Poland. ACCA-accredited Finance program. Great location near Stok≈Çosy metro.",highlights:["ACCA-accredited Finance","Ranked Top 5 private","Est. 1992"],programs:[
    {name:"Economics",level:"bachelor",fields:["Business","Finance & Accounting"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://vistula.edu.pl/en"},
    {name:"Finance & Accounting ‚Äî ACCA Track",level:"bachelor",fields:["Finance & Accounting","Business"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://vistula.edu.pl/en"},
    {name:"Management",level:"bachelor",fields:["Business","Management"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://vistula.edu.pl/en"},
    {name:"International Relations & Public Affairs",level:"bachelor",fields:["International Relations"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://vistula.edu.pl/en"},
    {name:"Computer Science / Engineering",level:"bachelor",fields:["IT/Computer Science"],language:"English",duration:"3.5 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://vistula.edu.pl/en"},
    {name:"Tourism & Recreation",level:"bachelor",fields:["Tourism & Hospitality"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://vistula.edu.pl/en"},
    {name:"Sociology",level:"bachelor",fields:["Sociology"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://vistula.edu.pl/en"},
    {name:"Management",level:"master",fields:["Business","Management"],language:"English",duration:"2 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://vistula.edu.pl/en"},
    {name:"MBA",level:"mba",fields:["Business","Management"],language:"English",duration:"2 years",tuition:"‚Ç¨4,000/yr",startDate:"October",link:"https://vistula.edu.pl/en"}
  ]},
  {id:"uitm",name:"University of Information Technology & Management",shortName:"UITM Rzesz√≥w",city:"Rzesz√≥w",type:"Private",website:"https://wsiz.edu.pl/en/",description:"Dynamic private university in Rzesz√≥w, south-east Poland. Excellent value tuition, strong business and IT programs, close-knit international student community.",highlights:["Most affordable option","Strong IT faculty","Welcoming community"],programs:[
    {name:"Management & Marketing",level:"bachelor",fields:["Business","Management"],language:"English",duration:"3 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://wsiz.edu.pl/en/"},
    {name:"International Business",level:"bachelor",fields:["Business","International Relations"],language:"English",duration:"3 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://wsiz.edu.pl/en/"},
    {name:"Computer Science & IT",level:"bachelor",fields:["IT/Computer Science"],language:"English",duration:"3.5 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://wsiz.edu.pl/en/"},
    {name:"Finance & Accounting",level:"bachelor",fields:["Finance & Accounting","Business"],language:"English",duration:"3 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://wsiz.edu.pl/en/"},
    {name:"Tourism & Hospitality",level:"bachelor",fields:["Tourism & Hospitality"],language:"English",duration:"3 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://wsiz.edu.pl/en/"},
    {name:"Journalism & Media",level:"bachelor",fields:["Media & Journalism"],language:"English",duration:"3 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://wsiz.edu.pl/en/"},
    {name:"Management",level:"master",fields:["Business","Management"],language:"English",duration:"2 years",tuition:"‚Ç¨2,000/yr",startDate:"October/February",link:"https://wsiz.edu.pl/en/"}
  ]},
  {id:"wsb",name:"WSB University Merito",shortName:"WSB Merito",city:"Warsaw + 10 cities",type:"Private",website:"https://www.merito.pl/english/",description:"Poland's largest private university group with campuses in 11 cities. 250+ programs. National leader in internationalization. The most affordable private university option.",highlights:["11 campuses nationwide","From ‚Ç¨1,250/year","250+ programs"],programs:[
    {name:"Management ‚Äì International Business",level:"bachelor",fields:["Business","Management","International Relations"],language:"English",duration:"3 years",tuition:"‚Ç¨1,250/yr",startDate:"October",link:"https://www.merito.pl/english/"},
    {name:"Finance & Accounting ‚Äì Corporate Finance",level:"bachelor",fields:["Finance & Accounting","Business"],language:"English",duration:"3 years",tuition:"‚Ç¨1,250/yr",startDate:"October",link:"https://www.merito.pl/english/"},
    {name:"Business Psychology",level:"bachelor",fields:["Psychology","Business"],language:"English",duration:"3 years",tuition:"‚Ç¨1,250/yr",startDate:"October",link:"https://www.merito.pl/english/"},
    {name:"Logistics",level:"bachelor",fields:["Business"],language:"English",duration:"3 years",tuition:"‚Ç¨1,250/yr",startDate:"October",link:"https://www.merito.pl/english/"},
    {name:"International Trade",level:"bachelor",fields:["Business","International Relations"],language:"English",duration:"3 years",tuition:"‚Ç¨1,250/yr",startDate:"October",link:"https://www.merito.pl/english/"},
    {name:"Computer Science",level:"bachelor",fields:["IT/Computer Science"],language:"English",duration:"3.5 years",tuition:"‚Ç¨1,250/yr",startDate:"October",link:"https://www.merito.pl/english/"},
    {name:"Management ‚Äì Digital Marketing",level:"master",fields:["Business","Management","Media & Journalism"],language:"English",duration:"2 years",tuition:"‚Ç¨1,500/yr",startDate:"October",link:"https://www.merito.pl/english/"},
    {name:"IT Project Manager",level:"master",fields:["IT/Computer Science","Business"],language:"English",duration:"2 years",tuition:"‚Ç¨1,500/yr",startDate:"October",link:"https://www.merito.pl/english/"},
    {name:"MBA",level:"mba",fields:["Business","Management"],language:"English",duration:"2 years",tuition:"‚Ç¨3,500/yr",startDate:"October",link:"https://www.merito.pl/english/"}
  ]},
  {id:"lazarski",name:"Lazarski University",shortName:"Lazarski",city:"Warsaw",type:"Private",website:"https://www.lazarski.pl/en/",description:"One of Poland's most prestigious private universities. Law faculty ranked #1 non-public in Poland. Unique programs including Aviation Law, double-degree with Coventry University (UK), and Poland's only private Medicine program.",highlights:["Law #1 in Poland","Double degree with Coventry UK","Medicine & Aviation Law"],programs:[
    {name:"Law (LLB)",level:"bachelor",fields:["Law"],language:"English",duration:"3 years",tuition:"‚Ç¨3,000/yr",startDate:"October",link:"https://www.lazarski.pl/en/"},
    {name:"Economics & Management",level:"bachelor",fields:["Business","Finance & Accounting"],language:"English",duration:"3 years",tuition:"‚Ç¨3,000/yr",startDate:"October",link:"https://www.lazarski.pl/en/"},
    {name:"Finance & Accounting",level:"bachelor",fields:["Finance & Accounting","Business"],language:"English",duration:"3 years",tuition:"‚Ç¨3,000/yr",startDate:"October",link:"https://www.lazarski.pl/en/"},
    {name:"International Relations",level:"bachelor",fields:["International Relations"],language:"English",duration:"3 years",tuition:"‚Ç¨3,000/yr",startDate:"October",link:"https://www.lazarski.pl/en/"},
    {name:"Political Science",level:"bachelor",fields:["International Relations","Sociology"],language:"English",duration:"3 years",tuition:"‚Ç¨3,000/yr",startDate:"October",link:"https://www.lazarski.pl/en/"},
    {name:"Aviation Law & Professional Pilot Licence",level:"bachelor",fields:["Law","Aviation"],language:"English",duration:"3 years",tuition:"‚Ç¨5,000/yr",startDate:"October",link:"https://www.lazarski.pl/en/"},
    {name:"Medicine (Long-cycle 6yr)",level:"long-cycle",fields:["Medicine & Health"],language:"English",duration:"6 years",tuition:"‚Ç¨12,000/yr",startDate:"October",link:"https://www.lazarski.pl/en/"},
    {name:"Management",level:"master",fields:["Business","Management"],language:"English",duration:"2 years",tuition:"‚Ç¨3,000/yr",startDate:"October",link:"https://www.lazarski.pl/en/"},
    {name:"Law ‚Äî Double Degree with Coventry University UK",level:"master",fields:["Law"],language:"English",duration:"2 years",tuition:"‚Ç¨4,000/yr",startDate:"October",link:"https://www.lazarski.pl/en/"},
    {name:"MBA (CEEMAN Accredited)",level:"mba",fields:["Business","Management"],language:"English",duration:"2 years",tuition:"‚Ç¨5,000/yr",startDate:"October",link:"https://www.lazarski.pl/en/"}
  ]},
  {id:"jagiellonian",name:"Jagiellonian University",shortName:"Jagiellonian",city:"Krak√≥w",type:"Public",website:"https://en.uj.edu.pl/",description:"Poland's oldest and most prestigious university, founded in 1364. Located in UNESCO-listed Krak√≥w Old Town. One of Central Europe's top research universities with 40,000+ students.",highlights:["Founded 1364","UNESCO Krak√≥w campus","Top research university"],programs:[
    {name:"Medicine (Long-cycle 6yr)",level:"long-cycle",fields:["Medicine & Health"],language:"English",duration:"6 years",tuition:"‚Ç¨12,000/yr",startDate:"October",link:"https://en.uj.edu.pl/"},
    {name:"Psychology",level:"bachelor",fields:["Psychology"],language:"English",duration:"3 years",tuition:"‚Ç¨3,000/yr",startDate:"October",link:"https://en.uj.edu.pl/"},
    {name:"Political Science",level:"bachelor",fields:["International Relations","Sociology"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://en.uj.edu.pl/"},
    {name:"Economics",level:"bachelor",fields:["Business","Finance & Accounting"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://en.uj.edu.pl/"},
    {name:"Biochemistry / Biophysics",level:"bachelor",fields:["Medicine & Health","Agriculture & Life Sciences"],language:"English",duration:"3 years",tuition:"‚Ç¨3,000/yr",startDate:"October",link:"https://en.uj.edu.pl/"},
    {name:"International Security and Development",level:"master",fields:["International Relations"],language:"English",duration:"2 years",tuition:"‚Ç¨3,000/yr",startDate:"October",link:"https://en.uj.edu.pl/"},
    {name:"Molecular Biotechnology",level:"master",fields:["Agriculture & Life Sciences","Medicine & Health"],language:"English",duration:"2 years",tuition:"‚Ç¨3,500/yr",startDate:"October",link:"https://en.uj.edu.pl/"},
    {name:"Comparative Heritage Studies",level:"master",fields:["Sociology"],language:"English",duration:"2 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://en.uj.edu.pl/"}
  ]},
  {id:"civitas",name:"Civitas University",shortName:"Civitas",city:"Warsaw",type:"Private",website:"https://civitas.edu.pl/en/",description:"Unique university inside the iconic Palace of Culture & Science ‚Äî Warsaw's most famous building. Specializes in social sciences, international relations, and media. Students from 60+ countries.",highlights:["Palace of Culture & Science","60+ countries represented","First international private uni"],programs:[
    {name:"International Relations & Diplomacy",level:"bachelor",fields:["International Relations"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October/February",link:"https://civitas.edu.pl/en/"},
    {name:"Management & Marketing",level:"bachelor",fields:["Business","Management"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://civitas.edu.pl/en/"},
    {name:"Journalism & New Media",level:"bachelor",fields:["Media & Journalism"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://civitas.edu.pl/en/"},
    {name:"Sociology, Culture & Art",level:"bachelor",fields:["Sociology"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://civitas.edu.pl/en/"},
    {name:"Security & Information Analysis",level:"bachelor",fields:["International Relations","IT/Computer Science"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://civitas.edu.pl/en/"},
    {name:"International Relations",level:"master",fields:["International Relations"],language:"English",duration:"2 years",tuition:"‚Ç¨2,500/yr",startDate:"October/February",link:"https://civitas.edu.pl/en/"},
    {name:"Political Science",level:"master",fields:["International Relations","Sociology"],language:"English",duration:"2 years",tuition:"‚Ç¨2,500/yr",startDate:"October/February",link:"https://civitas.edu.pl/en/"}
  ]},
  {id:"sggw",name:"SGGW ‚Äì Warsaw University of Life Sciences",shortName:"SGGW",city:"Warsaw",type:"Public",website:"https://www.sggw.edu.pl/en/",description:"Poland's oldest agricultural and life sciences university (est. 1816). Public university with a massive 70-hectare campus in Ursyn√≥w, Warsaw. 200-year tradition of excellence.",highlights:["Public university ‚Äî est. 1816","70-hectare campus","Vet Medicine in English"],programs:[
    {name:"Environmental Management",level:"bachelor",fields:["Agriculture & Life Sciences"],language:"English",duration:"3.5 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://www.sggw.edu.pl/en/"},
    {name:"Animal Sciences",level:"bachelor",fields:["Agriculture & Life Sciences"],language:"English",duration:"3.5 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://www.sggw.edu.pl/en/"},
    {name:"Biotechnology",level:"bachelor",fields:["Agriculture & Life Sciences","Medicine & Health"],language:"English",duration:"3.5 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://www.sggw.edu.pl/en/"},
    {name:"Horticulture",level:"bachelor",fields:["Agriculture & Life Sciences"],language:"English",duration:"3.5 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://www.sggw.edu.pl/en/"},
    {name:"Nutrition & Dietetics",level:"bachelor",fields:["Medicine & Health","Agriculture & Life Sciences"],language:"English",duration:"3 years",tuition:"‚Ç¨2,500/yr",startDate:"October",link:"https://www.sggw.edu.pl/en/"},
    {name:"Computer Science",level:"bachelor",fields:["IT/Computer Science"],language:"English",duration:"3.5 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://www.sggw.edu.pl/en/"},
    {name:"Economics & Management",level:"bachelor",fields:["Business","Finance & Accounting"],language:"English",duration:"3 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://www.sggw.edu.pl/en/"},
    {name:"Veterinary Medicine (Long-cycle 5.5yr)",level:"long-cycle",fields:["Medicine & Health","Agriculture & Life Sciences"],language:"English",duration:"5.5 years",tuition:"‚Ç¨5,000/yr",startDate:"October",link:"https://www.sggw.edu.pl/en/"},
    {name:"Forestry",level:"master",fields:["Agriculture & Life Sciences"],language:"English",duration:"1.5 years",tuition:"‚Ç¨2,000/yr",startDate:"October",link:"https://www.sggw.edu.pl/en/"}
  ]}
];

const FIELD_OPTIONS = ["Business","Management","Finance & Accounting","IT/Computer Science","Law","International Relations","Psychology","Medicine & Health","Architecture","Fashion Design","Media & Journalism","Sociology","Tourism & Hospitality","Agriculture & Life Sciences","Aviation"];
const PIPELINE_STAGES = ["New Lead","Profile Ready","Call Booked","Deposit Paid","Applied","Accepted","Awaiting Tuition","Visa Stage","Completed"];
const APP_STAGES = ["Profile","Consultation","Deposit Paid","Applied","Accepted","Tuition Paid","Visa Application","üéì Complete"];
const STAGE_COLORS = {
  "New Lead":"#6B7280","Profile Ready":"#0038A8","Call Booked":"#7C3AED",
  "Deposit Paid":"#D97706","Applied":"#0891B2","Accepted":"#059669",
  "Awaiting Tuition":"#D97706","Visa Stage":"#DC2626","Completed":"#059669"
};

// ===================== STATE =====================
let selectedFields = [];
let selectedLevel = 'any';
let selectedCity = 'all';
let searchResults = [];
let compareList = [];
let currentPage = 1;
const perPage = 20;

// ===================== ROUTING =====================
function navigate(hash) {
  document.querySelectorAll('.page').forEach(p => {p.style.display='none';p.classList.remove('active')});
  const target = document.getElementById('page-' + hash.replace('#',''));
  if (target) {
    target.style.display = 'block';
    target.classList.add('active');
    target.classList.add('page-transition');
  }
  window.location.hash = hash;
  window.scrollTo(0,0);
  closeMobileMenu();
  
  if (hash === '#profile') loadProfile();
  if (hash === '#dashboard') loadDashboard();
  if (hash === '#admin') checkAdminSession();
  if (hash === '#search') initSearchPage();
  if (hash === '#home') initHomePage();
  if (hash === '#register') initRegisterPage();
  updateNavAuth();
}

function requireAuth() {
  if (!getCurrentUser()) { navigate('#login'); return false; }
  return true;
}

window.addEventListener('hashchange', () => {
  const h = window.location.hash || '#home';
  if (h === '#profile' || h === '#dashboard') {
    if (!requireAuth()) return;
  }
  navigate(h);
});

window.addEventListener('load', () => {
  const h = window.location.hash || '#home';
  navigate(h);
  initScrollObserver();
  initNavScroll();
  initHomePage();
});

// ===================== AUTH =====================
function getCurrentUser() { try { return JSON.parse(localStorage.getItem('afropol_current_user')); } catch(e) { return null; } }
function setCurrentUser(u) { localStorage.setItem('afropol_current_user', JSON.stringify(u)); }
function getUsers() { try { return JSON.parse(localStorage.getItem('afropol_users')) || []; } catch(e) { return []; } }
function saveUsers(u) { localStorage.setItem('afropol_users', JSON.stringify(u)); }

function updateNavAuth() {
  const u = getCurrentUser();
  const signinBtn = document.getElementById('nav-signin-btn');
  const mobileSignin = document.getElementById('mobile-signin');
  if (u) {
    if(signinBtn) signinBtn.textContent = u.name ? u.name.split(' ')[0] : 'Dashboard';
    if(signinBtn) signinBtn.onclick = () => navigate('#dashboard');
    if(mobileSignin) mobileSignin.textContent = 'üë§ My Dashboard';
    if(mobileSignin) mobileSignin.onclick = () => navigate('#dashboard');
  } else {
    if(signinBtn) { signinBtn.textContent = 'Sign In'; signinBtn.onclick = () => navigate('#login'); }
    if(mobileSignin) { mobileSignin.textContent = 'Sign In'; mobileSignin.onclick = () => navigate('#login'); }
  }
}

function doLogin() {
  const email = document.getElementById('login-email').value.trim();
  const pass = document.getElementById('login-password').value;
  const errEl = document.getElementById('login-error');
  const users = getUsers();
  const u = users.find(u => u.email.toLowerCase() === email.toLowerCase() && u.password === pass);
  if (!u) { errEl.style.display='block'; return; }
  errEl.style.display = 'none';
  setCurrentUser(u);
  showToast('Welcome back, ' + (u.name||'') + '! üëã', 'success');
  navigate('#dashboard');
}

function doRegister() {
  const errEl = document.getElementById('reg-error-3');
  const name = document.getElementById('reg-name').value.trim();
  const email = document.getElementById('reg-email').value.trim();
  const password = document.getElementById('reg-password').value;
  const phone = document.getElementById('reg-phone').value.trim();
  const whatsapp = document.getElementById('reg-whatsapp').value.trim();
  const nationality = document.getElementById('reg-nationality').value.trim();
  const country = document.getElementById('reg-country').value.trim();
  const dob = document.getElementById('reg-dob').value;
  const level = document.getElementById('reg-level').value;
  const source = document.getElementById('reg-source').value;
  const fields = [...selectedRegFields];
  
  const users = getUsers();
  if (users.find(u => u.email.toLowerCase() === email.toLowerCase())) {
    errEl.textContent = 'Email already registered. Please sign in.'; errEl.style.display='block'; return;
  }
  
  const u = {
    id: Date.now().toString(), name, email, password, phone, whatsapp, nationality, country, dob,
    level, source, fields, stage: 'New Lead', createdAt: new Date().toISOString(),
    lastActivity: new Date().toISOString(), profileData: {}, shortlist: [], notes: []
  };
  users.push(u);
  saveUsers(users);
  setCurrentUser(u);
  showToast('Account created! Welcome to AfroPol Nexus üéì', 'success');
  navigate('#dashboard');
}

// ===================== REGISTER MULTI-STEP =====================
let selectedRegFields = [];
function initRegisterPage() {
  const container = document.getElementById('reg-field-chips');
  if (!container) return;
  container.innerHTML = '';
  selectedRegFields = [];
  FIELD_OPTIONS.forEach(f => {
    const chip = document.createElement('div');
    chip.className = 'field-chip';
    chip.textContent = f;
    chip.onclick = () => {
      chip.classList.toggle('selected');
      if (chip.classList.contains('selected')) selectedRegFields.push(f);
      else selectedRegFields = selectedRegFields.filter(x => x !== f);
    };
    container.appendChild(chip);
  });
}

function regNextStep(from) {
  const errEl = document.getElementById('reg-error-' + from);
  if (from === 1) {
    const name = document.getElementById('reg-name').value.trim();
    const email = document.getElementById('reg-email').value.trim();
    const pass = document.getElementById('reg-password').value;
    const pass2 = document.getElementById('reg-password2').value;
    const nat = document.getElementById('reg-nationality').value.trim();
    const country = document.getElementById('reg-country').value.trim();
    if (!name||!email||!pass||!nat||!country) { errEl.textContent='Please fill all required fields.'; errEl.style.display='block'; return; }
    if (pass !== pass2) { errEl.textContent='Passwords do not match.'; errEl.style.display='block'; return; }
    if (pass.length < 6) { errEl.textContent='Password must be at least 6 characters.'; errEl.style.display='block'; return; }
  }
  if (from === 2) {
    const phone = document.getElementById('reg-phone').value.trim();
    const wa = document.getElementById('reg-whatsapp').value.trim();
    if (!phone||!wa) { errEl.textContent='Please fill all required fields.'; errEl.style.display='block'; return; }
  }
  errEl.style.display='none';
  document.getElementById('reg-step-'+from).classList.remove('active');
  document.getElementById('reg-step-'+(from+1)).classList.add('active');
  document.getElementById('rsp'+from).classList.remove('active'); document.getElementById('rsp'+from).classList.add('done');
  document.getElementById('rsp'+(from+1)).classList.add('active');
  const labels = ['Step 1 of 3 ‚Äî Personal Information','Step 2 of 3 ‚Äî Contact Details','Step 3 of 3 ‚Äî Preferences'];
  document.getElementById('reg-step-indicator').textContent = labels[from];
}

function regPrevStep(from) {
  document.getElementById('reg-step-'+from).classList.remove('active');
  document.getElementById('reg-step-'+(from-1)).classList.add('active');
  document.getElementById('rsp'+(from-1)).classList.remove('done'); document.getElementById('rsp'+(from-1)).classList.add('active');
  document.getElementById('rsp'+from).classList.remove('active');
  const labels = ['Step 1 of 3 ‚Äî Personal Information','Step 2 of 3 ‚Äî Contact Details','Step 3 of 3 ‚Äî Preferences'];
  document.getElementById('reg-step-indicator').textContent = labels[from-2];
}

// ===================== PROFILE =====================
function loadProfile() {
  if (!requireAuth()) return;
  const u = getCurrentUser();
  const displayName = document.getElementById('profile-display-name');
  const avatar = document.getElementById('profile-avatar-lg');
  if (displayName) displayName.textContent = u.name || 'My Profile';
  if (avatar) avatar.textContent = (u.name||'??').split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase();
  
  // Load saved profile data
  const pd = u.profileData || {};
  const setVal = (id, val) => { const el = document.getElementById(id); if(el) el.value = val || ''; };
  setVal('p-name', pd.name || u.name);
  setVal('p-dob', pd.dob || u.dob);
  setVal('p-nationality', pd.nationality || u.nationality);
  setVal('p-country', pd.country || u.country);
  setVal('p-phone', pd.phone || u.phone);
  setVal('p-whatsapp', pd.whatsapp || u.whatsapp);
  setVal('p-school', pd.school);
  setVal('p-school-country', pd.schoolCountry);
  setVal('p-year-from', pd.yearFrom);
  setVal('p-year-to', pd.yearTo);
  setVal('p-average', pd.average);
  setVal('p-english-score', pd.englishScore);
  setVal('p-other-langs', pd.otherLangs);
  setVal('p-pref-level', pd.prefLevel);
  setVal('p-budget', pd.budget);
  setVal('p-pref-city', pd.prefCity);
  setVal('p-start-date', pd.startDate);
  setVal('p-statement', pd.statement);
  if (pd.qualification) { const el = document.getElementById('p-qualification'); if(el) el.value = pd.qualification; }
  if (pd.english) { const el = document.getElementById('p-english'); if(el) { el.value = pd.english; toggleEnglishFields(); } }
  
  // Init pref field chips
  const prefContainer = document.getElementById('pref-field-chips');
  if (prefContainer) {
    prefContainer.innerHTML = '';
    const selectedPref = pd.prefFields || [];
    FIELD_OPTIONS.forEach(f => {
      const chip = document.createElement('div');
      chip.className = 'field-chip' + (selectedPref.includes(f) ? ' selected' : '');
      chip.textContent = f;
      chip.onclick = () => chip.classList.toggle('selected');
      prefContainer.appendChild(chip);
    });
  }
  
  // Doc slots
  initProfileDocSlots(pd.documents || {});
  updateCompletion();
}

const PROFILE_DOCS = ['ID / Passport','Matric Certificate / School Transcript','Other Qualifications','English Proficiency Certificate','Any Other Documents'];
function initProfileDocSlots(docs) {
  const el = document.getElementById('profile-doc-slots');
  if (!el) return;
  el.innerHTML = '';
  PROFILE_DOCS.forEach(name => {
    const uploaded = docs[name];
    const slot = document.createElement('div');
    slot.className = 'doc-slot' + (uploaded ? ' uploaded' : '');
    slot.innerHTML = `<div><div class="doc-slot-name">${name}</div><div class="doc-slot-status ${uploaded?'ok':''}">${uploaded ? '‚úì '+uploaded : 'No document uploaded'}</div></div>
      <label style="cursor:pointer"><input type="file" style="display:none" onchange="handleDocUpload(this,'${name}','profile-doc-slots')">
        <span class="btn-ghost-red btn-sm">${uploaded?'Replace':'Upload'}</span></label>`;
    el.appendChild(slot);
  });
}

function handleDocUpload(input, name, containerId) {
  if (!input.files.length) return;
  const fname = input.files[0].name;
  const u = getCurrentUser();
  const pd = u.profileData || {};
  if (!pd.documents) pd.documents = {};
  pd.documents[name] = fname;
  u.profileData = pd;
  updateUserInStorage(u);
  const container = containerId === 'profile-doc-slots' ? document.getElementById('profile-doc-slots') : null;
  if (container) initProfileDocSlots(pd.documents);
  updateCompletion();
  showToast('Document attached: ' + fname, 'success');
}

function updateUserInStorage(u) {
  const users = getUsers();
  const idx = users.findIndex(x => x.id === u.id);
  if (idx >= 0) users[idx] = u;
  saveUsers(users);
  setCurrentUser(u);
}

function saveProfile() {
  if (!requireAuth()) return;
  const u = getCurrentUser();
  const getVal = id => { const el = document.getElementById(id); return el ? el.value : ''; };
  const prefFields = [...document.querySelectorAll('#pref-field-chips .field-chip.selected')].map(c => c.textContent);
  u.name = getVal('p-name') || u.name;
  u.profileData = {
    name: getVal('p-name'), dob: getVal('p-dob'), nationality: getVal('p-nationality'),
    country: getVal('p-country'), phone: getVal('p-phone'), whatsapp: getVal('p-whatsapp'),
    school: getVal('p-school'), schoolCountry: getVal('p-school-country'),
    yearFrom: getVal('p-year-from'), yearTo: getVal('p-year-to'),
    qualification: getVal('p-qualification'), average: getVal('p-average'),
    english: getVal('p-english'), englishScore: getVal('p-english-score'),
    otherLangs: getVal('p-other-langs'), prefLevel: getVal('p-pref-level'),
    budget: getVal('p-budget'), prefCity: getVal('p-pref-city'),
    startDate: getVal('p-start-date'), statement: getVal('p-statement'),
    prefFields, documents: u.profileData?.documents || {}
  };
  u.lastActivity = new Date().toISOString();
  updateUserInStorage(u);
  updateCompletion();
  showToast('Profile saved! ‚úì', 'success');
}

function updateCompletion() {
  const u = getCurrentUser();
  if (!u) return;
  const pd = u.profileData || {};
  const fields = ['name','dob','nationality','country','phone','whatsapp','school','qualification','english','prefLevel','budget'];
  let filled = 0;
  fields.forEach(f => { if (pd[f]) filled++; });
  if ((pd.prefFields||[]).length > 0) filled++;
  if (Object.keys(pd.documents||{}).length > 0) filled++;
  const pct = Math.round((filled / (fields.length + 2)) * 100);
  const fill = document.getElementById('completion-fill');
  const label = document.getElementById('completion-pct-label');
  if (fill) fill.style.width = pct + '%';
  if (label) label.textContent = pct + '%';
  
  // Check if profile is ready to update stage
  if (pct >= 60 && u.stage === 'New Lead') {
    u.stage = 'Profile Ready';
    updateUserInStorage(u);
  }
}

function toggleEnglishFields() {
  const val = document.getElementById('p-english')?.value;
  const field = document.getElementById('english-score-field');
  const label = document.getElementById('english-score-label');
  if (!field) return;
  if (val === 'ielts') { field.style.display='block'; if(label) label.textContent='IELTS Score (e.g. 6.5)'; }
  else if (val === 'toefl') { field.style.display='block'; if(label) label.textContent='TOEFL Score'; }
  else field.style.display = 'none';
}

function addSubjectRow() {
  const tbody = document.getElementById('subjects-tbody');
  if (!tbody) return;
  const tr = document.createElement('tr');
  tr.innerHTML = '<td><input class="form-input" placeholder="Subject name" style="font-size:13px;padding:6px 10px"></td><td><input class="form-input" placeholder="Grade" style="font-size:13px;padding:6px 10px"></td>';
  tbody.appendChild(tr);
}

// ===================== DASHBOARD =====================
function loadDashboard() {
  if (!requireAuth()) return;
  const u = getCurrentUser();
  const welcome = document.getElementById('dash-welcome');
  if (welcome) welcome.textContent = 'Welcome back, ' + (u.name ? u.name.split(' ')[0] : '') + '! üëã';
  
  const stageBadge = document.getElementById('dash-stage-badge');
  if (stageBadge) {
    stageBadge.textContent = u.stage || 'New Lead';
    const color = STAGE_COLORS[u.stage] || '#6B7280';
    stageBadge.style.background = color + '22';
    stageBadge.style.color = color;
    stageBadge.style.border = '1px solid ' + color + '44';
  }
  
  // Shortlist
  renderShortlist();
  // App tracker
  renderAppTracker(u.stage || 'New Lead');
  // Doc slots
  renderAppDocSlots();
  // Visa docs
  renderVisaDocSlots();
  // Consultant notes
  renderConsultantNotes(u.notes || []);
}

function renderShortlist() {
  const u = getCurrentUser();
  const container = document.getElementById('shortlist-grid-container');
  if (!container) return;
  const shortlist = u.shortlist || [];
  if (shortlist.length === 0) {
    container.innerHTML = `<div class="empty-state"><i class="fas fa-bookmark"></i><h3>No saved programs yet</h3><p>Search for programs and save your favourites here.</p><button class="btn-primary mt-24" onclick="navigate('#search')">Find Programs ‚Üí</button></div>
    <div style="margin-top:24px"><button class="btn-secondary" onclick="navigate('#book-call')">üìû Book a Consultation Call ‚Üí</button></div>`;
    return;
  }
  container.innerHTML = `<div class="shortlist-grid">${shortlist.map(item => `
    <div class="shortlist-card">
      <button class="shortlist-remove" onclick="removeShortlist('${item.id}','${item.progName.replace(/'/g,"")}')">√ó</button>
      <div style="font-size:12px;font-weight:600;color:var(--blue)">${item.uniName}</div>
      <div style="font-family:'Syne',sans-serif;font-size:16px;font-weight:700;margin:6px 0">${item.progName}</div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px">
        <span class="badge badge-grey">${item.level}</span>
        <span class="badge badge-blue">${item.tuition}</span>
      </div>
      ${item.match ? `<span class="${matchClass(item.match)}">${item.match}% Match</span>` : ''}
    </div>`).join('')}</div>
    <div style="margin-top:24px"><button class="btn-primary" onclick="navigate('#book-call')">üìû Book a Consultation Call ‚Üí</button></div>`;
}

function removeShortlist(uniId, progName) {
  const u = getCurrentUser();
  u.shortlist = (u.shortlist||[]).filter(x => !(x.id === uniId && x.progName === progName));
  updateUserInStorage(u);
  renderShortlist();
  showToast('Removed from shortlist', 'info');
}

function renderAppTracker(currentStage) {
  const container = document.getElementById('app-stages-track');
  if (!container) return;
  const stageIdx = APP_STAGES.indexOf(currentStage);
  // Map pipeline stages to app stages
  const pipelineToApp = {
    'New Lead':0,'Profile Ready':0,'Call Booked':1,'Deposit Paid':2,
    'Applied':3,'Accepted':4,'Awaiting Tuition':5,'Visa Stage':6,'Completed':7
  };
  const currentAppIdx = pipelineToApp[currentStage] ?? 0;
  container.innerHTML = APP_STAGES.map((s,i) => {
    let cls = '';
    if (i < currentAppIdx) cls = 'completed';
    else if (i === currentAppIdx) cls = 'current';
    return `<div class="app-stage ${cls}">
      <div class="app-stage-circle">${i < currentAppIdx ? '‚úì' : i+1}</div>
      <div class="app-stage-label">${s}</div>
    </div>`;
  }).join('');
}

function renderConsultantNotes(notes) {
  const el = document.getElementById('dash-consultant-notes');
  if (!el) return;
  if (!notes || notes.length === 0) {
    el.innerHTML = '<span style="color:var(--text-muted);font-size:13px">No notes from your consultant yet. Check back after your consultation call.</span>';
    return;
  }
  el.innerHTML = notes.slice(-5).reverse().map(n => `<div class="notes-item"><div class="notes-timestamp">${new Date(n.ts).toLocaleString()}</div><div>${n.text}</div></div>`).join('');
}

const APP_DOCS = [
  {name:'Motivation Letter',key:'motiv'},{name:'CV / Curriculum Vitae',key:'cv'},
  {name:'Certified Transcripts',key:'trans'},{name:'Proof of Payment',key:'payment'},{name:'Other',key:'other_app'}
];
const VISA_DOCS = [
  {name:'Passport Copy',key:'passport'},{name:'Bank Statement',key:'bank'},
  {name:'Acceptance Letter',key:'accept'},{name:'Tuition Receipt',key:'tuition_receipt'},
  {name:'Visa Photo',key:'visa_photo'},{name:'Other',key:'other_visa'}
];

function renderAppDocSlots() {
  const u = getCurrentUser();
  const docs = (u.profileData||{}).appDocs || {};
  renderDocSlotsTo('app-doc-slots', APP_DOCS, docs, 'app');
}

function renderVisaDocSlots() {
  const u = getCurrentUser();
  const docs = (u.profileData||{}).visaDocs || {};
  renderDocSlotsTo('visa-doc-slots', VISA_DOCS, docs, 'visa');
}

function renderDocSlotsTo(containerId, docList, docs, type) {
  const el = document.getElementById(containerId);
  if (!el) return;
  el.innerHTML = docList.map(d => {
    const status = docs[d.key] || 'Pending';
    const statusClass = status === 'Approved' ? 'doc-status-approved' : status === 'Submitted' ? 'doc-status-submitted' : status === 'Action Required' ? 'doc-status-action' : 'doc-status-pending';
    return `<div class="doc-slot" style="margin-bottom:8px">
      <div><div class="doc-slot-name">${d.name}</div></div>
      <span class="badge ${statusClass}">${status}</span>
    </div>`;
  }).join('');
}

// ===================== SEARCH =====================
function initSearchPage() {
  // Field chips
  const container = document.getElementById('field-chips');
  if (!container) return;
  if (container.children.length > 0) return; // already initialized
  FIELD_OPTIONS.forEach(f => {
    const chip = document.createElement('div');
    chip.className = 'field-chip';
    chip.textContent = f;
    chip.onclick = () => {
      chip.classList.toggle('selected');
      if (chip.classList.contains('selected')) selectedFields.push(f);
      else selectedFields = selectedFields.filter(x => x !== f);
    };
    container.appendChild(chip);
  });
  
  // Level pills
  document.querySelectorAll('.level-pill').forEach(p => {
    p.onclick = () => {
      document.querySelectorAll('.level-pill').forEach(x => x.classList.remove('selected'));
      p.classList.add('selected');
      selectedLevel = p.dataset.val;
    };
  });
  
  // City pills
  document.querySelectorAll('.city-pill').forEach(p => {
    p.onclick = () => {
      document.querySelectorAll('.city-pill').forEach(x => x.classList.remove('selected'));
      p.classList.add('selected');
      selectedCity = p.dataset.val;
    };
  });
}

function calculateMatch(program, fields, level, city, uni) {
  if (fields.length === 0 && level === 'any') return 75;
  let score = 0;
  if (fields.length > 0) {
    const overlap = fields.filter(f => program.fields.includes(f)).length;
    score += (overlap / fields.length) * 65;
  } else { score += 50; }
  if (level === 'any' || program.level === level) score += 25;
  if (city === 'all' || uni.city.includes(city)) score += 10;
  return Math.min(100, Math.round(score));
}

function parseTuitionValue(tuition) {
  const match = tuition.match(/[\d,]+/);
  return match ? parseInt(match[0].replace(',','')) : 9999;
}

function matchClass(pct) {
  if (pct >= 80) return 'match-high';
  if (pct >= 60) return 'match-mid';
  return 'match-low';
}

function runSearch() {
  document.getElementById('search-results').style.display = 'none';
  document.getElementById('search-loading').style.display = 'block';
  compareList = [];
  updateCompareBar();
  
  setTimeout(() => {
    document.getElementById('search-loading').style.display = 'none';
    
    let results = [];
    UNIVERSITIES.forEach(uni => {
      uni.programs.forEach(prog => {
        const match = calculateMatch(prog, selectedFields, selectedLevel, selectedCity, uni);
        results.push({ uni, prog, match });
      });
    });
    
    results.sort((a,b) => b.match - a.match);
    searchResults = results;
    renderResults(results);
    document.getElementById('search-results').style.display = 'block';
    const sortEl = document.getElementById('sort-select');
    if (sortEl) sortEl.value = 'match';
  }, 1200);
}

function sortResults() {
  const val = document.getElementById('sort-select').value;
  let sorted = [...searchResults];
  if (val === 'tuition-low') sorted.sort((a,b) => parseTuitionValue(a.prog.tuition) - parseTuitionValue(b.prog.tuition));
  else if (val === 'alpha') sorted.sort((a,b) => a.prog.name.localeCompare(b.prog.name));
  else sorted.sort((a,b) => b.match - a.match);
  renderResults(sorted);
}

function renderResults(results) {
  const grid = document.getElementById('results-grid');
  const count = document.getElementById('results-count');
  const noRes = document.getElementById('no-results');
  
  count.textContent = `Found ${results.length} matching programs for you`;
  
  if (results.length === 0) {
    grid.innerHTML = '';
    noRes.style.display = 'block';
    return;
  }
  noRes.style.display = 'none';
  
  grid.innerHTML = results.map((r, idx) => {
    const isHighMatch = r.match >= 80;
    const langIcon = r.prog.language.includes('Polish') ? 'üáµüá±' : 'üá¨üáß';
    const levelLabel = {bachelor:"Bachelor's",master:"Master's",mba:"MBA","long-cycle":"Long-cycle"}[r.prog.level] || r.prog.level;
    const isComparing = compareList.find(c => c.uniId === r.uni.id && c.progName === r.prog.name);
    return `<div class="result-card ${isHighMatch?'high-match':''}" id="rc-${idx}">
      <div class="result-card-top">
        <div>
          <div class="result-uni">${r.uni.name} <span class="badge badge-blue" style="margin-left:8px">üáµüá± ${r.uni.city}</span></div>
        </div>
        <span class="${matchClass(r.match)}">${r.match}% Match</span>
      </div>
      <div class="result-program">${r.prog.name}</div>
      <div class="result-badges">
        <span class="badge badge-grey">${langIcon} ${r.prog.language}</span>
        <span class="badge badge-blue">${levelLabel}</span>
        <span class="badge badge-grey">‚è± ${r.prog.duration}</span>
        <span class="badge badge-grey">üìÖ ${r.prog.startDate}</span>
        <span class="${r.uni.type==='Public'?'badge badge-green':'badge badge-private'}">${r.uni.type}</span>
      </div>
      <div class="result-footer">
        <div class="result-tuition">${r.prog.tuition}</div>
        <div style="display:flex;align-items:center;gap:12px">
          <div class="compare-checkbox-wrap">
            <input type="checkbox" id="cmp-${idx}" ${isComparing?'checked':''} onchange="toggleCompare(this,${idx},'${r.uni.id}','${r.prog.name.replace(/'/g,"\\'")}','${r.uni.name}','${r.prog.level}','${r.prog.tuition}',${r.match})">
            <label for="cmp-${idx}" style="cursor:pointer">Compare</label>
          </div>
          <div class="result-actions">
            <button class="btn-secondary btn-sm" onclick="toggleDetails(${idx})">See Details</button>
            <button class="btn-ghost-red btn-sm" id="save-btn-${idx}" onclick="saveToShortlist('${r.uni.id}','${r.uni.name}','${r.prog.name.replace(/'/g,"\\'")}','${r.prog.level}','${r.prog.tuition}',${r.match},${idx})">
              ${isAlreadyShortlisted(r.uni.id,r.prog.name)?'‚ô• Saved':'‚ô° Save'}
            </button>
          </div>
        </div>
      </div>
      <div class="result-details" id="rd-${idx}">
        <p class="result-details-desc">${r.uni.description}</p>
        <div class="result-highlights">${r.uni.highlights.map(h=>`<span class="result-highlight">‚ú¶ ${h}</span>`).join('')}</div>
        <div style="font-size:13px;color:var(--text-muted);margin-bottom:16px">
          <strong>Entry Requirements:</strong> Minimum secondary school completion (Matric/NSC equivalent). English language proficiency required. No specific subject prerequisites unless noted.
        </div>
        <div class="details-actions">
          <button class="btn-primary btn-sm" onclick="navigate('#book-call')">Interested? Book a Consultation ‚Üí</button>
          <a href="${r.prog.link}" target="_blank" class="btn-secondary btn-sm">View University Website ‚Üí</a>
        </div>
      </div>
    </div>`;
  }).join('');
}

function toggleDetails(idx) {
  const el = document.getElementById('rd-' + idx);
  const btn = document.querySelector(`#rc-${idx} .btn-secondary.btn-sm`);
  if (!el) return;
  el.classList.toggle('open');
  if (btn) btn.textContent = el.classList.contains('open') ? 'Hide Details' : 'See Details';
}

function isAlreadyShortlisted(uniId, progName) {
  const u = getCurrentUser();
  if (!u) return false;
  return (u.shortlist||[]).some(x => x.id === uniId && x.progName === progName);
}

function saveToShortlist(uniId, uniName, progName, level, tuition, match, idx) {
  if (!getCurrentUser()) { navigate('#login'); return; }
  const u = getCurrentUser();
  if (!u.shortlist) u.shortlist = [];
  const exists = u.shortlist.find(x => x.id === uniId && x.progName === progName);
  if (exists) {
    u.shortlist = u.shortlist.filter(x => !(x.id === uniId && x.progName === progName));
    const btn = document.getElementById('save-btn-' + idx);
    if (btn) btn.innerHTML = '‚ô° Save';
    showToast('Removed from shortlist', 'info');
  } else {
    u.shortlist.push({id:uniId, uniName, progName, level, tuition, match});
    const btn = document.getElementById('save-btn-' + idx);
    if (btn) btn.innerHTML = '‚ô• Saved';
    showToast('Saved to shortlist ‚úì', 'success');
  }
  updateUserInStorage(u);
}

function clearSearch() {
  selectedFields = [];
  selectedLevel = 'any';
  selectedCity = 'all';
  document.querySelectorAll('.field-chip').forEach(c => c.classList.remove('selected'));
  document.querySelectorAll('.level-pill').forEach(p => p.classList.remove('selected'));
  document.querySelectorAll('.city-pill').forEach(p => p.classList.remove('selected'));
  document.querySelector('.level-pill[data-val="any"]')?.classList.add('selected');
  document.querySelector('.city-pill[data-val="all"]')?.classList.add('selected');
  document.getElementById('search-results').style.display = 'none';
}

// ===================== COMPARE =====================
function toggleCompare(checkbox, idx, uniId, progName, uniName, level, tuition, match) {
  if (checkbox.checked) {
    if (compareList.length >= 3) { checkbox.checked=false; showToast('You can compare up to 3 programs', 'info'); return; }
    compareList.push({uniId,progName,uniName,level,tuition,match,idx});
  } else {
    compareList = compareList.filter(c => !(c.uniId===uniId && c.progName===progName));
  }
  updateCompareBar();
}

function updateCompareBar() {
  const bar = document.getElementById('compare-bar');
  const countEl = document.getElementById('compare-count');
  if (compareList.length >= 2) {
    bar.classList.add('show');
    if (countEl) countEl.textContent = compareList.length + ' programs';
  } else {
    bar.classList.remove('show');
  }
}

function clearCompare() {
  compareList = [];
  document.querySelectorAll('.compare-checkbox-wrap input').forEach(c => c.checked=false);
  updateCompareBar();
}

function openCompareModal() {
  const container = document.getElementById('compare-table-container');
  const rows = [
    ['University', ...compareList.map(c=>c.uniName)],
    ['Program', ...compareList.map(c=>c.progName)],
    ['Level', ...compareList.map(c=>c.level)],
    ['Tuition', ...compareList.map(c=>c.tuition)],
    ['Match', ...compareList.map(c=>`<span class="${matchClass(c.match)}">${c.match}%</span>`)]
  ];
  container.innerHTML = `<table class="compare-table"><thead><tr><th>Criteria</th>${compareList.map((_,i)=>`<th>Option ${i+1}</th>`).join('')}</tr></thead>
    <tbody>${rows.map(r=>`<tr>${r.map((cell,i)=>`<${i===0?'th':'td'}>${cell}</${i===0?'th':'td'}>`).join('')}</tr>`).join('')}</tbody></table>`;
  document.getElementById('compare-modal').classList.add('open');
}

function closeCompareModal() { document.getElementById('compare-modal').classList.remove('open'); }

// ===================== BOOKING =====================
function submitBooking() {
  const name = document.getElementById('book-name').value.trim();
  const email = document.getElementById('book-email').value.trim();
  const whatsapp = document.getElementById('book-whatsapp').value.trim();
  const date = document.getElementById('book-date').value;
  const time = document.getElementById('book-time').value;
  const errEl = document.getElementById('book-error');
  
  if (!name||!email||!whatsapp||!date||!time) {
    errEl.textContent = 'Please fill all required fields.'; errEl.style.display='block'; return;
  }
  errEl.style.display = 'none';
  
  const booking = {
    name, email, whatsapp, date, time,
    programs: document.getElementById('book-programs').value,
    questions: document.getElementById('book-questions').value,
    createdAt: new Date().toISOString()
  };
  
  const bookings = JSON.parse(localStorage.getItem('afropol_bookings')||'[]');
  bookings.push(booking);
  localStorage.setItem('afropol_bookings', JSON.stringify(bookings));
  
  // If logged in, update stage
  const u = getCurrentUser();
  if (u && u.stage === 'New Lead' || u?.stage === 'Profile Ready') {
    u.stage = 'Call Booked';
    updateUserInStorage(u);
  }
  
  document.getElementById('book-form-container').style.display = 'none';
  document.getElementById('book-thankyou').classList.add('show');
  showToast('Booking submitted ‚úì', 'success');
}

// ===================== ADMIN =====================
let adminLoggedIn = false;
let studentsCurrentPage = 1;
let filteredStudents = [];

function checkAdminSession() {
  const isAdmin = sessionStorage.getItem('afropol_admin');
  if (isAdmin) {
    showAdminDashboard();
  }
}

function doAdminLogin() {
  const u = document.getElementById('admin-username').value;
  const p = document.getElementById('admin-password').value;
  const errEl = document.getElementById('admin-login-error');
  if (u === 'admin' && p === 'afropol2024') {
    errEl.style.display = 'none';
    sessionStorage.setItem('afropol_admin', '1');
    showAdminDashboard();
  } else {
    errEl.style.display = 'block';
  }
}

function showAdminDashboard() {
  document.getElementById('admin-login-section').style.display = 'none';
  document.getElementById('admin-dashboard-section').style.display = 'block';
  adminLoggedIn = true;
  loadAdminData();
}

function adminLogout() {
  sessionStorage.removeItem('afropol_admin');
  adminLoggedIn = false;
  document.getElementById('admin-login-section').style.display = 'block';
  document.getElementById('admin-dashboard-section').style.display = 'none';
}

function loadAdminData() {
  renderPipeline();
  renderStudentsTable();
  renderAdminUnis();
}

function renderPipeline() {
  const users = getUsers();
  const total = document.getElementById('admin-total-count');
  if (total) total.textContent = `Total students: ${users.length}`;
  
  const grid = document.getElementById('pipeline-grid');
  if (!grid) return;
  grid.innerHTML = PIPELINE_STAGES.map(stage => {
    const count = users.filter(u => u.stage === stage).length;
    const color = STAGE_COLORS[stage] || '#6B7280';
    return `<div class="pipeline-card">
      <div class="pipeline-num">${count}</div>
      <div class="pipeline-stage"><span class="pipeline-dot" style="background:${color}"></span>${stage}</div>
    </div>`;
  }).join('');
}

function renderStudentsTable() {
  const users = getUsers();
  const stageF = document.getElementById('filter-stage')?.value || '';
  const nameF = (document.getElementById('filter-name')?.value||'').toLowerCase();
  const natF = (document.getElementById('filter-nationality')?.value||'').toLowerCase();
  
  filteredStudents = users.filter(u => {
    if (stageF && u.stage !== stageF) return false;
    if (nameF && !(u.name?.toLowerCase().includes(nameF)||u.email?.toLowerCase().includes(nameF))) return false;
    if (natF && !u.nationality?.toLowerCase().includes(natF)) return false;
    return true;
  });
  
  const start = (studentsCurrentPage-1)*perPage;
  const pageStudents = filteredStudents.slice(start, start+perPage);
  const tbody = document.getElementById('students-tbody');
  if (!tbody) return;
  
  if (filteredStudents.length === 0) {
    tbody.innerHTML = '<tr><td colspan="8" style="text-align:center;color:var(--text-muted);padding:32px">No students found.</td></tr>';
    document.getElementById('students-pagination').innerHTML = '';
    return;
  }
  
  tbody.innerHTML = pageStudents.map((u,i) => {
    const pd = u.profileData||{};
    const pct = calcProfilePct(u);
    const color = STAGE_COLORS[u.stage]||'#6B7280';
    return `<tr onclick="openStudentModal('${u.id}')">
      <td><strong>${u.name||'‚Äî'}</strong></td>
      <td>${u.email||'‚Äî'}</td>
      <td>${u.whatsapp||u.phone||'‚Äî'}</td>
      <td>${u.nationality||'‚Äî'}</td>
      <td><div style="width:60px;height:6px;background:#E8ECF4;border-radius:3px;overflow:hidden"><div style="height:100%;background:var(--red);width:${pct}%"></div></div><span style="font-size:11px;margin-left:6px">${pct}%</span></td>
      <td><span style="padding:3px 8px;border-radius:12px;font-size:11px;font-weight:700;background:${color}22;color:${color}">${u.stage||'New Lead'}</span></td>
      <td style="font-size:11px;color:var(--text-muted)">${u.lastActivity ? new Date(u.lastActivity).toLocaleDateString() : '‚Äî'}</td>
      <td onclick="event.stopPropagation()">
        <div style="display:flex;gap:4px">
          <a href="https://wa.me/${(u.whatsapp||u.phone||'').replace(/[^0-9]/g,'')}" target="_blank" class="action-btn" title="WhatsApp">üí¨</a>
          <a href="mailto:${u.email}" class="action-btn" title="Email">üìß</a>
          <button class="action-btn" onclick="openStudentModal('${u.id}')" title="View">üìù</button>
        </div>
      </td>
    </tr>`;
  }).join('');
  
  renderPagination(filteredStudents.length);
}

function calcProfilePct(u) {
  const pd = u.profileData||{};
  const fields = ['name','dob','nationality','country','phone','whatsapp','school','qualification','english','prefLevel','budget'];
  let filled = 0;
  fields.forEach(f => { if(pd[f]) filled++; });
  if ((pd.prefFields||[]).length>0) filled++;
  if (Object.keys(pd.documents||{}).length>0) filled++;
  return Math.round((filled/(fields.length+2))*100);
}

function renderPagination(total) {
  const pages = Math.ceil(total/perPage);
  const el = document.getElementById('students-pagination');
  if (!el || pages<=1) { if(el) el.innerHTML=''; return; }
  el.innerHTML = Array.from({length:pages},(_,i)=>`<button class="page-btn ${studentsCurrentPage===i+1?'active':''}" onclick="goToStudentPage(${i+1})">${i+1}</button>`).join('');
}

function goToStudentPage(page) { studentsCurrentPage = page; renderStudentsTable(); }
function filterStudents() { studentsCurrentPage = 1; renderStudentsTable(); }

function openStudentModal(userId) {
  const users = getUsers();
  const u = users.find(x => x.id === userId);
  if (!u) return;
  
  const pd = u.profileData||{};
  const color = STAGE_COLORS[u.stage]||'#6B7280';
  
  document.getElementById('student-detail-content').innerHTML = `
    <div style="display:flex;gap:16px;margin-bottom:24px;align-items:center">
      <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--blue),var(--red));display:flex;align-items:center;justify-content:center;color:#fff;font-family:'Syne',sans-serif;font-weight:800;font-size:18px">${(u.name||'??').split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase()}</div>
      <div>
        <div style="font-family:'Syne',sans-serif;font-size:18px;font-weight:700">${u.name||'‚Äî'}</div>
        <div style="font-size:13px;color:var(--text-muted)">${u.email} ¬∑ ${u.nationality||'‚Äî'}</div>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:24px;font-size:13px">
      <div><strong>WhatsApp:</strong> ${u.whatsapp||u.phone||'‚Äî'}</div>
      <div><strong>Country:</strong> ${u.country||'‚Äî'}</div>
      <div><strong>Joined:</strong> ${new Date(u.createdAt||Date.now()).toLocaleDateString()}</div>
      <div><strong>Profile:</strong> ${calcProfilePct(u)}% complete</div>
      ${pd.qualification?`<div><strong>Qualification:</strong> ${pd.qualification}</div>`:''}
      ${pd.school?`<div><strong>School:</strong> ${pd.school}</div>`:''}
      ${pd.average?`<div><strong>Average:</strong> ${pd.average}</div>`:''}
      ${pd.budget?`<div><strong>Budget:</strong> ${pd.budget}</div>`:''}
    </div>
    
    <div style="margin-bottom:20px">
      <label class="form-label">Application Stage</label>
      <select class="form-select" id="admin-stage-select" onchange="updateStudentStage('${u.id}',this.value)">
        ${PIPELINE_STAGES.map(s=>`<option value="${s}" ${u.stage===s?'selected':''}>${s}</option>`).join('')}
      </select>
    </div>
    
    <div style="margin-bottom:20px">
      <label class="form-label">Consultant Notes</label>
      <textarea class="search-textarea" id="admin-note-text" placeholder="Type a note..." style="margin-bottom:8px;min-height:80px"></textarea>
      <button class="btn-primary btn-sm" onclick="saveAdminNote('${u.id}')">Save Note</button>
    </div>
    
    <div id="admin-notes-history">
      ${(u.notes||[]).slice(-5).reverse().map(n=>`<div class="notes-item"><div class="notes-timestamp">${new Date(n.ts).toLocaleString()}</div><div>${n.text}</div></div>`).join('') || '<div style="font-size:13px;color:var(--text-muted)">No notes yet.</div>'}
    </div>
    
    <div style="display:flex;gap:8px;margin-top:20px;flex-wrap:wrap">
      <a href="https://wa.me/${(u.whatsapp||u.phone||'').replace(/[^0-9]/g,'')}" target="_blank" class="btn-wa btn-sm">üí¨ WhatsApp</a>
      <a href="mailto:${u.email}" class="btn-secondary btn-sm">üìß Email</a>
      <button class="btn-ghost-red btn-sm" onclick="copyStudentInfo('${u.id}')">üìã Copy Info</button>
    </div>`;
  
  document.getElementById('student-detail-modal').classList.add('open');
}

function closeStudentModal() { document.getElementById('student-detail-modal').classList.remove('open'); }

function updateStudentStage(userId, stage) {
  const users = getUsers();
  const idx = users.findIndex(u => u.id === userId);
  if (idx>=0) { users[idx].stage = stage; users[idx].lastActivity = new Date().toISOString(); saveUsers(users); }
  renderPipeline();
  renderStudentsTable();
  showToast('Stage updated: ' + stage, 'success');
  // Update logged in user if same
  const cu = getCurrentUser();
  if (cu && cu.id === userId) { cu.stage = stage; setCurrentUser(cu); }
}

function saveAdminNote(userId) {
  const text = document.getElementById('admin-note-text').value.trim();
  if (!text) return;
  const users = getUsers();
  const idx = users.findIndex(u => u.id === userId);
  if (idx>=0) {
    if (!users[idx].notes) users[idx].notes = [];
    users[idx].notes.push({text, ts: new Date().toISOString()});
    users[idx].lastActivity = new Date().toISOString();
    saveUsers(users);
    // Update if current user
    const cu = getCurrentUser();
    if (cu && cu.id === userId) { cu.notes = users[idx].notes; setCurrentUser(cu); }
    
    document.getElementById('admin-note-text').value = '';
    const histEl = document.getElementById('admin-notes-history');
    if (histEl) histEl.innerHTML = users[idx].notes.slice(-5).reverse().map(n=>`<div class="notes-item"><div class="notes-timestamp">${new Date(n.ts).toLocaleString()}</div><div>${n.text}</div></div>`).join('');
    showToast('Note saved ‚úì', 'success');
  }
}

function copyStudentInfo(userId) {
  const users = getUsers();
  const u = users.find(x => x.id === userId);
  if (!u) return;
  const text = `Name: ${u.name}\nEmail: ${u.email}\nWhatsApp: ${u.whatsapp||u.phone}\nNationality: ${u.nationality}\nStage: ${u.stage}`;
  navigator.clipboard.writeText(text).then(() => showToast('Student info copied ‚úì', 'success'));
}

function exportStudents() {
  const users = getUsers();
  const headers = ['Name','Email','WhatsApp','Nationality','Country','Stage','Profile%','Joined'];
  const rows = users.map(u => [u.name,u.email,u.whatsapp||u.phone,u.nationality,u.country,u.stage,calcProfilePct(u)+'%',new Date(u.createdAt||'').toLocaleDateString()]);
  const csv = [headers.join(','),...rows.map(r=>r.map(v=>`"${v||''}"`).join(','))].join('\n');
  const blob = new Blob([csv], {type:'text/csv'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'afropol_students.csv';
  a.click();
}

function switchAdminTab(tab) {
  document.getElementById('admin-tab-pipeline').style.display = 'none';
  document.getElementById('admin-tab-students').style.display = 'none';
  document.getElementById('admin-tab-universities').style.display = 'none';
  document.getElementById('admin-tab-'+tab).style.display = 'block';
  document.querySelectorAll('.admin-tab-btn').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.admin-tab-btn').forEach(b=>{ if(b.textContent.toLowerCase().includes(tab==='pipeline'?'pipeline':tab==='students'?'student':'univer')) b.classList.add('active'); });
}

function renderAdminUnis() {
  const el = document.getElementById('admin-uni-list');
  if (!el) return;
  const cityF = document.getElementById('uni-filter-city')?.value || '';
  const typeF = document.getElementById('uni-filter-type')?.value || '';
  const unis = UNIVERSITIES.filter(u => {
    if (cityF && !u.city.includes(cityF)) return false;
    if (typeF && u.type !== typeF) return false;
    return true;
  });
  const users = getUsers();
  el.innerHTML = unis.map(u => {
    const interestedCount = users.filter(student => (student.fields||[]).some(f => u.programs.some(p => p.fields.includes(f)))).length;
    return `<div class="uni-admin-row">
      <div class="uni-admin-header" onclick="toggleUniAdmin('${u.id}')">
        <div style="display:flex;align-items:center;gap:12px">
          <div style="width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,var(--blue),var(--red));display:flex;align-items:center;justify-content:center;color:#fff;font-family:'Syne',sans-serif;font-weight:800;font-size:14px">${u.shortName.substring(0,2)}</div>
          <div>
            <div style="font-family:'Syne',sans-serif;font-weight:700">${u.name}</div>
            <div style="font-size:12px;color:var(--text-muted)">${u.city} ¬∑ ${u.type} ¬∑ ${u.programs.length} programs</div>
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:12px">
          <span class="badge badge-blue">${interestedCount} interested</span>
          <i class="fas fa-chevron-down" style="color:var(--text-muted);font-size:12px"></i>
        </div>
      </div>
      <div class="uni-admin-programs" id="uni-progs-${u.id}">
        ${u.programs.map(p=>`<div class="uni-admin-prog">
          <div><strong>${p.name}</strong> <span class="badge badge-grey" style="font-size:11px">${p.level}</span></div>
          <div style="font-size:12px;color:var(--text-muted)">${p.tuition} ¬∑ ${p.duration} ¬∑ ${p.language}</div>
        </div>`).join('')}
      </div>
    </div>`;
  }).join('');
}

function toggleUniAdmin(id) {
  const el = document.getElementById('uni-progs-' + id);
  if (el) el.classList.toggle('open');
}

function filterUniAdmin() { renderAdminUnis(); }

// ===================== HOME PAGE =====================
function initHomePage() {
  // University preview cards
  const grid = document.getElementById('uni-preview-grid');
  if (grid && grid.children.length === 0) {
    const colors = ['#E8000D','#0038A8','#059669','#7C3AED','#D97706','#0891B2','#DC2626','#6B7280'];
    UNIVERSITIES.slice(0,4).forEach((u,i) => {
      const card = document.createElement('div');
      card.className = 'uni-card fade-in';
      card.onclick = () => navigate('#search');
      card.innerHTML = `<div class="uni-card-header">
        <div class="uni-initial" style="background:linear-gradient(135deg,${colors[i]},${colors[(i+1)%colors.length]})">${u.shortName.substring(0,2).toUpperCase()}</div>
        <span class="badge ${u.type==='Public'?'badge-green':'badge-private'}">${u.type}</span>
      </div>
      <div class="uni-card-name">${u.name}</div>
      <div class="uni-card-city">üáµüá± ${u.city}</div>
      <div class="uni-card-footer">
        <span class="uni-programs-count">${u.programs.length} programs</span>
        <span class="badge badge-blue">English</span>
      </div>`;
      grid.appendChild(card);
    });
  }
  
  // Show all 8 universities link
  setTimeout(() => { initScrollObserver(); }, 100);
}

// ===================== TABS =====================
function switchTab(group, tab) {
  const prefix = group === 'profile' ? 'profile-tab-' : 'dash-tab-';
  document.querySelectorAll(`[id^="${prefix}"]`).forEach(el => el.classList.remove('active'));
  const target = document.getElementById(prefix + tab);
  if (target) target.classList.add('active');
  
  const btns = (group === 'profile') 
    ? document.querySelectorAll('#page-profile .tab-btn')
    : document.querySelectorAll('#page-dashboard .tab-btn');
  btns.forEach(b => {
    b.classList.remove('active');
    if (b.textContent.toLowerCase().includes(tab.replace('-','').toLowerCase()) || 
        (tab==='personal'&&b.textContent.includes('Personal')) ||
        (tab==='education'&&b.textContent.includes('Education')) ||
        (tab==='language'&&b.textContent.includes('Language')) ||
        (tab==='documents'&&b.textContent.includes('Documents')) ||
        (tab==='preferences'&&b.textContent.includes('Preferences')) ||
        (tab==='shortlist'&&b.textContent.includes('Shortlist')) ||
        (tab==='application'&&b.textContent.includes('Application')) ||
        (tab==='visa'&&b.textContent.includes('Visa')) ||
        (tab==='contact'&&b.textContent.includes('Contact'))) {
      b.classList.add('active');
    }
  });
}

// ===================== WHATSAPP =====================
function toggleWaPopup() {
  document.getElementById('wa-popup').classList.toggle('open');
}
document.addEventListener('click', e => {
  const waFloat = document.getElementById('wa-float');
  if (waFloat && !waFloat.contains(e.target)) {
    document.getElementById('wa-popup').classList.remove('open');
  }
});

// ===================== MOBILE MENU =====================
function toggleMobileMenu() { document.getElementById('mobile-menu').classList.toggle('open'); }
function closeMobileMenu() { document.getElementById('mobile-menu').classList.remove('open'); }

// ===================== SCROLL OBSERVER =====================
function initScrollObserver() {
  const observer = new IntersectionObserver(entries => {
    entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
  }, { threshold: 0.1 });
  document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));
}

function initNavScroll() {
  window.addEventListener('scroll', () => {
    const nav = document.getElementById('navbar');
    if (nav) { if (window.scrollY > 20) nav.classList.add('scrolled'); else nav.classList.remove('scrolled'); }
  });
}

// ===================== TOASTS =====================
function showToast(msg, type='success') {
  const container = document.getElementById('toast-container');
  const toast = document.createElement('div');
  toast.className = 'toast ' + type;
  toast.textContent = msg;
  container.appendChild(toast);
  setTimeout(() => { toast.style.opacity='0'; toast.style.transform='translateY(10px)'; toast.style.transition='all 0.3s'; setTimeout(()=>toast.remove(),300); }, 3000);
}

// ===================== MISC HELPERS =====================
// ===================== TYPING ANIMATION =====================
const typedWords = ['Poland', 'Warsaw', 'Europe', 'Your Future'];
let typedIdx = 0, typedCharIdx = 0, typedDeleting = false;
function typeEffect() {
  const el = document.getElementById('typed-word');
  if (!el) return;
  const word = typedWords[typedIdx];
  if (!typedDeleting) {
    el.textContent = word.substring(0, typedCharIdx + 1);
    typedCharIdx++;
    if (typedCharIdx === word.length) { typedDeleting = true; setTimeout(typeEffect, 1800); return; }
  } else {
    el.textContent = word.substring(0, typedCharIdx - 1);
    typedCharIdx--;
    if (typedCharIdx === 0) { typedDeleting = false; typedIdx = (typedIdx + 1) % typedWords.length; setTimeout(typeEffect, 400); return; }
  }
  setTimeout(typeEffect, typedDeleting ? 60 : 90);
}
setTimeout(typeEffect, 2000);

// ===================== HERO QUICK SEARCH =====================
function heroQuickSearch() {
  const field = document.getElementById('hero-field-select')?.value;
  const level = document.getElementById('hero-level-select')?.value;
  const city = document.getElementById('hero-city-select')?.value;
  
  // Pre-populate search page
  navigate('#search');
  setTimeout(() => {
    if (field) {
      selectedFields = [field];
      document.querySelectorAll('#field-chips .field-chip').forEach(c => {
        c.classList.toggle('selected', c.textContent === field);
      });
    }
    if (level) {
      selectedLevel = level;
      document.querySelectorAll('.level-pill').forEach(p => {
        p.classList.toggle('selected', p.dataset.val === level);
      });
    }
    if (city) {
      selectedCity = city;
      document.querySelectorAll('.city-pill').forEach(p => {
        p.classList.toggle('selected', p.dataset.val === city);
      });
    }
    if (field || level || city) runSearch();
  }, 150);
}

function quickTag(field) {
  document.getElementById('hero-field-select').value = field;
  heroQuickSearch();
}

// ===================== COUNTER ANIMATION =====================
function animateCounter(el, target, suffix) {
  let current = 0;
  const step = Math.ceil(target / 40);
  const timer = setInterval(() => {
    current = Math.min(current + step, target);
    el.textContent = current + (suffix || '');
    if (current >= target) clearInterval(timer);
  }, 40);
}

// Trigger counter when stats bar is visible
const statsObserver = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if (e.isIntersecting) {
      const uniEl = document.getElementById('stat-unis');
      const progEl = document.getElementById('stat-programs');
      if (uniEl && uniEl.textContent === '23') animateCounter(uniEl, 23, '');
      if (progEl && progEl.textContent === '150+') { progEl.textContent = '0+'; animateCounter(progEl, 150, '+'); }
      statsObserver.disconnect();
    }
  });
}, {threshold: 0.3});

setTimeout(() => {
  const statsBar = document.querySelector('.stats-bar');
  if (  if (statsBar) statsObserver.observe(statsBar);
}, 500);

// ===================== VAPI AI VOICE AGENT =====================
(function() {

  // ---- STYLES ----
  const style = document.createElement('style');
  style.textContent = `
    /* Floating AI Call Button */
    #ai-agent-fab {
      position: fixed;
      bottom: 32px;
      right: 32px;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 12px;
    }
    #ai-agent-bubble {
      background: linear-gradient(135deg, #0038A8, #1a4fd8);
      color: #fff;
      border: none;
      border-radius: 60px;
      padding: 14px 22px;
      font-family: 'DM Sans', sans-serif;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 8px 32px rgba(0,56,168,0.35);
      transition: all 0.3s ease;
      white-space: nowrap;
      animation: ai-pulse 2.5s infinite;
    }
    #ai-agent-bubble:hover { transform: translateY(-3px); box-shadow: 0 12px 40px rgba(0,56,168,0.45); }
    #ai-agent-bubble .ai-mic-icon { font-size: 20px; }
    @keyframes ai-pulse {
      0%,100% { box-shadow: 0 8px 32px rgba(0,56,168,0.35); }
      50% { box-shadow: 0 8px 48px rgba(0,56,168,0.55), 0 0 0 8px rgba(0,56,168,0.1); }
    }
    #ai-agent-tooltip {
      background: #0A0A1A;
      color: #fff;
      font-family: 'DM Sans', sans-serif;
      font-size: 13px;
      padding: 8px 14px;
      border-radius: 8px;
      max-width: 220px;
      text-align: right;
      line-height: 1.4;
      opacity: 0;
      animation: fadeInTip 0.5s 2s forwards;
    }
    @keyframes fadeInTip { to { opacity: 1; } }

    /* Modal overlay */
    #ai-modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(10,10,26,0.7);
      z-index: 10000;
      backdrop-filter: blur(4px);
      align-items: center;
      justify-content: center;
    }
    #ai-modal-overlay.open { display: flex; }
    #ai-modal {
      background: #fff;
      border-radius: 24px;
      width: 100%;
      max-width: 500px;
      margin: 20px;
      overflow: hidden;
      box-shadow: 0 24px 80px rgba(0,0,0,0.3);
      font-family: 'DM Sans', sans-serif;
    }
    #ai-modal-header {
      background: linear-gradient(135deg, #0038A8 0%, #E8000D 100%);
      padding: 28px 28px 20px;
      color: #fff;
      position: relative;
    }
    #ai-modal-header .modal-logo {
      font-family: 'Syne', sans-serif;
      font-size: 20px;
      font-weight: 800;
      margin-bottom: 6px;
    }
    #ai-modal-header .modal-logo .afro { color: #93C5FD; }
    #ai-modal-header .modal-logo .pol { color: #FCA5A5; }
    #ai-modal-header h2 { font-size: 22px; font-weight: 700; margin-bottom: 4px; }
    #ai-modal-header p { font-size: 14px; opacity: 0.85; }
    #ai-close-btn {
      position: absolute; top: 16px; right: 16px;
      background: rgba(255,255,255,0.2); border: none; color: #fff;
      width: 32px; height: 32px; border-radius: 50%; font-size: 16px;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      transition: background 0.2s;
    }
    #ai-close-btn:hover { background: rgba(255,255,255,0.35); }

    /* Steps indicator */
    #ai-modal-body { padding: 28px; }
    .ai-steps {
      display: flex; gap: 6px; margin-bottom: 24px; align-items: center;
    }
    .ai-step {
      flex: 1; height: 4px; border-radius: 4px;
      background: #E5E7EB; transition: background 0.4s;
    }
    .ai-step.done { background: #0038A8; }
    .ai-step.active { background: #E8000D; }

    /* Screens inside modal */
    .ai-screen { display: none; }
    .ai-screen.active { display: block; }

    /* Intro screen */
    .ai-intro-icon {
      width: 72px; height: 72px; background: linear-gradient(135deg,#EEF2FF,#DBEAFE);
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      font-size: 32px; margin: 0 auto 16px;
    }
    .ai-intro-title { font-family: 'Syne',sans-serif; font-size: 20px; font-weight: 700; text-align: center; margin-bottom: 10px; color: #0A0A1A; }
    .ai-intro-desc { font-size: 14.5px; color: #6B7280; text-align: center; line-height: 1.6; margin-bottom: 20px; }
    .ai-how-list {
      background: #F5F7FF; border-radius: 12px; padding: 16px; margin-bottom: 20px;
      display: flex; flex-direction: column; gap: 10px;
    }
    .ai-how-item {
      display: flex; align-items: flex-start; gap: 10px; font-size: 13.5px; color: #374151;
    }
    .ai-how-num {
      min-width: 24px; height: 24px; background: #0038A8; color: #fff;
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      font-size: 12px; font-weight: 700;
    }

    /* Form fields */
    .ai-field { margin-bottom: 14px; }
    .ai-field label { display: block; font-size: 13px; font-weight: 600; color: #374151; margin-bottom: 5px; }
    .ai-field input, .ai-field select {
      width: 100%; padding: 11px 14px; border: 1.5px solid #E5E7EB;
      border-radius: 9px; font-family: 'DM Sans',sans-serif; font-size: 14.5px;
      color: #0A0A1A; outline: none; transition: border 0.2s;
      background: #fff;
    }
    .ai-field input:focus, .ai-field select:focus { border-color: #0038A8; }
    .ai-field-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }

    /* Call screen */
    #ai-call-screen { text-align: center; }
    .ai-avatar {
      width: 90px; height: 90px; background: linear-gradient(135deg,#0038A8,#E8000D);
      border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center;
      justify-content: center; font-size: 38px; position: relative;
    }
    .ai-avatar.talking::after {
      content: '';
      position: absolute; inset: -6px; border-radius: 50%;
      border: 3px solid #0038A8; opacity: 0.5;
      animation: ring-pulse 1s infinite;
    }
    @keyframes ring-pulse {
      0%,100% { transform: scale(1); opacity: 0.5; }
      50% { transform: scale(1.1); opacity: 0.15; }
    }
    .ai-status-label {
      font-size: 13px; font-weight: 600; color: #6B7280;
      text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 6px;
    }
    .ai-call-name { font-family: 'Syne',sans-serif; font-size: 20px; font-weight: 700; margin-bottom: 4px; }
    .ai-call-timer { font-size: 28px; font-weight: 700; color: #0038A8; margin-bottom: 20px; font-variant-numeric: tabular-nums; }
    .ai-live-transcript {
      background: #F5F7FF; border-radius: 12px; padding: 14px; min-height: 80px;
      font-size: 13.5px; color: #374151; line-height: 1.6; text-align: left;
      max-height: 120px; overflow-y: auto; margin-bottom: 20px;
    }
    .ai-call-controls { display: flex; gap: 12px; justify-content: center; }
    .ai-ctrl-btn {
      width: 56px; height: 56px; border-radius: 50%; border: none;
      font-size: 20px; cursor: pointer; transition: all 0.2s;
      display: flex; align-items: center; justify-content: center;
    }
    .ai-ctrl-mute { background: #F3F4F6; color: #374151; }
    .ai-ctrl-mute:hover { background: #E5E7EB; }
    .ai-ctrl-end { background: #EF4444; color: #fff; width: 64px; height: 64px; font-size: 22px; }
    .ai-ctrl-end:hover { background: #DC2626; transform: scale(1.05); }

    /* CTA screen */
    #ai-cta-screen { text-align: center; }
    .ai-cta-badge {
      display: inline-flex; align-items: center; gap: 6px;
      background: #D1FAE5; color: #059669; padding: 6px 14px;
      border-radius: 20px; font-size: 13px; font-weight: 700; margin-bottom: 16px;
    }
    .ai-cta-title { font-family: 'Syne',sans-serif; font-size: 22px; font-weight: 800; margin-bottom: 8px; color: #0A0A1A; }
    .ai-cta-desc { font-size: 14.5px; color: #6B7280; line-height: 1.6; margin-bottom: 20px; }
    .ai-cta-matches {
      background: #F5F7FF; border-radius: 12px; padding: 16px; margin-bottom: 20px;
      display: flex; flex-direction: column; gap: 8px; text-align: left;
    }
    .ai-match-item {
      display: flex; align-items: center; gap: 10px;
      padding: 10px 12px; background: #fff; border-radius: 9px;
      border: 1.5px solid #E5E7EB; font-size: 13.5px;
    }
    .ai-match-icon { font-size: 20px; }
    .ai-match-info { flex: 1; }
    .ai-match-name { font-weight: 700; color: #0A0A1A; }
    .ai-match-detail { font-size: 12px; color: #6B7280; margin-top: 1px; }
    .ai-match-badge {
      background: #D1FAE5; color: #059669; font-size: 11px;
      font-weight: 700; padding: 3px 8px; border-radius: 12px;
    }
    .ai-cta-wa-btn {
      width: 100%; background: linear-gradient(135deg,#25D366,#1ebe5d);
      color: #fff; border: none; padding: 15px; border-radius: 12px;
      font-family: 'DM Sans',sans-serif; font-size: 15.5px; font-weight: 700;
      cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px;
      margin-bottom: 10px; transition: all 0.3s;
    }
    .ai-cta-wa-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(37,211,102,0.35); }
    .ai-cta-secondary-btn {
      width: 100%; background: transparent; color: #0038A8;
      border: 2px solid #0038A8; padding: 13px; border-radius: 12px;
      font-family: 'DM Sans',sans-serif; font-size: 15px; font-weight: 700;
      cursor: pointer; transition: all 0.3s;
    }
    .ai-cta-secondary-btn:hover { background: #0038A8; color: #fff; }
    .ai-skip-text {
      font-size: 12.5px; color: #9CA3AF; margin-top: 10px; cursor: pointer;
      text-decoration: underline;
    }
    .ai-btn-primary {
      width: 100%; background: linear-gradient(135deg, #E8000D, #c8000b);
      color: #fff; border: none; padding: 15px; border-radius: 12px;
      font-family: 'DM Sans',sans-serif; font-size: 15.5px; font-weight: 700;
      cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px;
      transition: all 0.3s; margin-bottom: 10px;
    }
    .ai-btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(232,0,13,0.35); }
    .ai-btn-secondary {
      width: 100%; background: transparent; color: #374151;
      border: 1.5px solid #E5E7EB; padding: 13px; border-radius: 12px;
      font-family: 'DM Sans',sans-serif; font-size: 14.5px; font-weight: 600;
      cursor: pointer; transition: all 0.2s;
    }
    .ai-btn-secondary:hover { border-color: #9CA3AF; }
    .ai-note { font-size: 12px; color: #9CA3AF; margin-top: 8px; }

    @media (max-width: 480px) {
      #ai-agent-fab { bottom: 20px; right: 16px; }
      #ai-agent-bubble { font-size: 13.5px; padding: 12px 18px; }
      #ai-modal { margin: 12px; border-radius: 18px; }
      .ai-field-row { grid-template-columns: 1fr; }
    }
  `;
  document.head.appendChild(style);

  // ---- HTML ----
  const html = `
  <!-- Floating Button -->
  <div id="ai-agent-fab">
    <div id="ai-agent-tooltip">üéì Talk to our AI advisor ‚Äî get matched to your program in 2 mins!</div>
    <button id="ai-agent-bubble" onclick="aiOpenModal()">
      <span class="ai-mic-icon">üéôÔ∏è</span>
      Talk to Our AI Advisor
    </button>
  </div>

  <!-- Modal -->
  <div id="ai-modal-overlay">
    <div id="ai-modal">
      <div id="ai-modal-header">
        <button id="ai-close-btn" onclick="aiCloseModal()">‚úï</button>
        <div class="modal-logo"><span class="afro">Afro</span><span class="pol">Pol</span> Nexus AI Advisor</div>
        <h2>Your Personal Study Advisor</h2>
        <p>Powered by AI ¬∑ Available 24/7 ¬∑ Free consultation</p>
      </div>
      <div id="ai-modal-body">
        <!-- Steps -->
        <div class="ai-steps">
          <div class="ai-step active" id="step-1"></div>
          <div class="ai-step" id="step-2"></div>
          <div class="ai-step" id="step-3"></div>
        </div>

        <!-- Screen 1: Intro -->
        <div class="ai-screen active" id="ai-intro-screen">
          <div class="ai-intro-icon">ü§ñ</div>
          <div class="ai-intro-title">Meet Your AI Study Guide</div>
          <div class="ai-intro-desc">Our AI advisor will have a short conversation with you, understand your goals, and match you to the best programs in Poland ‚Äî then connect you with a real expert.</div>
          <div class="ai-how-list">
            <div class="ai-how-item"><div class="ai-how-num">1</div><div>You tell us your study interests, qualifications & budget</div></div>
            <div class="ai-how-item"><div class="ai-how-num">2</div><div>The AI explains how studying in Poland works ‚Äî costs, visa, timeline</div></div>
            <div class="ai-how-item"><div class="ai-how-num">3</div><div>You get matched to programs that fit <em>you</em></div></div>
            <div class="ai-how-item"><div class="ai-how-num">4</div><div>If it's a great fit, we book you a free call with our expert consultants</div></div>
          </div>
          <div class="ai-field">
            <label>Your name</label>
            <input type="text" id="ai-name" placeholder="e.g. Thembi Dlamini" />
          </div>
          <div class="ai-field-row">
            <div class="ai-field">
              <label>Your country</label>
              <select id="ai-country">
                <option value="">Select...</option>
                <option>South Africa</option><option>Nigeria</option><option>Kenya</option>
                <option>Ghana</option><option>Zimbabwe</option><option>Tanzania</option>
                <option>Zambia</option><option>Uganda</option><option>Ethiopia</option>
                <option>Other Africa</option>
              </select>
            </div>
            <div class="ai-field">
              <label>Your phone (optional)</label>
              <input type="tel" id="ai-phone" placeholder="+27 ..." />
            </div>
          </div>
          <button class="ai-btn-primary" onclick="aiStartCall()">
            üéôÔ∏è Start Voice Call with AI Advisor
          </button>
          <button class="ai-btn-secondary" onclick="aiSkipToChat()">
            üí¨ Prefer text chat instead
          </button>
          <div class="ai-note">Your microphone will be requested. The call lasts about 3‚Äì5 minutes.</div>
        </div>

        <!-- Screen 2: Active Call -->
        <div class="ai-screen" id="ai-call-screen">
          <div class="ai-avatar talking" id="ai-avatar">ü§ñ</div>
          <div class="ai-status-label" id="ai-call-status">Connecting...</div>
          <div class="ai-call-name" id="ai-caller-name">AfroPol AI Advisor</div>
          <div class="ai-call-timer" id="ai-timer">0:00</div>
          <div class="ai-live-transcript" id="ai-transcript">
            <em style="color:#9CA3AF">Connecting to your AI advisor...</em>
          </div>
          <div class="ai-call-controls">
            <button class="ai-ctrl-btn ai-ctrl-mute" id="ai-mute-btn" onclick="aiToggleMute()" title="Mute">üéôÔ∏è</button>
            <button class="ai-ctrl-btn ai-ctrl-end" onclick="aiEndCall()" title="End call">üìµ</button>
          </div>
        </div>

        <!-- Screen 3: Post-Call CTA -->
        <div class="ai-screen" id="ai-cta-screen">
          <div class="ai-cta-badge">‚úÖ Great news ‚Äî you're a strong candidate!</div>
          <div class="ai-cta-title">Your Matched Programs</div>
          <div class="ai-cta-desc">Based on your conversation, our AI found programs that match your background, goals, and budget. The next step is a free 20-minute call with one of our expert consultants.</div>
          <div class="ai-cta-matches" id="ai-matches-list">
            <!-- dynamically filled -->
          </div>
          <button class="ai-cta-wa-btn" onclick="aiBookWhatsApp()">
            <i class="fab fa-whatsapp" style="font-size:20px"></i>
            Book Free Consultation on WhatsApp
          </button>
          <button class="ai-cta-secondary-btn" onclick="aiCloseModal()">
            Explore programs on my own
          </button>
          <div class="ai-skip-text" onclick="aiCloseModal()">Maybe later</div>
        </div>

        <!-- Screen 2b: Text Chat fallback -->
        <div class="ai-screen" id="ai-chat-screen">
          <div style="font-family:'Syne',sans-serif;font-size:18px;font-weight:700;margin-bottom:8px">üí¨ Chat with our AI Advisor</div>
          <div style="font-size:13.5px;color:#6B7280;margin-bottom:16px">Type your questions and we'll guide you step by step.</div>
          <div id="ai-chatbox" style="height:220px;overflow-y:auto;background:#F5F7FF;border-radius:12px;padding:14px;display:flex;flex-direction:column;gap:8px;margin-bottom:12px"></div>
          <div style="display:flex;gap:8px">
            <input type="text" id="ai-chat-input" placeholder="Type your message..." style="flex:1;padding:11px 14px;border:1.5px solid #E5E7EB;border-radius:9px;font-family:'DM Sans',sans-serif;font-size:14px;outline:none" onkeydown="if(event.key==='Enter')aiSendChat()" />
            <button onclick="aiSendChat()" style="padding:11px 18px;background:#0038A8;color:#fff;border:none;border-radius:9px;font-weight:700;cursor:pointer;font-size:14px">Send</button>
          </div>
          <div style="margin-top:12px">
            <button class="ai-btn-primary" onclick="aiShowCTA()">‚úÖ I'm ready ‚Äî show me my matches</button>
          </div>
        </div>

      </div>
    </div>
  </div>
  `;

  document.body.insertAdjacentHTML('beforeend', html);

  // ---- LOGIC ----
  let timerInterval = null;
  let timerSeconds = 0;
  let isMuted = false;
  let vapiInstance = null;
  let userName = '';
  let userCountry = '';

  window.aiOpenModal = function() {
    document.getElementById('ai-modal-overlay').classList.add('open');
    document.body.style.overflow = 'hidden';
  };

  window.aiCloseModal = function() {
    document.getElementById('ai-modal-overlay').classList.remove('open');
    document.body.style.overflow = '';
    if (vapiInstance) { try { vapiInstance.stop(); } catch(e){} vapiInstance = null; }
    clearInterval(timerInterval);
  };

  function aiSetScreen(id) {
    document.querySelectorAll('.ai-screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    // Update step indicators
    const steps = { 'ai-intro-screen': 0, 'ai-call-screen': 1, 'ai-chat-screen': 1, 'ai-cta-screen': 2 };
    const stepEls = document.querySelectorAll('.ai-step');
    stepEls.forEach((el, i) => {
      el.classList.remove('active', 'done');
      const cur = steps[id] || 0;
      if (i < cur) el.classList.add('done');
      else if (i === cur) el.classList.add('active');
    });
  }

  window.aiStartCall = function() {
    userName = document.getElementById('ai-name').value.trim() || 'there';
    userCountry = document.getElementById('ai-country').value || 'Africa';
    aiSetScreen('ai-call-screen');
    document.getElementById('ai-caller-name').textContent = 'AfroPol AI Advisor';
    startTimer();
    // Try to load Vapi SDK and start call
    loadVapiAndStart();
  };

  window.aiSkipToChat = function() {
    userName = document.getElementById('ai-name').value.trim() || 'there';
    userCountry = document.getElementById('ai-country').value || 'Africa';
    aiSetScreen('ai-chat-screen');
    // Prime the chat with a greeting
    setTimeout(() => {
      aiAddChatMsg('ai', `Hi ${userName}! üëã Welcome to AfroPol Nexus. I'm your personal study advisor. I'm going to help you find the perfect program in Poland.\n\nFirst ‚Äî what would you like to study? (e.g. Medicine, Business, Engineering, Psychology...)`);
    }, 600);
  };

  // ---- TIMER ----
  function startTimer() {
    timerSeconds = 0;
    clearInterval(timerInterval);
    timerInterval = setInterval(() => {
      timerSeconds++;
      const m = Math.floor(timerSeconds / 60);
      const s = timerSeconds % 60;
      const el = document.getElementById('ai-timer');
      if (el) el.textContent = `${m}:${s.toString().padStart(2,'0')}`;
    }, 1000);
  }

  // ---- VAPI INTEGRATION ----
  function loadVapiAndStart() {
    // Load Vapi SDK
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/@vapi-ai/web@latest/dist/vapi.iife.js';
    script.onload = () => initVapiCall();
    script.onerror = () => {
      // Fallback: simulate call if Vapi SDK can't load
      simulateCall();
    };
    document.head.appendChild(script);
  }

  function initVapiCall() {
    // ============================================================
    // REPLACE 'YOUR_VAPI_PUBLIC_KEY' with your actual Vapi public key
    // REPLACE 'YOUR_VAPI_ASSISTANT_ID' with your Vapi assistant ID
    // ============================================================
    const VAPI_PUBLIC_KEY = '04f0a7d1-4659-446c-b7d8-04a6789ac7c5';
    const VAPI_ASSISTANT_ID = '2361a957-f1f7-48a5-8b99-7709716533bb';

    if (!VAPI_PUBLIC_KEY || VAPI_PUBLIC_KEY === '') {
      // Keys not set yet ‚Äî show simulation
      simulateCall();
      return;
    }

    try {
      vapiInstance = new window.Vapi(VAPI_PUBLIC_KEY);

      vapiInstance.on('call-start', () => {
        document.getElementById('ai-call-status').textContent = 'Connected';
        document.getElementById('ai-avatar').classList.add('talking');
      });

      vapiInstance.on('speech-start', () => {
        document.getElementById('ai-avatar').classList.add('talking');
      });

      vapiInstance.on('speech-end', () => {
        document.getElementById('ai-avatar').classList.remove('talking');
      });

      vapiInstance.on('message', (msg) => {
        if (msg.type === 'transcript' && msg.transcriptType === 'final') {
          const el = document.getElementById('ai-transcript');
          el.innerHTML += `<div style="margin-top:6px"><strong style="color:#0038A8">${msg.role === 'assistant' ? 'ü§ñ Advisor' : 'üë§ You'}:</strong> ${msg.transcript}</div>`;
          el.scrollTop = el.scrollHeight;
        }
      });

      vapiInstance.on('call-end', () => {
        clearInterval(timerInterval);
        aiShowCTA();
      });

      vapiInstance.on('error', (e) => {
        console.error('Vapi error', e);
        simulateCall();
      });

      vapiInstance.start(VAPI_ASSISTANT_ID, {
        variableValues: {
          studentName: userName,
          studentCountry: userCountry,
        }
      });

    } catch(e) {
      simulateCall();
    }
  }

  // ---- SIMULATE CALL (demo when Vapi not yet configured) ----
  const demoScript = [
    { role: 'ai', text: `Hi ${userName || 'there'}! Welcome to AfroPol Nexus. I'm your AI study advisor. I'm going to help you find the right program in Poland in just a few minutes. Ready to begin? üòä` },
    { role: 'ai', text: `Great! So first ‚Äî can you tell me what field of study you're most interested in? For example, medicine, business, engineering, IT, psychology, law, or something else?` },
    { role: 'ai', text: `Excellent choice! And what's your current qualification level? Are you finishing high school, or do you already have a diploma or degree?` },
    { role: 'ai', text: `Perfect. Now let me tell you quickly how studying in Poland works. Poland is an EU member, so your degree is internationally recognised. Programs taught fully in English start from around ‚Ç¨3,500 per semester ‚Äî that's roughly R70,000. Much more affordable than the UK or USA. The student visa process is straightforward for African students and takes about 4‚Äì6 weeks.` },
    { role: 'ai', text: `What's your rough budget per semester? This helps me filter to programs you can realistically afford.` },
    { role: 'ai', text: `That's helpful! One more question ‚Äî when are you looking to start? October 2025 intake is coming up, but there's also a February 2026 option for some programs.` },
    { role: 'ai', text: `Fantastic. Based on everything you've shared, I have some excellent program matches for you. I'm going to show you those now and strongly suggest you book a free 20-minute call with one of our expert consultants ‚Äî they'll go through the full application, documents needed, and secure your spot. They're amazing and many students say it's what made the difference. Ready to see your matches?` },
  ];

  let demoIdx = 0;
  let demoTimer = null;

  function simulateCall() {
    demoIdx = 0;
    const transcript = document.getElementById('ai-transcript');
    transcript.innerHTML = '';
    document.getElementById('ai-call-status').textContent = 'Connected (Demo Mode)';
    document.getElementById('ai-avatar').classList.add('talking');

    function showNext() {
      if (demoIdx >= demoScript.length) {
        clearInterval(demoTimer);
        document.getElementById('ai-call-status').textContent = 'Call ended';
        document.getElementById('ai-avatar').classList.remove('talking');
        setTimeout(aiShowCTA, 1500);
        return;
      }
      const line = demoScript[demoIdx];
      transcript.innerHTML += `<div style="margin-top:8px"><strong style="color:#0038A8">ü§ñ Advisor:</strong> ${line.text}</div>`;
      transcript.scrollTop = transcript.scrollHeight;
      demoIdx++;
    }
    showNext();
    demoTimer = setInterval(showNext, 5000);
  }

  window.aiToggleMute = function() {
    isMuted = !isMuted;
    document.getElementById('ai-mute-btn').textContent = isMuted ? 'üîá' : 'üéôÔ∏è';
    if (vapiInstance) { try { vapiInstance.setMuted(isMuted); } catch(e){} }
  };

  window.aiEndCall = function() {
    clearInterval(timerInterval);
    clearInterval(demoTimer);
    if (vapiInstance) { try { vapiInstance.stop(); } catch(e){}  vapiInstance = null; }
    document.getElementById('ai-call-status').textContent = 'Call ended';
    document.getElementById('ai-avatar').classList.remove('talking');
    setTimeout(aiShowCTA, 800);
  };

  // ---- CTA SCREEN ----
  window.aiShowCTA = function() {
    aiSetScreen('ai-cta-screen');
    clearInterval(timerInterval);
    const matches = [
      { icon: 'üèõÔ∏è', name: 'Business & Management ‚Äî VIZJA Warsaw', detail: 'BA ¬∑ English ¬∑ ‚Ç¨3,500/sem ¬∑ Oct 2025', fit: 'Top Match' },
      { icon: 'üíª', name: 'IT & Computer Science ‚Äî Cardinal Wyszy≈Ñski', detail: 'BSc ¬∑ English ¬∑ ‚Ç¨2,800/sem ¬∑ Oct 2025', fit: 'Great Fit' },
      { icon: 'üìä', name: 'Finance & Accounting ‚Äî Kozminski', detail: 'BA ¬∑ English ¬∑ ‚Ç¨4,200/sem ¬∑ Oct 2025', fit: 'Strong Match' },
    ];
    const list = document.getElementById('ai-matches-list');
    list.innerHTML = matches.map(m => `
      <div class="ai-match-item">
        <div class="ai-match-icon">${m.icon}</div>
        <div class="ai-match-info">
          <div class="ai-match-name">${m.name}</div>
          <div class="ai-match-detail">${m.detail}</div>
        </div>
        <div class="ai-match-badge">${m.fit}</div>
      </div>
    `).join('');
  };

  window.aiBookWhatsApp = function() {
    const name = encodeURIComponent(userName || 'a student');
    const msg = encodeURIComponent(`Hi! I just spoke with the AfroPol Nexus AI advisor. My name is ${userName || 'there'} from ${userCountry}. I'd like to book a free consultation to discuss my program options and start my application.`);
    window.open(`https://wa.me/48579108304?text=${msg}`, '_blank');
  };

  // ---- TEXT CHAT FALLBACK ----
  const chatKnowledge = [
    { q: ['study','field','interest','course','program'], a: `Great question! We have programs in Medicine, Business, IT, Engineering, Psychology, Law, Architecture, and more. What field excites you most?` },
    { q: ['medicine','medical','doctor','mbbs'], a: `Medicine is one of our most popular programs! ü©∫ It's a 6-year MD program, English-taught, at around ‚Ç¨5,000/semester. Universities include Medical University of Lodz and Wroclaw. Your Polish qualifications are accepted. Shall I tell you more about requirements?` },
    { q: ['business','management','mba','finance'], a: `Business programs are huge in Poland! üìä VIZJA University and Kozminski are top picks. Tuition from ‚Ç¨3,500/sem. 3-year BA or 1.5-year MBA. Very strong graduate employment in the EU.` },
    { q: ['it','computer','software','tech','engineering'], a: `Great choice! üíª IT and Engineering programs in Poland are world-class. AGH University in Krakow is one of Europe's best for tech. Costs from ‚Ç¨2,500/sem. English-taught, 3.5-year BSc.` },
    { q: ['cost','price','budget','affordable','fee','tuition'], a: `Costs vary by program:\n‚Ä¢ Business/Arts: ‚Ç¨3,500‚Äì‚Ç¨4,500/semester\n‚Ä¢ Medicine: ‚Ç¨5,000‚Äì‚Ç¨6,500/semester\n‚Ä¢ IT/Engineering: ‚Ç¨2,500‚Äì‚Ç¨4,000/semester\n\nLiving costs in Poland are around ‚Ç¨500‚Äì‚Ç¨700/month. Much cheaper than UK or Germany!` },
    { q: ['visa','permit','apply','requirements','qualifications'], a: `Great news ‚Äî the Polish student visa is achievable! üõÇ Requirements: accepted university offer, proof of funds (~‚Ç¨6,000 for first year), valid passport, medical insurance. Process takes 4‚Äì6 weeks. We guide you through every step.` },
    { q: ['when','start','intake','october','february'], a: `Poland has two main intakes:\n‚Ä¢ **October 2025** ‚Äî main intake, most programs\n‚Ä¢ **February 2026** ‚Äî available for some programs\n\nApplication window for October is open NOW. We recommend applying at least 3 months before start.` },
    { q: ['south africa','south african','za','sa'], a: `We work with many South African students! üáøüá¶ Your NSC (Matric) is recognised. We'll help with credential evaluation, SAQA verification if needed, and everything else. Many SA students are already studying in Poland through us.` },
  ];

  window.aiSendChat = function() {
    const input = document.getElementById('ai-chat-input');
    const text = input.value.trim();
    if (!text) return;
    aiAddChatMsg('user', text);
    input.value = '';
    setTimeout(() => {
      const lower = text.toLowerCase();
      let response = `Thanks for sharing that! üòä To give you the most accurate advice, I'd recommend booking a quick call with our expert consultants. They'll match you to the perfect program based on exactly what you've told me. Want me to connect you?`;
      for (const item of chatKnowledge) {
        if (item.q.some(k => lower.includes(k))) {
          response = item.a;
          break;
        }
      }
      aiAddChatMsg('ai', response);
    }, 800);
  };

  function aiAddChatMsg(role, text) {
    const box = document.getElementById('ai-chatbox');
    const isAI = role === 'ai';
    const div = document.createElement('div');
    div.style.cssText = `display:flex;justify-content:${isAI?'flex-start':'flex-end'}`;
    div.innerHTML = `<div style="max-width:85%;background:${isAI?'#fff':'#0038A8'};color:${isAI?'#374151':'#fff'};padding:10px 14px;border-radius:${isAI?'4px 14px 14px 14px':'14px 4px 14px 14px'};font-size:13.5px;line-height:1.55;${isAI?'border:1px solid #E5E7EB;':''}">${text.replace(/\n/g,'<br>')}</div>`;
    box.appendChild(div);
    box.scrollTop = box.scrollHeight;
  }

})();
</script>
</body>
</html>
